<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of findjobj</title>
  <meta name="keywords" content="findjobj">
  <meta name="description" content="findjobj Find java objects contained within a specified java container or Matlab GUI handle">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">PLDAPS</a> &gt; <a href="../index.html">@params</a> &gt; <a href="index.html">private</a> &gt; findjobj.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for PLDAPS/@params/private&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>@params/privatefindjobj
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>findjobj Find java objects contained within a specified java container or Matlab GUI handle</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [handles,levels,parentIdx,listing] = findjobj(container,varargin) %#ok<*CTCH,*ASGLU,*MSNU,*NASGU> </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="description">findjobj Find java objects contained within a specified java container or Matlab GUI handle

 Syntax:
    [handles, levels, parentIds, listing] = findjobj(container, 'PropName',PropValue(s), ...)

 Input parameters:
    container - optional handle to java container uipanel or figure. If unsupplied then current figure will be used
    'PropName',PropValue - optional list of property pairs (case insensitive). PropName may also be named -PropName
         'position' - filter results based on those elements that contain the specified X,Y position or a java element
                      Note: specify a Matlab position (X,Y = pixels from bottom left corner), not a java one
         'size'     - filter results based on those elements that have the specified W,H (in pixels)
         'class'    - filter results based on those elements that contain the substring  (or java class) PropValue
                      Note1: filtering is case insensitive and relies on regexp, so you can pass wildcards etc.
                      Note2: '-class' is an undocumented findobj PropName, but only works on Matlab (not java) classes
         'property' - filter results based on those elements that possess the specified case-insensitive property string
                      Note1: passing a property value is possible if the argument following 'property' is a cell in the
                             format of {'propName','propValue'}. Example: FINDJOBJ(...,'property',{'Text','click me'})
                      Note2: partial property names (e.g. 'Tex') are accepted, as long as they're not ambiguous
         'depth'    - filter results based on specified depth. 0=top-level, Inf=all levels (default=Inf)
         'flat'     - same as specifying: 'depth',0
         'not'      - negates the following filter: 'not','class','c' returns all elements EXCEPT those with class 'c'
         'persist'  - persist figure components information, allowing much faster results for subsequent invocations
         'nomenu'   - skip menu processing, for &quot;lean&quot; list of handles &amp; much faster processing;
                      This option is the default for HG containers but not for figure, Java or no container
         'print'    - display all java elements in a hierarchical list, indented appropriately
                      Note1: optional PropValue of element index or handle to java container
                      Note2: normally this option would be placed last, after all filtering is complete. Placing this
                             option before some filters enables debug print-outs of interim filtering results.
                      Note3: output is to the Matlab command window unless the 'listing' (4th) output arg is requested
         'list'     - same as 'print'
         'debug'    - list found component positions in the Command Window

 Output parameters:
    handles   - list of handles to java elements
    levels    - list of corresponding hierarchy level of the java elements (top=0)
    parentIds - list of indexes (in unfiltered handles) of the parent container of the corresponding java element
    listing   - results of 'print'/'list' options (empty if these options were not specified)

    Note: If no output parameter is specified, then an interactive window will be displayed with a
    ^^^^  tree view of all container components, their properties and callbacks.

 Examples:
    findjobj;                     % display list of all javaelements of currrent figure in an interactive GUI
    handles = findjobj;           % get list of all java elements of current figure (inc. menus, toolbars etc.)
    findjobj('print');            % list all java elements in current figure
    findjobj('print',6);          % list all java elements in current figure, contained within its 6th element
    handles = findjobj(hButton);                                     % hButton is a matlab button
    handles = findjobj(gcf,'position',getpixelposition(hButton,1));  % same as above but also return hButton's panel
    handles = findjobj(hButton,'persist');                           % same as above, persist info for future reuse
    handles = findjobj('class','pushbutton');                        % get all pushbuttons in current figure
    handles = findjobj('class','pushbutton','position',123,456);     % get all pushbuttons at the specified position
    handles = findjobj(gcf,'class','pushbutton','size',23,15);       % get all pushbuttons with the specified size
    handles = findjobj('property','Text','not','class','button');    % get all non-button elements with 'text' property
    handles = findjobj('-property',{'Text','click me'});             % get all elements with 'text' property = 'click me'

 Sample usage:
    hButton = uicontrol('string','click me');
    jButton = findjobj(hButton,'nomenu');
      % or: jButton = findjobj('property',{'Text','click me'});
    jButton.setFlyOverAppearance(1);
    jButton.setCursor(java.awt.Cursor.getPredefinedCursor(java.awt.Cursor.HAND_CURSOR));
    set(jButton,'FocusGainedCallback',@myMatlabFunction);   % some 30 callback points available...
    jButton.get;   % list all changeable properties...

    hEditbox = uicontrol('style','edit');
    jEditbox = findjobj(hEditbox,'nomenu');
    jEditbox.setCaretColor(java.awt.Color.red);
    jEditbox.KeyTypedCallback = @myCallbackFunc;  % many more callbacks where this came from...
    jEdit.requestFocus;

 Technical explanation &amp; details:
    http://undocumentedmatlab.com/blog/findjobj/
    http://undocumentedmatlab.com/blog/findjobj-gui-display-container-hierarchy/

 Known issues/limitations:
    - Cannot currently process multiple container objects - just one at a time
    - Initial processing is a bit slow when the figure is laden with many UI components (so better use 'persist')
    - Passing a simple container Matlab handle is currently filtered by its position+size: should find a better way to do this
    - Matlab uipanels are not implemented as simple java panels, and so they can't be found using this utility
    - Labels have a write-only text property in java, so they can't be found using the 'property',{'Text','string'} notation

 Warning:
    This code heavily relies on undocumented and unsupported Matlab functionality.
    It works on Matlab 7+, but use at your own risk!

 Bugs and suggestions:
    Please send to Yair Altman (altmany at gmail dot com)

 Change log:
    2014-01-04: Minor fix for R2014a; check for newer FEX version up to twice a day only
    2013-12-29: Only check for newer FEX version in non-deployed mode; handled case of invisible figure container
    2013-10-08: Fixed minor edge case (retrieving multiple scroll-panes)
    2013-06-30: Additional fixes for the upcoming HG2
    2013-05-15: Fix for the upcoming HG2
    2013-02-21: Fixed HG-Java warnings
    2013-01-23: Fixed callbacks table grouping &amp; editing bugs; added hidden properties to the properties tooltip; updated help section
    2013-01-13: Improved callbacks table; fixed tree refresh failure; fixed: tree node-selection didn't update the props pane nor flash the selected component
    2012-07-25: Fixes for R2012a as well as some older Matlab releases
    2011-12-07: Fixed 'File is empty' messages in compiled apps
    2011-11-22: Fix suggested by Ward
    2011-02-01: Fixes for R2011a
    2010-06-13: Fixes for R2010b; fixed download (m-file =&gt; zip-file)
    2010-04-21: Minor fix to support combo-boxes (aka drop-down, popup-menu) on Windows
    2010-03-17: Important release: Fixes for R2010a, debug listing, objects not found, component containers that should be ignored etc.
    2010-02-04: Forced an EDT redraw before processing; warned if requested handle is invisible
    2010-01-18: Found a way to display label text next to the relevant node name
    2009-10-28: Fixed uitreenode warning
    2009-10-27: Fixed auto-collapse of invisible container nodes; added dynamic tree tooltips &amp; context-menu; minor fix to version-check display
    2009-09-30: Fix for Matlab 7.0 as suggested by Oliver W; minor GUI fix (classname font)
    2009-08-07: Fixed edge-case of missing JIDE tables
    2009-05-24: Added support for future Matlab versions that will not support JavaFrame
    2009-05-15: Added sanity checks for axes items
    2009-04-28: Added 'debug' input arg; increased size tolerance 1px =&gt; 2px
    2009-04-23: Fixed location of popupmenus (always 20px high despite what's reported by Matlab...); fixed uiinspect processing issues; added blog link; narrower action buttons
    2009-04-09: Automatic 'nomenu' for uicontrol inputs; significant performance improvement
    2009-03-31: Fixed position of some Java components; fixed properties tooltip; fixed node visibility indication
    2009-02-26: Indicated components visibility (&amp; auto-collapse non-visible containers); auto-highlight selected component; fixes in node icons, figure title &amp; tree refresh; improved error handling; display FindJObj version update description if available
    2009-02-24: Fixed update check; added dedicated labels icon
    2009-02-18: Fixed compatibility with old Matlab versions
    2009-02-08: Callbacks table fixes; use uiinspect if available; fix update check according to new FEX website
    2008-12-17: R2008b compatibility
    2008-09-10: Fixed minor bug as per Johnny Smith
    2007-11-14: Fixed edge case problem with class properties tooltip; used existing object icon if available; added checkbox option to hide standard callbacks
    2007-08-15: Fixed object naming relative property priorities; added sanity check for illegal container arg; enabled desktop (0) container; cleaned up warnings about special class objects
    2007-08-03: Fixed minor tagging problems with a few Java sub-classes; displayed UIClassID if text/name/tag is unavailable
    2007-06-15: Fixed problems finding HG components found by J. Wagberg
    2007-05-22: Added 'nomenu' option for improved performance; fixed 'export handles' bug; fixed handle-finding/display bugs; &quot;cleaner&quot; error handling
    2007-04-23: HTMLized classname tooltip; returned top-level figure Frame handle for figure container; fixed callbacks table; auto-checked newer version; fixed Matlab 7.2 compatibility issue; added HG objects tree
    2007-04-19: Fixed edge case of missing figure; displayed tree hierarchy in interactive GUI if no output args; workaround for figure sub-menus invisible unless clicked
    2007-04-04: Improved performance; returned full listing results in 4th output arg; enabled partial property names &amp; property values; automatically filtered out container panels if children also returned; fixed finding sub-menu items
    2007-03-20: First version posted on the MathWorks file exchange: &lt;a href=&quot;http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=14317&quot;&gt;http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=14317&lt;/a&gt;

 See also:
    java, handle, findobj, findall, javaGetHandles, uiinspect (on the File Exchange)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="findjobj.html" class="code" title="function [handles,levels,parentIdx,listing] = findjobj(container,varargin) %#ok<*CTCH,*ASGLU,*MSNU,*NASGU>">@params/privatefindjobj</a>	findjobj Find java objects contained within a specified java container or Matlab GUI handle</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="findjobj.html" class="code" title="function [handles,levels,parentIdx,listing] = findjobj(container,varargin) %#ok<*CTCH,*ASGLU,*MSNU,*NASGU>">@params/privatefindjobj</a>	findjobj Find java objects contained within a specified java container or Matlab GUI handle</li><li><a href="../../../PLDAPS/@params/structviewer.html" class="code" title="function varargout = structviewer(varargin)">@params/structviewer</a>	structviewer Application M-file for structviewer.fig</li></ul>
<!-- crossreference -->

<!-- parameterreference -->
<h2><a name="_cross"></a>PARAMETER USAGE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function uses these parameters:
<ul >
</ul>
This function assigns these parameters:
<ul>
</ul>
<!-- parameterreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">warnInvisible</a></li><li><a href="#_sub2" class="code">paramSupplied</a></li><li><a href="#_sub3" class="code">getCurrentFigure</a></li><li><a href="#_sub4" class="code">getRootPanel</a></li><li><a href="#_sub5" class="code">traverseContainer</a></li><li><a href="#_sub6" class="code">getXY</a></li><li><a href="#_sub7" class="code">getNumMenuComponents</a></li><li><a href="#_sub8" class="code">removeDuplicateNode</a></li><li><a href="#_sub9" class="code">processArgs</a></li><li><a href="#_sub10" class="code">processPrintArgs</a></li><li><a href="#_sub11" class="code">processPositionArgs</a></li><li><a href="#_sub12" class="code">processSizeArgs</a></li><li><a href="#_sub13" class="code">processClassArgs</a></li><li><a href="#_sub14" class="code">processPropertyArgs</a></li><li><a href="#_sub15" class="code">processDepthArgs</a></li><li><a href="#_sub16" class="code">charizeData</a></li><li><a href="#_sub17" class="code">setProp</a></li><li><a href="#_sub18" class="code">getTreeData</a></li><li><a href="#_sub19" class="code">getCbsData</a></li><li><a href="#_sub20" class="code">getRalativeDivlocation</a></li><li><a href="#_sub21" class="code">setTreeNodeIcon</a></li><li><a href="#_sub22" class="code">presentObjectTree</a></li><li><a href="#_sub23" class="code">resizeImg</a></li><li><a href="#_sub24" class="code">disableDbstopError</a></li><li><a href="#_sub25" class="code">restoreDbstopError</a></li><li><a href="#_sub26" class="code">expandNode</a></li><li><a href="#_sub27" class="code">createJButton</a></li><li><a href="#_sub28" class="code">flashComponent</a></li><li><a href="#_sub29" class="code">nodeSelected</a></li><li><a href="#_sub30" class="code">iff</a></li><li><a href="#_sub31" class="code">getPropsHtml</a></li><li><a href="#_sub32" class="code">updateNodeTooltip</a></li><li><a href="#_sub33" class="code">nodeExpanded</a></li><li><a href="#_sub34" class="code">setIconSize</a></li><li><a href="#_sub35" class="code">getChildrenNodes</a></li><li><a href="#_sub36" class="code">getNodeName</a></li><li><a href="#_sub37" class="code">stripStdCbs</a></li><li><a href="#_sub38" class="code">cbHideStdCbs_Callback</a></li><li><a href="#_sub39" class="code">btWebsite_Callback</a></li><li><a href="#_sub40" class="code">btRefresh_Callback</a></li><li><a href="#_sub41" class="code">btExport_Callback</a></li><li><a href="#_sub42" class="code">btFocus_Callback</a></li><li><a href="#_sub43" class="code">btInspect_Callback</a></li><li><a href="#_sub44" class="code">btCheckFex_Callback</a></li><li><a href="#_sub45" class="code">checkVersion</a></li><li><a href="#_sub46" class="code">getTopSelectedObject</a></li><li><a href="#_sub47" class="code">tbCallbacksChanged</a></li><li><a href="#_sub48" class="code">revertCbTableModification</a></li><li><a href="#_sub49" class="code">getLabelsJavaPos</a></li><li><a href="#_sub50" class="code">traverseHGContainer</a></li><li><a href="#_sub51" class="code">dispError</a></li><li><a href="#_sub52" class="code">ischar</a></li><li><a href="#_sub53" class="code">setTreeContextMenu</a></li><li><a href="#_sub54" class="code">treeMousePressedCallback</a></li><li><a href="#_sub55" class="code">menuRemoveItem</a></li><li><a href="#_sub56" class="code">getNodeTitleStr</a></li><li><a href="#_sub57" class="code">treeMouseMovedCallback</a></li><li><a href="#_sub58" class="code">requestFocus</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre><div id="_line0001" class="line">0001 <a name="_sub0" href="#_subfunctions" class="code">function [handles,levels,parentIdx,listing] = findjobj(container,varargin) </a><span class="comment">%#ok&lt;*CTCH,*ASGLU,*MSNU,*NASGU&gt;</span>
</div><div id="_line0002" class="line">0002 <span class="comment">%findjobj Find java objects contained within a specified java container or Matlab GUI handle</span>
</div><div id="_line0003" class="line">0003 <span class="comment">%</span>
</div><div id="_line0004" class="line">0004 <span class="comment">% Syntax:</span>
</div><div id="_line0005" class="line">0005 <span class="comment">%    [handles, levels, parentIds, listing] = findjobj(container, 'PropName',PropValue(s), ...)</span>
</div><div id="_line0006" class="line">0006 <span class="comment">%</span>
</div><div id="_line0007" class="line">0007 <span class="comment">% Input parameters:</span>
</div><div id="_line0008" class="line">0008 <span class="comment">%    container - optional handle to java container uipanel or figure. If unsupplied then current figure will be used</span>
</div><div id="_line0009" class="line">0009 <span class="comment">%    'PropName',PropValue - optional list of property pairs (case insensitive). PropName may also be named -PropName</span>
</div><div id="_line0010" class="line">0010 <span class="comment">%         'position' - filter results based on those elements that contain the specified X,Y position or a java element</span>
</div><div id="_line0011" class="line">0011 <span class="comment">%                      Note: specify a Matlab position (X,Y = pixels from bottom left corner), not a java one</span>
</div><div id="_line0012" class="line">0012 <span class="comment">%         'size'     - filter results based on those elements that have the specified W,H (in pixels)</span>
</div><div id="_line0013" class="line">0013 <span class="comment">%         'class'    - filter results based on those elements that contain the substring  (or java class) PropValue</span>
</div><div id="_line0014" class="line">0014 <span class="comment">%                      Note1: filtering is case insensitive and relies on regexp, so you can pass wildcards etc.</span>
</div><div id="_line0015" class="line">0015 <span class="comment">%                      Note2: '-class' is an undocumented findobj PropName, but only works on Matlab (not java) classes</span>
</div><div id="_line0016" class="line">0016 <span class="comment">%         'property' - filter results based on those elements that possess the specified case-insensitive property string</span>
</div><div id="_line0017" class="line">0017 <span class="comment">%                      Note1: passing a property value is possible if the argument following 'property' is a cell in the</span>
</div><div id="_line0018" class="line">0018 <span class="comment">%                             format of {'propName','propValue'}. Example: FINDJOBJ(...,'property',{'Text','click me'})</span>
</div><div id="_line0019" class="line">0019 <span class="comment">%                      Note2: partial property names (e.g. 'Tex') are accepted, as long as they're not ambiguous</span>
</div><div id="_line0020" class="line">0020 <span class="comment">%         'depth'    - filter results based on specified depth. 0=top-level, Inf=all levels (default=Inf)</span>
</div><div id="_line0021" class="line">0021 <span class="comment">%         'flat'     - same as specifying: 'depth',0</span>
</div><div id="_line0022" class="line">0022 <span class="comment">%         'not'      - negates the following filter: 'not','class','c' returns all elements EXCEPT those with class 'c'</span>
</div><div id="_line0023" class="line">0023 <span class="comment">%         'persist'  - persist figure components information, allowing much faster results for subsequent invocations</span>
</div><div id="_line0024" class="line">0024 <span class="comment">%         'nomenu'   - skip menu processing, for &quot;lean&quot; list of handles &amp; much faster processing;</span>
</div><div id="_line0025" class="line">0025 <span class="comment">%                      This option is the default for HG containers but not for figure, Java or no container</span>
</div><div id="_line0026" class="line">0026 <span class="comment">%         'print'    - display all java elements in a hierarchical list, indented appropriately</span>
</div><div id="_line0027" class="line">0027 <span class="comment">%                      Note1: optional PropValue of element index or handle to java container</span>
</div><div id="_line0028" class="line">0028 <span class="comment">%                      Note2: normally this option would be placed last, after all filtering is complete. Placing this</span>
</div><div id="_line0029" class="line">0029 <span class="comment">%                             option before some filters enables debug print-outs of interim filtering results.</span>
</div><div id="_line0030" class="line">0030 <span class="comment">%                      Note3: output is to the Matlab command window unless the 'listing' (4th) output arg is requested</span>
</div><div id="_line0031" class="line">0031 <span class="comment">%         'list'     - same as 'print'</span>
</div><div id="_line0032" class="line">0032 <span class="comment">%         'debug'    - list found component positions in the Command Window</span>
</div><div id="_line0033" class="line">0033 <span class="comment">%</span>
</div><div id="_line0034" class="line">0034 <span class="comment">% Output parameters:</span>
</div><div id="_line0035" class="line">0035 <span class="comment">%    handles   - list of handles to java elements</span>
</div><div id="_line0036" class="line">0036 <span class="comment">%    levels    - list of corresponding hierarchy level of the java elements (top=0)</span>
</div><div id="_line0037" class="line">0037 <span class="comment">%    parentIds - list of indexes (in unfiltered handles) of the parent container of the corresponding java element</span>
</div><div id="_line0038" class="line">0038 <span class="comment">%    listing   - results of 'print'/'list' options (empty if these options were not specified)</span>
</div><div id="_line0039" class="line">0039 <span class="comment">%</span>
</div><div id="_line0040" class="line">0040 <span class="comment">%    Note: If no output parameter is specified, then an interactive window will be displayed with a</span>
</div><div id="_line0041" class="line">0041 <span class="comment">%    ^^^^  tree view of all container components, their properties and callbacks.</span>
</div><div id="_line0042" class="line">0042 <span class="comment">%</span>
</div><div id="_line0043" class="line">0043 <span class="comment">% Examples:</span>
</div><div id="_line0044" class="line">0044 <span class="comment">%    findjobj;                     % display list of all javaelements of currrent figure in an interactive GUI</span>
</div><div id="_line0045" class="line">0045 <span class="comment">%    handles = findjobj;           % get list of all java elements of current figure (inc. menus, toolbars etc.)</span>
</div><div id="_line0046" class="line">0046 <span class="comment">%    findjobj('print');            % list all java elements in current figure</span>
</div><div id="_line0047" class="line">0047 <span class="comment">%    findjobj('print',6);          % list all java elements in current figure, contained within its 6th element</span>
</div><div id="_line0048" class="line">0048 <span class="comment">%    handles = findjobj(hButton);                                     % hButton is a matlab button</span>
</div><div id="_line0049" class="line">0049 <span class="comment">%    handles = findjobj(gcf,'position',getpixelposition(hButton,1));  % same as above but also return hButton's panel</span>
</div><div id="_line0050" class="line">0050 <span class="comment">%    handles = findjobj(hButton,'persist');                           % same as above, persist info for future reuse</span>
</div><div id="_line0051" class="line">0051 <span class="comment">%    handles = findjobj('class','pushbutton');                        % get all pushbuttons in current figure</span>
</div><div id="_line0052" class="line">0052 <span class="comment">%    handles = findjobj('class','pushbutton','position',123,456);     % get all pushbuttons at the specified position</span>
</div><div id="_line0053" class="line">0053 <span class="comment">%    handles = findjobj(gcf,'class','pushbutton','size',23,15);       % get all pushbuttons with the specified size</span>
</div><div id="_line0054" class="line">0054 <span class="comment">%    handles = findjobj('property','Text','not','class','button');    % get all non-button elements with 'text' property</span>
</div><div id="_line0055" class="line">0055 <span class="comment">%    handles = findjobj('-property',{'Text','click me'});             % get all elements with 'text' property = 'click me'</span>
</div><div id="_line0056" class="line">0056 <span class="comment">%</span>
</div><div id="_line0057" class="line">0057 <span class="comment">% Sample usage:</span>
</div><div id="_line0058" class="line">0058 <span class="comment">%    hButton = uicontrol('string','click me');</span>
</div><div id="_line0059" class="line">0059 <span class="comment">%    jButton = findjobj(hButton,'nomenu');</span>
</div><div id="_line0060" class="line">0060 <span class="comment">%      % or: jButton = findjobj('property',{'Text','click me'});</span>
</div><div id="_line0061" class="line">0061 <span class="comment">%    jButton.setFlyOverAppearance(1);</span>
</div><div id="_line0062" class="line">0062 <span class="comment">%    jButton.setCursor(java.awt.Cursor.getPredefinedCursor(java.awt.Cursor.HAND_CURSOR));</span>
</div><div id="_line0063" class="line">0063 <span class="comment">%    set(jButton,'FocusGainedCallback',@myMatlabFunction);   % some 30 callback points available...</span>
</div><div id="_line0064" class="line">0064 <span class="comment">%    jButton.get;   % list all changeable properties...</span>
</div><div id="_line0065" class="line">0065 <span class="comment">%</span>
</div><div id="_line0066" class="line">0066 <span class="comment">%    hEditbox = uicontrol('style','edit');</span>
</div><div id="_line0067" class="line">0067 <span class="comment">%    jEditbox = findjobj(hEditbox,'nomenu');</span>
</div><div id="_line0068" class="line">0068 <span class="comment">%    jEditbox.setCaretColor(java.awt.Color.red);</span>
</div><div id="_line0069" class="line">0069 <span class="comment">%    jEditbox.KeyTypedCallback = @myCallbackFunc;  % many more callbacks where this came from...</span>
</div><div id="_line0070" class="line">0070 <span class="comment">%    jEdit.requestFocus;</span>
</div><div id="_line0071" class="line">0071 <span class="comment">%</span>
</div><div id="_line0072" class="line">0072 <span class="comment">% Technical explanation &amp; details:</span>
</div><div id="_line0073" class="line">0073 <span class="comment">%    http://undocumentedmatlab.com/blog/findjobj/</span>
</div><div id="_line0074" class="line">0074 <span class="comment">%    http://undocumentedmatlab.com/blog/findjobj-gui-display-container-hierarchy/</span>
</div><div id="_line0075" class="line">0075 <span class="comment">%</span>
</div><div id="_line0076" class="line">0076 <span class="comment">% Known issues/limitations:</span>
</div><div id="_line0077" class="line">0077 <span class="comment">%    - Cannot currently process multiple container objects - just one at a time</span>
</div><div id="_line0078" class="line">0078 <span class="comment">%    - Initial processing is a bit slow when the figure is laden with many UI components (so better use 'persist')</span>
</div><div id="_line0079" class="line">0079 <span class="comment">%    - Passing a simple container Matlab handle is currently filtered by its position+size: should find a better way to do this</span>
</div><div id="_line0080" class="line">0080 <span class="comment">%    - Matlab uipanels are not implemented as simple java panels, and so they can't be found using this utility</span>
</div><div id="_line0081" class="line">0081 <span class="comment">%    - Labels have a write-only text property in java, so they can't be found using the 'property',{'Text','string'} notation</span>
</div><div id="_line0082" class="line">0082 <span class="comment">%</span>
</div><div id="_line0083" class="line">0083 <span class="comment">% Warning:</span>
</div><div id="_line0084" class="line">0084 <span class="comment">%    This code heavily relies on undocumented and unsupported Matlab functionality.</span>
</div><div id="_line0085" class="line">0085 <span class="comment">%    It works on Matlab 7+, but use at your own risk!</span>
</div><div id="_line0086" class="line">0086 <span class="comment">%</span>
</div><div id="_line0087" class="line">0087 <span class="comment">% Bugs and suggestions:</span>
</div><div id="_line0088" class="line">0088 <span class="comment">%    Please send to Yair Altman (altmany at gmail dot com)</span>
</div><div id="_line0089" class="line">0089 <span class="comment">%</span>
</div><div id="_line0090" class="line">0090 <span class="comment">% Change log:</span>
</div><div id="_line0091" class="line">0091 <span class="comment">%    2014-01-04: Minor fix for R2014a; check for newer FEX version up to twice a day only</span>
</div><div id="_line0092" class="line">0092 <span class="comment">%    2013-12-29: Only check for newer FEX version in non-deployed mode; handled case of invisible figure container</span>
</div><div id="_line0093" class="line">0093 <span class="comment">%    2013-10-08: Fixed minor edge case (retrieving multiple scroll-panes)</span>
</div><div id="_line0094" class="line">0094 <span class="comment">%    2013-06-30: Additional fixes for the upcoming HG2</span>
</div><div id="_line0095" class="line">0095 <span class="comment">%    2013-05-15: Fix for the upcoming HG2</span>
</div><div id="_line0096" class="line">0096 <span class="comment">%    2013-02-21: Fixed HG-Java warnings</span>
</div><div id="_line0097" class="line">0097 <span class="comment">%    2013-01-23: Fixed callbacks table grouping &amp; editing bugs; added hidden properties to the properties tooltip; updated help section</span>
</div><div id="_line0098" class="line">0098 <span class="comment">%    2013-01-13: Improved callbacks table; fixed tree refresh failure; fixed: tree node-selection didn't update the props pane nor flash the selected component</span>
</div><div id="_line0099" class="line">0099 <span class="comment">%    2012-07-25: Fixes for R2012a as well as some older Matlab releases</span>
</div><div id="_line0100" class="line">0100 <span class="comment">%    2011-12-07: Fixed 'File is empty' messages in compiled apps</span>
</div><div id="_line0101" class="line">0101 <span class="comment">%    2011-11-22: Fix suggested by Ward</span>
</div><div id="_line0102" class="line">0102 <span class="comment">%    2011-02-01: Fixes for R2011a</span>
</div><div id="_line0103" class="line">0103 <span class="comment">%    2010-06-13: Fixes for R2010b; fixed download (m-file =&gt; zip-file)</span>
</div><div id="_line0104" class="line">0104 <span class="comment">%    2010-04-21: Minor fix to support combo-boxes (aka drop-down, popup-menu) on Windows</span>
</div><div id="_line0105" class="line">0105 <span class="comment">%    2010-03-17: Important release: Fixes for R2010a, debug listing, objects not found, component containers that should be ignored etc.</span>
</div><div id="_line0106" class="line">0106 <span class="comment">%    2010-02-04: Forced an EDT redraw before processing; warned if requested handle is invisible</span>
</div><div id="_line0107" class="line">0107 <span class="comment">%    2010-01-18: Found a way to display label text next to the relevant node name</span>
</div><div id="_line0108" class="line">0108 <span class="comment">%    2009-10-28: Fixed uitreenode warning</span>
</div><div id="_line0109" class="line">0109 <span class="comment">%    2009-10-27: Fixed auto-collapse of invisible container nodes; added dynamic tree tooltips &amp; context-menu; minor fix to version-check display</span>
</div><div id="_line0110" class="line">0110 <span class="comment">%    2009-09-30: Fix for Matlab 7.0 as suggested by Oliver W; minor GUI fix (classname font)</span>
</div><div id="_line0111" class="line">0111 <span class="comment">%    2009-08-07: Fixed edge-case of missing JIDE tables</span>
</div><div id="_line0112" class="line">0112 <span class="comment">%    2009-05-24: Added support for future Matlab versions that will not support JavaFrame</span>
</div><div id="_line0113" class="line">0113 <span class="comment">%    2009-05-15: Added sanity checks for axes items</span>
</div><div id="_line0114" class="line">0114 <span class="comment">%    2009-04-28: Added 'debug' input arg; increased size tolerance 1px =&gt; 2px</span>
</div><div id="_line0115" class="line">0115 <span class="comment">%    2009-04-23: Fixed location of popupmenus (always 20px high despite what's reported by Matlab...); fixed uiinspect processing issues; added blog link; narrower action buttons</span>
</div><div id="_line0116" class="line">0116 <span class="comment">%    2009-04-09: Automatic 'nomenu' for uicontrol inputs; significant performance improvement</span>
</div><div id="_line0117" class="line">0117 <span class="comment">%    2009-03-31: Fixed position of some Java components; fixed properties tooltip; fixed node visibility indication</span>
</div><div id="_line0118" class="line">0118 <span class="comment">%    2009-02-26: Indicated components visibility (&amp; auto-collapse non-visible containers); auto-highlight selected component; fixes in node icons, figure title &amp; tree refresh; improved error handling; display FindJObj version update description if available</span>
</div><div id="_line0119" class="line">0119 <span class="comment">%    2009-02-24: Fixed update check; added dedicated labels icon</span>
</div><div id="_line0120" class="line">0120 <span class="comment">%    2009-02-18: Fixed compatibility with old Matlab versions</span>
</div><div id="_line0121" class="line">0121 <span class="comment">%    2009-02-08: Callbacks table fixes; use uiinspect if available; fix update check according to new FEX website</span>
</div><div id="_line0122" class="line">0122 <span class="comment">%    2008-12-17: R2008b compatibility</span>
</div><div id="_line0123" class="line">0123 <span class="comment">%    2008-09-10: Fixed minor bug as per Johnny Smith</span>
</div><div id="_line0124" class="line">0124 <span class="comment">%    2007-11-14: Fixed edge case problem with class properties tooltip; used existing object icon if available; added checkbox option to hide standard callbacks</span>
</div><div id="_line0125" class="line">0125 <span class="comment">%    2007-08-15: Fixed object naming relative property priorities; added sanity check for illegal container arg; enabled desktop (0) container; cleaned up warnings about special class objects</span>
</div><div id="_line0126" class="line">0126 <span class="comment">%    2007-08-03: Fixed minor tagging problems with a few Java sub-classes; displayed UIClassID if text/name/tag is unavailable</span>
</div><div id="_line0127" class="line">0127 <span class="comment">%    2007-06-15: Fixed problems finding HG components found by J. Wagberg</span>
</div><div id="_line0128" class="line">0128 <span class="comment">%    2007-05-22: Added 'nomenu' option for improved performance; fixed 'export handles' bug; fixed handle-finding/display bugs; &quot;cleaner&quot; error handling</span>
</div><div id="_line0129" class="line">0129 <span class="comment">%    2007-04-23: HTMLized classname tooltip; returned top-level figure Frame handle for figure container; fixed callbacks table; auto-checked newer version; fixed Matlab 7.2 compatibility issue; added HG objects tree</span>
</div><div id="_line0130" class="line">0130 <span class="comment">%    2007-04-19: Fixed edge case of missing figure; displayed tree hierarchy in interactive GUI if no output args; workaround for figure sub-menus invisible unless clicked</span>
</div><div id="_line0131" class="line">0131 <span class="comment">%    2007-04-04: Improved performance; returned full listing results in 4th output arg; enabled partial property names &amp; property values; automatically filtered out container panels if children also returned; fixed finding sub-menu items</span>
</div><div id="_line0132" class="line">0132 <span class="comment">%    2007-03-20: First version posted on the MathWorks file exchange: &lt;a href=&quot;http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=14317&quot;&gt;http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=14317&lt;/a&gt;</span>
</div><div id="_line0133" class="line">0133 <span class="comment">%</span>
</div><div id="_line0134" class="line">0134 <span class="comment">% See also:</span>
</div><div id="_line0135" class="line">0135 <span class="comment">%    java, handle, findobj, findall, javaGetHandles, uiinspect (on the File Exchange)</span>
</div><div id="_line0136" class="line">0136 
</div><div id="_line0137" class="line">0137 <span class="comment">% License to use and modify this code is granted freely to all interested, as long as the original author is</span>
</div><div id="_line0138" class="line">0138 <span class="comment">% referenced and attributed as such. The original author maintains the right to be solely associated with this work.</span>
</div><div id="_line0139" class="line">0139 
</div><div id="_line0140" class="line">0140 <span class="comment">% Programmed and Copyright by Yair M. Altman: altmany(at)gmail.com</span>
</div><div id="_line0141" class="line">0141 <span class="comment">% $Revision: 1.42 $  $Date: 2014/01/04 20:41:54 $</span>
</div><div id="_line0142" class="line">0142 
</div><div id="_line0143" class="line">0143     <span class="comment">% Ensure Java AWT is enabled</span>
</div><div id="_line0144" class="line">0144     error(javachk(<span class="string">'awt'</span>));
</div><div id="_line0145" class="line">0145 
</div><div id="_line0146" class="line">0146     <span class="keyword">persistent</span> pContainer pHandles pLevels pParentIdx pPositions
</div><div id="_line0147" class="line">0147 
</div><div id="_line0148" class="line">0148     <span class="keyword">try</span>
</div><div id="_line0149" class="line">0149         <span class="comment">% Initialize</span>
</div><div id="_line0150" class="line">0150         handles = handle([]);
</div><div id="_line0151" class="line">0151         levels = [];
</div><div id="_line0152" class="line">0152         parentIdx = [];
</div><div id="_line0153" class="line">0153         positions = [];   <span class="comment">% Java positions start at the top-left corner</span>
</div><div id="_line0154" class="line">0154         <span class="comment">%sizes = [];</span>
</div><div id="_line0155" class="line">0155         listing = <span class="string">''</span>;
</div><div id="_line0156" class="line">0156         hg_levels = [];
</div><div id="_line0157" class="line">0157         hg_handles = handle([]);  <span class="comment">% HG handles are double</span>
</div><div id="_line0158" class="line">0158         hg_parentIdx = [];
</div><div id="_line0159" class="line">0159         nomenu = false;
</div><div id="_line0160" class="line">0160         menuBarFoundFlag = false;
</div><div id="_line0161" class="line">0161         hFig = [];
</div><div id="_line0162" class="line">0162 
</div><div id="_line0163" class="line">0163         <span class="comment">% Force an EDT redraw before processing, to ensure all uicontrols etc. are rendered</span>
</div><div id="_line0164" class="line">0164         drawnow;  pause(0.02);
</div><div id="_line0165" class="line">0165 
</div><div id="_line0166" class="line">0166         <span class="comment">% Default container is the current figure's root panel</span>
</div><div id="_line0167" class="line">0167         <span class="keyword">if</span> nargin
</div><div id="_line0168" class="line">0168             <span class="keyword">if</span> isempty(container)  <span class="comment">% empty container - bail out</span>
</div><div id="_line0169" class="line">0169                 <span class="keyword">return</span>;
</div><div id="_line0170" class="line">0170             <span class="keyword">elseif</span> <a href="#_sub52" class="code" title="subischar">ischar</a>(container)  <span class="comment">% container skipped - this is part of the args list...</span>
</div><div id="_line0171" class="line">0171                 varargin = {container, varargin{:}};
</div><div id="_line0172" class="line">0172                 origContainer = <a href="#_sub3" class="code" title="subgetCurrentFigure">getCurrentFigure</a>;
</div><div id="_line0173" class="line">0173                 [container,contentSize] = <a href="#_sub4" class="code" title="subgetRootPanel">getRootPanel</a>(origContainer);
</div><div id="_line0174" class="line">0174             <span class="keyword">elseif</span> isequal(container,0)  <span class="comment">% root</span>
</div><div id="_line0175" class="line">0175                 origContainer = handle(container);
</div><div id="_line0176" class="line">0176                 container = com.mathworks.mde.desk.MLDesktop.getInstance.getMainFrame;
</div><div id="_line0177" class="line">0177                 contentSize = [container.getWidth, container.getHeight];
</div><div id="_line0178" class="line">0178             <span class="keyword">elseif</span> ishghandle(container) <span class="comment">% &amp;&amp; ~isa(container,'java.awt.Container')</span>
</div><div id="_line0179" class="line">0179                 container = container(1);  <span class="comment">% another current limitation...</span>
</div><div id="_line0180" class="line">0180                 hFig = ancestor(container,<span class="string">'figure'</span>);
</div><div id="_line0181" class="line">0181                 origContainer = handle(container);
</div><div id="_line0182" class="line">0182                 <span class="keyword">if</span> isa(origContainer,<span class="string">'uimenu'</span>)
</div><div id="_line0183" class="line">0183                     <span class="comment">% getpixelposition doesn't work for menus... - damn!</span>
</div><div id="_line0184" class="line">0184                     varargin = {<span class="string">'class'</span>,<span class="string">'MenuPeer'</span>, <span class="string">'property'</span>,{<span class="string">'Label'</span>,strrep(get(container,<span class="string">'Label'</span>),<span class="string">'&amp;'</span>,<span class="string">''</span>)}, varargin{:}};
</div><div id="_line0185" class="line">0185                 <span class="keyword">elseif</span> ~isa(origContainer, <span class="string">'figure'</span>) &amp;&amp; ~isempty(hFig)
</div><div id="_line0186" class="line">0186                     <span class="comment">% See limitations section above: should find a better way to directly refer to the element's java container</span>
</div><div id="_line0187" class="line">0187                     <span class="keyword">try</span>
</div><div id="_line0188" class="line">0188                         <span class="comment">% Note: 'PixelBounds' is undocumented and unsupported, but much faster than getpixelposition!</span>
</div><div id="_line0189" class="line">0189                         <span class="comment">% ^^^^  unfortunately, its Y position is inaccurate in some cases - damn!</span>
</div><div id="_line0190" class="line">0190                         <span class="comment">%size = get(container,'PixelBounds');</span>
</div><div id="_line0191" class="line">0191                         pos = fix(getpixelposition(container,1));
</div><div id="_line0192" class="line">0192                         <span class="comment">%varargin = {'position',pos(1:2), 'size',pos(3:4), 'not','class','java.awt.Panel', varargin{:}};</span>
</div><div id="_line0193" class="line">0193                     <span class="keyword">catch</span>
</div><div id="_line0194" class="line">0194                         <span class="keyword">try</span>
</div><div id="_line0195" class="line">0195                             figName = get(hFig,<span class="string">'name'</span>);
</div><div id="_line0196" class="line">0196                             <span class="keyword">if</span> strcmpi(get(hFig,<span class="string">'number'</span>),<span class="string">'on'</span>)
</div><div id="_line0197" class="line">0197                                 figName = regexprep([<span class="string">'Figure '</span> num2str(hFig) <span class="string">': '</span> figName],<span class="string">': $'</span>,<span class="string">''</span>);
</div><div id="_line0198" class="line">0198                             <span class="keyword">end</span>
</div><div id="_line0199" class="line">0199                             mde = com.mathworks.mde.desk.MLDesktop.getInstance;
</div><div id="_line0200" class="line">0200                             jFig = mde.getClient(figName);
</div><div id="_line0201" class="line">0201                             <span class="keyword">if</span> isempty(jFig), error(<span class="string">'dummy'</span>);  <span class="keyword">end</span>
</div><div id="_line0202" class="line">0202                         <span class="keyword">catch</span>
</div><div id="_line0203" class="line">0203                             warning(<span class="string">'off'</span>,<span class="string">'MATLAB:HandleGraphics:ObsoletedProperty:JavaFrame'</span>);  <span class="comment">% R2008b compatibility</span>
</div><div id="_line0204" class="line">0204                             jFig = get(get(hFig,<span class="string">'JavaFrame'</span>),<span class="string">'FigurePanelContainer'</span>);
</div><div id="_line0205" class="line">0205                         <span class="keyword">end</span>
</div><div id="_line0206" class="line">0206                         pos = [];
</div><div id="_line0207" class="line">0207                         <span class="keyword">try</span>
</div><div id="_line0208" class="line">0208                             pxsize = get(container,<span class="string">'PixelBounds'</span>);
</div><div id="_line0209" class="line">0209                             pos = [pxsize(1)+5, jFig.getHeight - (pxsize(4)-5)];
</div><div id="_line0210" class="line">0210                         <span class="keyword">catch</span>
</div><div id="_line0211" class="line">0211                             <span class="comment">% never mind...</span>
</div><div id="_line0212" class="line">0212                         <span class="keyword">end</span>
</div><div id="_line0213" class="line">0213                     <span class="keyword">end</span>
</div><div id="_line0214" class="line">0214                     <span class="keyword">if</span> size(pos,2) == 2
</div><div id="_line0215" class="line">0215                         pos(:,3:4) = 0;
</div><div id="_line0216" class="line">0216                     <span class="keyword">end</span>
</div><div id="_line0217" class="line">0217                     <span class="keyword">if</span> ~isempty(pos)
</div><div id="_line0218" class="line">0218                         <span class="keyword">if</span> isa(handle(container),<span class="string">'uicontrol'</span>) &amp;&amp; strcmp(get(container,<span class="string">'style'</span>),<span class="string">'popupmenu'</span>)
</div><div id="_line0219" class="line">0219                             <span class="comment">% popupmenus (combo-box dropdowns) are always 20px high</span>
</div><div id="_line0220" class="line">0220                             pos(2) = pos(2) + pos(4) - 20;
</div><div id="_line0221" class="line">0221                             pos(4) = 20;
</div><div id="_line0222" class="line">0222                         <span class="keyword">end</span>
</div><div id="_line0223" class="line">0223                         <span class="comment">%varargin = {'position',pos(1:2), 'size',size(3:4)-size(1:2)-10, 'not','class','java.awt.Panel', varargin{:}};</span>
</div><div id="_line0224" class="line">0224                         varargin = {<span class="string">'position'</span>,pos(1:2)+[0,pos(4)], <span class="string">'size'</span>,pos(3:4), <span class="string">'not'</span>,<span class="string">'class'</span>,<span class="string">'java.awt.Panel'</span>, <span class="string">'nomenu'</span>, varargin{:}};
</div><div id="_line0225" class="line">0225                     <span class="keyword">end</span>
</div><div id="_line0226" class="line">0226                 <span class="keyword">elseif</span> isempty(hFig)
</div><div id="_line0227" class="line">0227                     hFig = handle(container);
</div><div id="_line0228" class="line">0228                 <span class="keyword">end</span>
</div><div id="_line0229" class="line">0229                 [container,contentSize] = <a href="#_sub4" class="code" title="subgetRootPanel">getRootPanel</a>(hFig);
</div><div id="_line0230" class="line">0230             <span class="keyword">elseif</span> isjava(container)
</div><div id="_line0231" class="line">0231                 <span class="comment">% Maybe a java container obj (will crash otherwise)</span>
</div><div id="_line0232" class="line">0232                 origContainer = container;
</div><div id="_line0233" class="line">0233                 contentSize = [container.getWidth, container.getHeight];
</div><div id="_line0234" class="line">0234             <span class="keyword">else</span>
</div><div id="_line0235" class="line">0235                 error(<span class="string">'YMA:findjobj:IllegalContainer'</span>,<span class="string">'Input arg does not appear to be a valid GUI object'</span>);
</div><div id="_line0236" class="line">0236             <span class="keyword">end</span>
</div><div id="_line0237" class="line">0237         <span class="keyword">else</span>
</div><div id="_line0238" class="line">0238             <span class="comment">% Default container = current figure</span>
</div><div id="_line0239" class="line">0239             origContainer = <a href="#_sub3" class="code" title="subgetCurrentFigure">getCurrentFigure</a>;
</div><div id="_line0240" class="line">0240             [container,contentSize] = <a href="#_sub4" class="code" title="subgetRootPanel">getRootPanel</a>(origContainer);
</div><div id="_line0241" class="line">0241         <span class="keyword">end</span>
</div><div id="_line0242" class="line">0242 
</div><div id="_line0243" class="line">0243         <span class="comment">% Check persistency</span>
</div><div id="_line0244" class="line">0244         <span class="keyword">if</span> isequal(pContainer,container)
</div><div id="_line0245" class="line">0245             <span class="comment">% persistency requested and the same container is reused, so reuse the hierarchy information</span>
</div><div id="_line0246" class="line">0246             [handles,levels,parentIdx,positions] = deal(pHandles, pLevels, pParentIdx, pPositions);
</div><div id="_line0247" class="line">0247         <span class="keyword">else</span>
</div><div id="_line0248" class="line">0248             <span class="comment">% Pre-allocate space of complex data containers for improved performance</span>
</div><div id="_line0249" class="line">0249             handles = repmat(handles,1,1000);
</div><div id="_line0250" class="line">0250             positions = zeros(1000,2);
</div><div id="_line0251" class="line">0251 
</div><div id="_line0252" class="line">0252             <span class="comment">% Check whether to skip menu processing</span>
</div><div id="_line0253" class="line">0253             nomenu = <a href="#_sub2" class="code" title="subparamSupplied">paramSupplied</a>(varargin,<span class="string">'nomenu'</span>);
</div><div id="_line0254" class="line">0254 
</div><div id="_line0255" class="line">0255             <span class="comment">% Traverse the container hierarchy and extract the elements within</span>
</div><div id="_line0256" class="line">0256             <a href="#_sub5" class="code" title="subtraverseContainer">traverseContainer</a>(container,0,1);
</div><div id="_line0257" class="line">0257 
</div><div id="_line0258" class="line">0258             <span class="comment">% Remove unnecessary pre-allocated elements</span>
</div><div id="_line0259" class="line">0259             dataLen = length(levels);
</div><div id="_line0260" class="line">0260             handles  (dataLen+1:end) = [];
</div><div id="_line0261" class="line">0261             positions(dataLen+1:<span class="keyword">end</span>,:) = [];
</div><div id="_line0262" class="line">0262         <span class="keyword">end</span>
</div><div id="_line0263" class="line">0263 
</div><div id="_line0264" class="line">0264         <span class="comment">% Process persistency check before any filtering is done</span>
</div><div id="_line0265" class="line">0265         <span class="keyword">if</span> <a href="#_sub2" class="code" title="subparamSupplied">paramSupplied</a>(varargin,<span class="string">'persist'</span>)
</div><div id="_line0266" class="line">0266             [pContainer, pHandles, pLevels, pParentIdx, pPositions] = deal(container,handles,levels,parentIdx,positions);
</div><div id="_line0267" class="line">0267         <span class="keyword">end</span>
</div><div id="_line0268" class="line">0268 
</div><div id="_line0269" class="line">0269         <span class="comment">% Save data for possible future use in presentObjectTree() below</span>
</div><div id="_line0270" class="line">0270         allHandles = handles;
</div><div id="_line0271" class="line">0271         allLevels  = levels;
</div><div id="_line0272" class="line">0272         allParents = parentIdx;
</div><div id="_line0273" class="line">0273         selectedIdx = 1:length(handles);
</div><div id="_line0274" class="line">0274         <span class="comment">%[positions(:,1)-container.getX, container.getHeight - positions(:,2)]</span>
</div><div id="_line0275" class="line">0275 
</div><div id="_line0276" class="line">0276         <span class="comment">% Debug-list all found compponents and their positions</span>
</div><div id="_line0277" class="line">0277         <span class="keyword">if</span> <a href="#_sub2" class="code" title="subparamSupplied">paramSupplied</a>(varargin,<span class="string">'debug'</span>)
</div><div id="_line0278" class="line">0278             <span class="keyword">for</span> handleIdx = 1 : length(allHandles)
</div><div id="_line0279" class="line">0279                 thisObj = handles(handleIdx);
</div><div id="_line0280" class="line">0280                 pos = sprintf(<span class="string">'%d,%d %dx%d'</span>,[positions(handleIdx,:) getWidth(thisObj) getHeight(thisObj)]);
</div><div id="_line0281" class="line">0281                 disp([repmat(<span class="string">' '</span>,1,levels(handleIdx)) <span class="string">'['</span> pos <span class="string">'] '</span> char(toString(thisObj))]);
</div><div id="_line0282" class="line">0282             <span class="keyword">end</span>
</div><div id="_line0283" class="line">0283         <span class="keyword">end</span>
</div><div id="_line0284" class="line">0284 
</div><div id="_line0285" class="line">0285         <span class="comment">% Process optional args</span>
</div><div id="_line0286" class="line">0286         <span class="comment">% Note: positions is NOT returned since it's based on java coord system (origin = top-left): will confuse Matlab users</span>
</div><div id="_line0287" class="line">0287         <a href="#_sub9" class="code" title="subprocessArgs">processArgs</a>(varargin{:});
</div><div id="_line0288" class="line">0288 
</div><div id="_line0289" class="line">0289         <span class="comment">% De-cell and trim listing, if only one element was found (no use for indented listing in this case)</span>
</div><div id="_line0290" class="line">0290         <span class="keyword">if</span> iscell(listing) &amp;&amp; length(listing)==1
</div><div id="_line0291" class="line">0291             listing = strtrim(listing{1});
</div><div id="_line0292" class="line">0292         <span class="keyword">end</span>
</div><div id="_line0293" class="line">0293 
</div><div id="_line0294" class="line">0294         <span class="comment">% If no output args and no listing requested, present the FINDJOBJ interactive GUI</span>
</div><div id="_line0295" class="line">0295         <span class="keyword">if</span> nargout == 0 &amp;&amp; isempty(listing)
</div><div id="_line0296" class="line">0296 
</div><div id="_line0297" class="line">0297             <span class="comment">% Get all label positions</span>
</div><div id="_line0298" class="line">0298             hg_labels = [];
</div><div id="_line0299" class="line">0299             labelPositions = <a href="#_sub49" class="code" title="subgetLabelsJavaPos">getLabelsJavaPos</a>(container);
</div><div id="_line0300" class="line">0300 
</div><div id="_line0301" class="line">0301             <span class="comment">% Present the GUI (object tree)</span>
</div><div id="_line0302" class="line">0302             <span class="keyword">if</span> ~isempty(container)
</div><div id="_line0303" class="line">0303                 <a href="#_sub22" class="code" title="subpresentObjectTree">presentObjectTree</a>();
</div><div id="_line0304" class="line">0304             <span class="keyword">else</span>
</div><div id="_line0305" class="line">0305                 <a href="#_sub1" class="code" title="subwarnInvisible">warnInvisible</a>(varargin{:});
</div><div id="_line0306" class="line">0306             <span class="keyword">end</span>
</div><div id="_line0307" class="line">0307 
</div><div id="_line0308" class="line">0308         <span class="comment">% Display the listing, if this was specifically requested yet no relevant output arg was specified</span>
</div><div id="_line0309" class="line">0309         <span class="keyword">elseif</span> nargout &lt; 4 &amp;&amp; ~isempty(listing)
</div><div id="_line0310" class="line">0310             <span class="keyword">if</span> ~iscell(listing)
</div><div id="_line0311" class="line">0311                 disp(listing);
</div><div id="_line0312" class="line">0312             <span class="keyword">else</span>
</div><div id="_line0313" class="line">0313                 <span class="keyword">for</span> listingIdx = 1 : length(listing)
</div><div id="_line0314" class="line">0314                     disp(listing{listingIdx});
</div><div id="_line0315" class="line">0315                 <span class="keyword">end</span>
</div><div id="_line0316" class="line">0316             <span class="keyword">end</span>
</div><div id="_line0317" class="line">0317         <span class="keyword">end</span>
</div><div id="_line0318" class="line">0318 
</div><div id="_line0319" class="line">0319         <span class="comment">% Display a warning if the requested handle was not found because it's invisible</span>
</div><div id="_line0320" class="line">0320         <span class="keyword">if</span> nargout &amp;&amp; isempty(handles)
</div><div id="_line0321" class="line">0321             <a href="#_sub1" class="code" title="subwarnInvisible">warnInvisible</a>(varargin{:});
</div><div id="_line0322" class="line">0322         <span class="keyword">end</span>
</div><div id="_line0323" class="line">0323 
</div><div id="_line0324" class="line">0324         <span class="keyword">return</span>;  <span class="comment">%debug point</span>
</div><div id="_line0325" class="line">0325 
</div><div id="_line0326" class="line">0326     <span class="keyword">catch</span>
</div><div id="_line0327" class="line">0327         <span class="comment">% 'Cleaner' error handling - strip the stack info etc.</span>
</div><div id="_line0328" class="line">0328         err = lasterror;  <span class="comment">%#ok</span>
</div><div id="_line0329" class="line">0329         err.message = regexprep(err.message,<span class="string">'Error using ==&gt; [^\n]+\n'</span>,<span class="string">''</span>);
</div><div id="_line0330" class="line">0330         <span class="keyword">if</span> isempty(findstr(mfilename,err.message))
</div><div id="_line0331" class="line">0331             <span class="comment">% Indicate error origin, if not already stated within the error message</span>
</div><div id="_line0332" class="line">0332             err.message = [mfilename <span class="string">': '</span> err.message];
</div><div id="_line0333" class="line">0333         <span class="keyword">end</span>
</div><div id="_line0334" class="line">0334         rethrow(err);
</div><div id="_line0335" class="line">0335     <span class="keyword">end</span>
</div><div id="_line0336" class="line">0336 
</div><div id="_line0337" class="line">0337     <span class="comment">%% Display a warning if the requested handle was not found because it's invisible</span>
</div><div id="_line0338" class="line">0338     <a name="_sub1" href="#_subfunctions" class="code">function warnInvisible(varargin)</a>
</div><div id="_line0339" class="line">0339         <span class="keyword">try</span>
</div><div id="_line0340" class="line">0340             <span class="keyword">if</span> strcmpi(get(hFig,<span class="string">'Visible'</span>),<span class="string">'off'</span>)
</div><div id="_line0341" class="line">0341                 pos = get(hFig,<span class="string">'Position'</span>);
</div><div id="_line0342" class="line">0342                 set(hFig, <span class="string">'Position'</span>,pos-[5000,5000,0,0], <span class="string">'Visible'</span>,<span class="string">'on'</span>);
</div><div id="_line0343" class="line">0343                 drawnow; pause(0.01);
</div><div id="_line0344" class="line">0344                 [handles,levels,parentIdx,listing] = <a href="findjobj.html" class="code" title="function [handles,levels,parentIdx,listing] = findjobj(container,varargin) %#ok<*CTCH,*ASGLU,*MSNU,*NASGU>">findjobj</a>(origContainer,varargin{:});
</div><div id="_line0345" class="line">0345                 set(hFig, <span class="string">'Position'</span>,pos, <span class="string">'Visible'</span>,<span class="string">'off'</span>);
</div><div id="_line0346" class="line">0346             <span class="keyword">end</span>
</div><div id="_line0347" class="line">0347         <span class="keyword">catch</span>
</div><div id="_line0348" class="line">0348             <span class="comment">% ignore - move on...</span>
</div><div id="_line0349" class="line">0349         <span class="keyword">end</span>
</div><div id="_line0350" class="line">0350         <span class="keyword">try</span>
</div><div id="_line0351" class="line">0351             stk = dbstack;
</div><div id="_line0352" class="line">0352             stkNames = {stk.name};
</div><div id="_line0353" class="line">0353             OutputFcnIdx = find(~cellfun(@isempty,regexp(stkNames,<span class="string">'_OutputFcn'</span>)));
</div><div id="_line0354" class="line">0354             <span class="keyword">if</span> ~isempty(OutputFcnIdx)
</div><div id="_line0355" class="line">0355                 OutputFcnName = stkNames{OutputFcnIdx};
</div><div id="_line0356" class="line">0356                 warning(<span class="string">'YMA:FindJObj:OutputFcn'</span>,[<span class="string">'No Java reference was found for the requested handle, because the figure is still invisible in '</span> OutputFcnName <span class="string">'()'</span>]);
</div><div id="_line0357" class="line">0357             <span class="keyword">elseif</span> ishandle(origContainer) &amp;&amp; isprop(origContainer,<span class="string">'Visible'</span>) &amp;&amp; strcmpi(get(origContainer,<span class="string">'Visible'</span>),<span class="string">'off'</span>)
</div><div id="_line0358" class="line">0358                 warning(<span class="string">'YMA:FindJObj:invisibleHandle'</span>,<span class="string">'No Java reference was found for the requested handle, probably because it is still invisible'</span>);
</div><div id="_line0359" class="line">0359             <span class="keyword">end</span>
</div><div id="_line0360" class="line">0360         <span class="keyword">catch</span>
</div><div id="_line0361" class="line">0361             <span class="comment">% Never mind...</span>
</div><div id="_line0362" class="line">0362         <span class="keyword">end</span>
</div><div id="_line0363" class="line">0363     <span class="keyword">end</span>
</div><div id="_line0364" class="line">0364 
</div><div id="_line0365" class="line">0365     <span class="comment">%% Check existence of a (case-insensitive) optional parameter in the params list</span>
</div><div id="_line0366" class="line">0366     <a name="_sub2" href="#_subfunctions" class="code">function [flag,idx] = paramSupplied(paramsList,paramName)</a>
</div><div id="_line0367" class="line">0367         <span class="comment">%idx = find(~cellfun('isempty',regexpi(paramsList(cellfun(@ischar,paramsList)),['^-?' paramName])));</span>
</div><div id="_line0368" class="line">0368         idx = find(~cellfun(<span class="string">'isempty'</span>,regexpi(paramsList(cellfun(<span class="string">'isclass'</span>,paramsList,<span class="string">'char'</span>)),[<span class="string">'^-?'</span> paramName])));  <span class="comment">% 30/9/2009 fix for ML 7.0 suggested by Oliver W</span>
</div><div id="_line0369" class="line">0369         flag = any(idx);
</div><div id="_line0370" class="line">0370     <span class="keyword">end</span>
</div><div id="_line0371" class="line">0371 
</div><div id="_line0372" class="line">0372     <span class="comment">%% Get current figure (even if its 'HandleVisibility' property is 'off')</span>
</div><div id="_line0373" class="line">0373     <a name="_sub3" href="#_subfunctions" class="code">function curFig = getCurrentFigure</a>
</div><div id="_line0374" class="line">0374         oldShowHidden = get(0,<span class="string">'ShowHiddenHandles'</span>);
</div><div id="_line0375" class="line">0375         set(0,<span class="string">'ShowHiddenHandles'</span>,<span class="string">'on'</span>);  <span class="comment">% minor fix per Johnny Smith</span>
</div><div id="_line0376" class="line">0376         curFig = gcf;
</div><div id="_line0377" class="line">0377         set(0,<span class="string">'ShowHiddenHandles'</span>,oldShowHidden);
</div><div id="_line0378" class="line">0378     <span class="keyword">end</span>
</div><div id="_line0379" class="line">0379 
</div><div id="_line0380" class="line">0380     <span class="comment">%% Get Java reference to top-level (root) panel - actually, a reference to the java figure</span>
</div><div id="_line0381" class="line">0381     <a name="_sub4" href="#_subfunctions" class="code">function [jRootPane,contentSize] = getRootPanel(hFig)</a>
</div><div id="_line0382" class="line">0382         <span class="keyword">try</span>
</div><div id="_line0383" class="line">0383             contentSize = [0,0];  <span class="comment">% initialize</span>
</div><div id="_line0384" class="line">0384             jRootPane = hFig;
</div><div id="_line0385" class="line">0385             figName = get(hFig,<span class="string">'name'</span>);
</div><div id="_line0386" class="line">0386             <span class="keyword">if</span> strcmpi(get(hFig,<span class="string">'number'</span>),<span class="string">'on'</span>)
</div><div id="_line0387" class="line">0387                 figName = regexprep([<span class="string">'Figure '</span> num2str(hFig) <span class="string">': '</span> figName],<span class="string">': $'</span>,<span class="string">''</span>);
</div><div id="_line0388" class="line">0388             <span class="keyword">end</span>
</div><div id="_line0389" class="line">0389             mde = com.mathworks.mde.desk.MLDesktop.getInstance;
</div><div id="_line0390" class="line">0390             jFigPanel = mde.getClient(figName);
</div><div id="_line0391" class="line">0391             jRootPane = jFigPanel;
</div><div id="_line0392" class="line">0392             jRootPane = jFigPanel.getRootPane;
</div><div id="_line0393" class="line">0393         <span class="keyword">catch</span>
</div><div id="_line0394" class="line">0394             <span class="keyword">try</span>
</div><div id="_line0395" class="line">0395                 warning(<span class="string">'off'</span>,<span class="string">'MATLAB:HandleGraphics:ObsoletedProperty:JavaFrame'</span>);  <span class="comment">% R2008b compatibility</span>
</div><div id="_line0396" class="line">0396                 jFrame = get(hFig,<span class="string">'JavaFrame'</span>);
</div><div id="_line0397" class="line">0397                 jFigPanel = get(jFrame,<span class="string">'FigurePanelContainer'</span>);
</div><div id="_line0398" class="line">0398                 jRootPane = jFigPanel;
</div><div id="_line0399" class="line">0399                 jRootPane = jFigPanel.getComponent(0).getRootPane;
</div><div id="_line0400" class="line">0400             <span class="keyword">catch</span>
</div><div id="_line0401" class="line">0401                 <span class="comment">% Never mind</span>
</div><div id="_line0402" class="line">0402             <span class="keyword">end</span>
</div><div id="_line0403" class="line">0403         <span class="keyword">end</span>
</div><div id="_line0404" class="line">0404         <span class="keyword">try</span>
</div><div id="_line0405" class="line">0405             <span class="comment">% If invalid RootPane - try another method...</span>
</div><div id="_line0406" class="line">0406             warning(<span class="string">'off'</span>,<span class="string">'MATLAB:HandleGraphics:ObsoletedProperty:JavaFrame'</span>);  <span class="comment">% R2008b compatibility</span>
</div><div id="_line0407" class="line">0407             jFrame = get(hFig,<span class="string">'JavaFrame'</span>);
</div><div id="_line0408" class="line">0408             jAxisComponent = get(jFrame,<span class="string">'AxisComponent'</span>);
</div><div id="_line0409" class="line">0409             jRootPane = jAxisComponent.getParent.getParent.getRootPane;
</div><div id="_line0410" class="line">0410         <span class="keyword">catch</span>
</div><div id="_line0411" class="line">0411             <span class="comment">% Never mind</span>
</div><div id="_line0412" class="line">0412         <span class="keyword">end</span>
</div><div id="_line0413" class="line">0413         <span class="keyword">try</span>
</div><div id="_line0414" class="line">0414             <span class="comment">% If invalid RootPane, retry up to N times</span>
</div><div id="_line0415" class="line">0415             tries = 10;
</div><div id="_line0416" class="line">0416             <span class="keyword">while</span> isempty(jRootPane) &amp;&amp; tries&gt;0  <span class="comment">% might happen if figure is still undergoing rendering...</span>
</div><div id="_line0417" class="line">0417                 drawnow; pause(0.001);
</div><div id="_line0418" class="line">0418                 tries = tries - 1;
</div><div id="_line0419" class="line">0419                 jRootPane = jFigPanel.getComponent(0).getRootPane;
</div><div id="_line0420" class="line">0420             <span class="keyword">end</span>
</div><div id="_line0421" class="line">0421 
</div><div id="_line0422" class="line">0422             <span class="comment">% If still invalid, use FigurePanelContainer which is good enough in 99% of cases... (menu/tool bars won't be accessible, though)</span>
</div><div id="_line0423" class="line">0423             <span class="keyword">if</span> isempty(jRootPane)
</div><div id="_line0424" class="line">0424                 jRootPane = jFigPanel;
</div><div id="_line0425" class="line">0425             <span class="keyword">end</span>
</div><div id="_line0426" class="line">0426             contentSize = [jRootPane.getWidth, jRootPane.getHeight];
</div><div id="_line0427" class="line">0427 
</div><div id="_line0428" class="line">0428             <span class="comment">% Try to get the ancestor FigureFrame</span>
</div><div id="_line0429" class="line">0429             jRootPane = jRootPane.getTopLevelAncestor;
</div><div id="_line0430" class="line">0430         <span class="keyword">catch</span>
</div><div id="_line0431" class="line">0431             <span class="comment">% Never mind - FigurePanelContainer is good enough in 99% of cases... (menu/tool bars won't be accessible, though)</span>
</div><div id="_line0432" class="line">0432         <span class="keyword">end</span>
</div><div id="_line0433" class="line">0433     <span class="keyword">end</span>
</div><div id="_line0434" class="line">0434 
</div><div id="_line0435" class="line">0435     <span class="comment">%% Traverse the container hierarchy and extract the elements within</span>
</div><div id="_line0436" class="line">0436     <a name="_sub5" href="#_subfunctions" class="code">function traverseContainer(jcontainer,level,parent)</a>
</div><div id="_line0437" class="line">0437         <span class="keyword">persistent</span> figureComponentFound menuRootFound
</div><div id="_line0438" class="line">0438 
</div><div id="_line0439" class="line">0439         <span class="comment">% Record the data for this node</span>
</div><div id="_line0440" class="line">0440         <span class="comment">%disp([repmat(' ',1,level) '&lt;= ' char(jcontainer.toString)])</span>
</div><div id="_line0441" class="line">0441         thisIdx = length(levels) + 1;
</div><div id="_line0442" class="line">0442         levels(thisIdx) = level;
</div><div id="_line0443" class="line">0443         parentIdx(thisIdx) = parent;
</div><div id="_line0444" class="line">0444         handles(thisIdx) = handle(jcontainer,<span class="string">'callbackproperties'</span>);
</div><div id="_line0445" class="line">0445         <span class="keyword">try</span>
</div><div id="_line0446" class="line">0446             positions(thisIdx,:) = <a href="#_sub6" class="code" title="subgetXY">getXY</a>(jcontainer);
</div><div id="_line0447" class="line">0447             <span class="comment">%sizes(thisIdx,:) = [jcontainer.getWidth, jcontainer.getHeight];</span>
</div><div id="_line0448" class="line">0448         <span class="keyword">catch</span>
</div><div id="_line0449" class="line">0449             positions(thisIdx,:) = [0,0];
</div><div id="_line0450" class="line">0450             <span class="comment">%sizes(thisIdx,:) = [0,0];</span>
</div><div id="_line0451" class="line">0451         <span class="keyword">end</span>
</div><div id="_line0452" class="line">0452         <span class="keyword">if</span> level&gt;0
</div><div id="_line0453" class="line">0453             positions(thisIdx,:) = positions(thisIdx,:) + positions(parent,:);
</div><div id="_line0454" class="line">0454             <span class="keyword">if</span> ~figureComponentFound &amp;&amp; <span class="keyword">...</span>
</div><div id="_line0455" class="line">0455                strcmp(jcontainer.getName,<span class="string">'fComponentContainer'</span>) &amp;&amp; <span class="keyword">...</span>
</div><div id="_line0456" class="line">0456                isa(jcontainer,<span class="string">'com.mathworks.hg.peer.FigureComponentContainer'</span>)   <span class="comment">% there are 2 FigureComponentContainers - only process one...</span>
</div><div id="_line0457" class="line">0457 
</div><div id="_line0458" class="line">0458                 <span class="comment">% restart coordinate system, to exclude menu &amp; toolbar areas</span>
</div><div id="_line0459" class="line">0459                 positions(thisIdx,:) = positions(thisIdx,:) - [jcontainer.getRootPane.getX, jcontainer.getRootPane.getY];
</div><div id="_line0460" class="line">0460                 figureComponentFound = true;
</div><div id="_line0461" class="line">0461             <span class="keyword">end</span>
</div><div id="_line0462" class="line">0462         <span class="keyword">elseif</span> level==1
</div><div id="_line0463" class="line">0463             positions(thisIdx,:) = positions(thisIdx,:) + positions(parent,:);
</div><div id="_line0464" class="line">0464         <span class="keyword">else</span>
</div><div id="_line0465" class="line">0465             <span class="comment">% level 0 - initialize flags used later</span>
</div><div id="_line0466" class="line">0466             figureComponentFound = false;
</div><div id="_line0467" class="line">0467             menuRootFound = false;
</div><div id="_line0468" class="line">0468         <span class="keyword">end</span>
</div><div id="_line0469" class="line">0469         parentId = length(parentIdx);
</div><div id="_line0470" class="line">0470 
</div><div id="_line0471" class="line">0471         <span class="comment">% Traverse Menu items, unless the 'nomenu' option was requested</span>
</div><div id="_line0472" class="line">0472         <span class="keyword">if</span> ~nomenu
</div><div id="_line0473" class="line">0473             <span class="keyword">try</span>
</div><div id="_line0474" class="line">0474                 <span class="keyword">for</span> child = 1 : <a href="#_sub7" class="code" title="subgetNumMenuComponents">getNumMenuComponents</a>(jcontainer)
</div><div id="_line0475" class="line">0475                     <a href="#_sub5" class="code" title="subtraverseContainer">traverseContainer</a>(jcontainer.getMenuComponent(child-1),level+1,parentId);
</div><div id="_line0476" class="line">0476                 <span class="keyword">end</span>
</div><div id="_line0477" class="line">0477             <span class="keyword">catch</span>
</div><div id="_line0478" class="line">0478                 <span class="comment">% Probably not a Menu container, but maybe a top-level JMenu, so discard duplicates</span>
</div><div id="_line0479" class="line">0479                 <span class="comment">%if isa(handles(end).java,'javax.swing.JMenuBar')</span>
</div><div id="_line0480" class="line">0480                 <span class="keyword">if</span> ~menuRootFound &amp;&amp; strcmp(class(java(handles(end))),<span class="string">'javax.swing.JMenuBar'</span>)  <span class="comment">%faster...</span>
</div><div id="_line0481" class="line">0481                     <span class="keyword">if</span> <a href="#_sub8" class="code" title="subremoveDuplicateNode">removeDuplicateNode</a>(thisIdx)
</div><div id="_line0482" class="line">0482                         menuRootFound = true;
</div><div id="_line0483" class="line">0483                         <span class="keyword">return</span>;
</div><div id="_line0484" class="line">0484                     <span class="keyword">end</span>
</div><div id="_line0485" class="line">0485                 <span class="keyword">end</span>
</div><div id="_line0486" class="line">0486             <span class="keyword">end</span>
</div><div id="_line0487" class="line">0487         <span class="keyword">end</span>
</div><div id="_line0488" class="line">0488 
</div><div id="_line0489" class="line">0489         <span class="comment">% Now recursively process all this node's children (if any), except menu items if so requested</span>
</div><div id="_line0490" class="line">0490         <span class="comment">%if isa(jcontainer,'java.awt.Container')</span>
</div><div id="_line0491" class="line">0491         <span class="keyword">try</span>  <span class="comment">% try-catch is faster than checking isa(jcontainer,'java.awt.Container')...</span>
</div><div id="_line0492" class="line">0492             <span class="comment">%if jcontainer.getComponentCount,  jcontainer.getComponents,  end</span>
</div><div id="_line0493" class="line">0493             <span class="keyword">if</span> ~nomenu || menuBarFoundFlag || isempty(strfind(class(jcontainer),<span class="string">'FigureMenuBar'</span>))
</div><div id="_line0494" class="line">0494                 lastChildComponent = java.lang.Object;
</div><div id="_line0495" class="line">0495                 child = 0;
</div><div id="_line0496" class="line">0496                 <span class="keyword">while</span> (child &lt; jcontainer.getComponentCount)
</div><div id="_line0497" class="line">0497                     childComponent = jcontainer.getComponent(child);
</div><div id="_line0498" class="line">0498                     <span class="comment">% Looping over menus sometimes causes jcontainer to get mixed up (probably a JITC bug), so identify &amp; fix</span>
</div><div id="_line0499" class="line">0499                     <span class="keyword">if</span> isequal(childComponent,lastChildComponent)
</div><div id="_line0500" class="line">0500                         child = child + 1;
</div><div id="_line0501" class="line">0501                         childComponent = jcontainer.getComponent(child);
</div><div id="_line0502" class="line">0502                     <span class="keyword">end</span>
</div><div id="_line0503" class="line">0503                     lastChildComponent = childComponent;
</div><div id="_line0504" class="line">0504                     <span class="comment">%disp([repmat(' ',1,level) '=&gt; ' num2str(child) ': ' char(class(childComponent))])</span>
</div><div id="_line0505" class="line">0505                     <a href="#_sub5" class="code" title="subtraverseContainer">traverseContainer</a>(childComponent,level+1,parentId);
</div><div id="_line0506" class="line">0506                     child = child + 1;
</div><div id="_line0507" class="line">0507                 <span class="keyword">end</span>
</div><div id="_line0508" class="line">0508             <span class="keyword">else</span>
</div><div id="_line0509" class="line">0509                 menuBarFoundFlag = true;  <span class="comment">% use this flag to skip further testing for FigureMenuBar</span>
</div><div id="_line0510" class="line">0510             <span class="keyword">end</span>
</div><div id="_line0511" class="line">0511         <span class="keyword">catch</span>
</div><div id="_line0512" class="line">0512             <span class="comment">% do nothing - probably not a container</span>
</div><div id="_line0513" class="line">0513             <span class="comment">%dispError</span>
</div><div id="_line0514" class="line">0514         <span class="keyword">end</span>
</div><div id="_line0515" class="line">0515 
</div><div id="_line0516" class="line">0516         <span class="comment">% ...and yet another type of child traversal...</span>
</div><div id="_line0517" class="line">0517         <span class="keyword">try</span>
</div><div id="_line0518" class="line">0518             <span class="keyword">if</span> ~isdeployed  <span class="comment">% prevent 'File is empty' messages in compiled apps</span>
</div><div id="_line0519" class="line">0519                 jc = jcontainer.java;
</div><div id="_line0520" class="line">0520             <span class="keyword">else</span>
</div><div id="_line0521" class="line">0521                 jc = jcontainer;
</div><div id="_line0522" class="line">0522             <span class="keyword">end</span>
</div><div id="_line0523" class="line">0523             <span class="keyword">for</span> child = 1 : jc.getChildCount
</div><div id="_line0524" class="line">0524                 <a href="#_sub5" class="code" title="subtraverseContainer">traverseContainer</a>(jc.getChildAt(child-1),level+1,parentId);
</div><div id="_line0525" class="line">0525             <span class="keyword">end</span>
</div><div id="_line0526" class="line">0526         <span class="keyword">catch</span>
</div><div id="_line0527" class="line">0527             <span class="comment">% do nothing - probably not a container</span>
</div><div id="_line0528" class="line">0528             <span class="comment">%dispError</span>
</div><div id="_line0529" class="line">0529         <span class="keyword">end</span>
</div><div id="_line0530" class="line">0530 
</div><div id="_line0531" class="line">0531         <span class="comment">% TODO: Add axis (plot) component handles</span>
</div><div id="_line0532" class="line">0532     <span class="keyword">end</span>
</div><div id="_line0533" class="line">0533 
</div><div id="_line0534" class="line">0534     <span class="comment">%% Get the XY location of a Java component</span>
</div><div id="_line0535" class="line">0535     <a name="_sub6" href="#_subfunctions" class="code">function xy = getXY(jcontainer)</a>
</div><div id="_line0536" class="line">0536             <span class="comment">% Note: getX/getY are better than get(..,'X') (mem leaks),</span>
</div><div id="_line0537" class="line">0537             <span class="comment">% ^^^^  but sometimes they fail and revert to getx.m ...</span>
</div><div id="_line0538" class="line">0538             <span class="comment">% Note2: try awtinvoke() catch is faster than checking ismethod()...</span>
</div><div id="_line0539" class="line">0539             <span class="comment">% Note3: using AWTUtilities.invokeAndWait() directly is even faster than awtinvoke()...</span>
</div><div id="_line0540" class="line">0540             <span class="keyword">try</span> <span class="comment">%if ismethod(jcontainer,'getX')</span>
</div><div id="_line0541" class="line">0541                 <span class="comment">%positions(thisIdx,:) = [jcontainer.getX, jcontainer.getY];</span>
</div><div id="_line0542" class="line">0542                 cls = getClass(jcontainer);
</div><div id="_line0543" class="line">0543                 location = com.mathworks.jmi.AWTUtilities.invokeAndWait(jcontainer,getMethod(cls,<span class="string">'getLocation'</span>,[]),[]);
</div><div id="_line0544" class="line">0544                 x = location.getX;
</div><div id="_line0545" class="line">0545                 y = location.getY;
</div><div id="_line0546" class="line">0546             <span class="keyword">catch</span> <span class="comment">%else</span>
</div><div id="_line0547" class="line">0547                 <span class="keyword">try</span>
</div><div id="_line0548" class="line">0548                     x = com.mathworks.jmi.AWTUtilities.invokeAndWait(jcontainer,getMethod(cls,<span class="string">'getX'</span>,[]),[]);
</div><div id="_line0549" class="line">0549                     y = com.mathworks.jmi.AWTUtilities.invokeAndWait(jcontainer,getMethod(cls,<span class="string">'getY'</span>,[]),[]);
</div><div id="_line0550" class="line">0550                 <span class="keyword">catch</span>
</div><div id="_line0551" class="line">0551                     <span class="keyword">try</span>
</div><div id="_line0552" class="line">0552                         x = awtinvoke(jcontainer,<span class="string">'getX()'</span>);
</div><div id="_line0553" class="line">0553                         y = awtinvoke(jcontainer,<span class="string">'getY()'</span>);
</div><div id="_line0554" class="line">0554                     <span class="keyword">catch</span>
</div><div id="_line0555" class="line">0555                         x = get(jcontainer,<span class="string">'X'</span>);
</div><div id="_line0556" class="line">0556                         y = get(jcontainer,<span class="string">'Y'</span>);
</div><div id="_line0557" class="line">0557                     <span class="keyword">end</span>
</div><div id="_line0558" class="line">0558                 <span class="keyword">end</span>
</div><div id="_line0559" class="line">0559             <span class="keyword">end</span>
</div><div id="_line0560" class="line">0560             <span class="comment">%positions(thisIdx,:) = [x, y];</span>
</div><div id="_line0561" class="line">0561             xy = [x,y];
</div><div id="_line0562" class="line">0562     <span class="keyword">end</span>
</div><div id="_line0563" class="line">0563 
</div><div id="_line0564" class="line">0564     <span class="comment">%% Get the number of menu sub-elements</span>
</div><div id="_line0565" class="line">0565     <a name="_sub7" href="#_subfunctions" class="code">function numMenuComponents  = getNumMenuComponents(jcontainer)</a>
</div><div id="_line0566" class="line">0566 
</div><div id="_line0567" class="line">0567         <span class="comment">% The following line will raise an Exception for anything except menus</span>
</div><div id="_line0568" class="line">0568         numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0569" class="line">0569 
</div><div id="_line0570" class="line">0570         <span class="comment">% No error so far, so this must be a menu container...</span>
</div><div id="_line0571" class="line">0571         <span class="comment">% Note: Menu subitems are not visible until the top-level (root) menu gets initial focus...</span>
</div><div id="_line0572" class="line">0572         <span class="comment">% Try several alternatives, until we get a non-empty menu (or not...)</span>
</div><div id="_line0573" class="line">0573         <span class="comment">% TODO: Improve performance - this takes WAY too long...</span>
</div><div id="_line0574" class="line">0574         <span class="keyword">if</span> jcontainer.isTopLevelMenu &amp;&amp; (numMenuComponents==0)
</div><div id="_line0575" class="line">0575             jcontainer.requestFocus;
</div><div id="_line0576" class="line">0576             numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0577" class="line">0577             <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0578" class="line">0578                 drawnow; pause(0.001);
</div><div id="_line0579" class="line">0579                 numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0580" class="line">0580                 <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0581" class="line">0581                     jcontainer.setSelected(true);
</div><div id="_line0582" class="line">0582                     numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0583" class="line">0583                     <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0584" class="line">0584                         drawnow; pause(0.001);
</div><div id="_line0585" class="line">0585                         numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0586" class="line">0586                         <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0587" class="line">0587                             jcontainer.doClick;  <span class="comment">% needed in order to populate the sub-menu components</span>
</div><div id="_line0588" class="line">0588                             numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0589" class="line">0589                             <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0590" class="line">0590                                 drawnow; <span class="comment">%pause(0.001);</span>
</div><div id="_line0591" class="line">0591                                 numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0592" class="line">0592                                 jcontainer.doClick;  <span class="comment">% close menu by re-clicking...</span>
</div><div id="_line0593" class="line">0593                                 <span class="keyword">if</span> (numMenuComponents == 0)
</div><div id="_line0594" class="line">0594                                     drawnow; <span class="comment">%pause(0.001);</span>
</div><div id="_line0595" class="line">0595                                     numMenuComponents = jcontainer.getMenuComponentCount;
</div><div id="_line0596" class="line">0596                                 <span class="keyword">end</span>
</div><div id="_line0597" class="line">0597                             <span class="keyword">else</span>
</div><div id="_line0598" class="line">0598                                 <span class="comment">% ok - found sub-items</span>
</div><div id="_line0599" class="line">0599                                 <span class="comment">% Note: no need to close menu since this will be done when focus moves to the FindJObj window</span>
</div><div id="_line0600" class="line">0600                                 <span class="comment">%jcontainer.doClick;  % close menu by re-clicking...</span>
</div><div id="_line0601" class="line">0601                             <span class="keyword">end</span>
</div><div id="_line0602" class="line">0602                         <span class="keyword">end</span>
</div><div id="_line0603" class="line">0603                     <span class="keyword">end</span>
</div><div id="_line0604" class="line">0604                     jcontainer.setSelected(false);  <span class="comment">% de-select the menu</span>
</div><div id="_line0605" class="line">0605                 <span class="keyword">end</span>
</div><div id="_line0606" class="line">0606             <span class="keyword">end</span>
</div><div id="_line0607" class="line">0607         <span class="keyword">end</span>
</div><div id="_line0608" class="line">0608     <span class="keyword">end</span>
</div><div id="_line0609" class="line">0609 
</div><div id="_line0610" class="line">0610     <span class="comment">%% Remove a specific tree node's data</span>
</div><div id="_line0611" class="line">0611     <a name="_sub8" href="#_subfunctions" class="code">function nodeRemovedFlag = removeDuplicateNode(thisIdx)</a>
</div><div id="_line0612" class="line">0612         nodeRemovedFlag = false;
</div><div id="_line0613" class="line">0613         <span class="keyword">for</span> idx = 1 : thisIdx-1
</div><div id="_line0614" class="line">0614             <span class="keyword">if</span> isequal(handles(idx),handles(thisIdx))
</div><div id="_line0615" class="line">0615                 levels(thisIdx) = [];
</div><div id="_line0616" class="line">0616                 parentIdx(thisIdx) = [];
</div><div id="_line0617" class="line">0617                 handles(thisIdx) = [];
</div><div id="_line0618" class="line">0618                 positions(thisIdx,:) = [];
</div><div id="_line0619" class="line">0619                 <span class="comment">%sizes(thisIdx,:) = [];</span>
</div><div id="_line0620" class="line">0620                 nodeRemovedFlag = true;
</div><div id="_line0621" class="line">0621                 <span class="keyword">return</span>;
</div><div id="_line0622" class="line">0622             <span class="keyword">end</span>
</div><div id="_line0623" class="line">0623         <span class="keyword">end</span>
</div><div id="_line0624" class="line">0624     <span class="keyword">end</span>
</div><div id="_line0625" class="line">0625 
</div><div id="_line0626" class="line">0626     <span class="comment">%% Process optional args</span>
</div><div id="_line0627" class="line">0627     <a name="_sub9" href="#_subfunctions" class="code">function processArgs(varargin)</a>
</div><div id="_line0628" class="line">0628 
</div><div id="_line0629" class="line">0629         <span class="comment">% Initialize</span>
</div><div id="_line0630" class="line">0630         invertFlag = false;
</div><div id="_line0631" class="line">0631         listing = <span class="string">''</span>;
</div><div id="_line0632" class="line">0632 
</div><div id="_line0633" class="line">0633         <span class="comment">% Loop over all optional args</span>
</div><div id="_line0634" class="line">0634         <span class="keyword">while</span> ~isempty(varargin) &amp;&amp; ~isempty(handles)
</div><div id="_line0635" class="line">0635 
</div><div id="_line0636" class="line">0636             <span class="comment">% Process the arg (and all its params)</span>
</div><div id="_line0637" class="line">0637             foundIdx = 1 : length(handles);
</div><div id="_line0638" class="line">0638             <span class="keyword">if</span> iscell(varargin{1}),  varargin{1} = varargin{1}{1};  <span class="keyword">end</span>
</div><div id="_line0639" class="line">0639             <span class="keyword">if</span> ~isempty(varargin{1}) &amp;&amp; varargin{1}(1)==<span class="string">'-'</span>
</div><div id="_line0640" class="line">0640                 varargin{1}(1) = [];
</div><div id="_line0641" class="line">0641             <span class="keyword">end</span>
</div><div id="_line0642" class="line">0642             <span class="keyword">switch</span> lower(varargin{1})
</div><div id="_line0643" class="line">0643                 <span class="keyword">case</span> <span class="string">'not'</span>
</div><div id="_line0644" class="line">0644                     invertFlag = true;
</div><div id="_line0645" class="line">0645                 <span class="keyword">case</span> <span class="string">'position'</span>
</div><div id="_line0646" class="line">0646                     [varargin,foundIdx] = <a href="#_sub11" class="code" title="subprocessPositionArgs">processPositionArgs</a>(varargin{:});
</div><div id="_line0647" class="line">0647                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0648" class="line">0648                 <span class="keyword">case</span> <span class="string">'size'</span>
</div><div id="_line0649" class="line">0649                     [varargin,foundIdx] = <a href="#_sub12" class="code" title="subprocessSizeArgs">processSizeArgs</a>(varargin{:});
</div><div id="_line0650" class="line">0650                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0651" class="line">0651                 <span class="keyword">case</span> <span class="string">'class'</span>
</div><div id="_line0652" class="line">0652                     [varargin,foundIdx] = <a href="#_sub13" class="code" title="subprocessClassArgs">processClassArgs</a>(varargin{:});
</div><div id="_line0653" class="line">0653                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0654" class="line">0654                 <span class="keyword">case</span> <span class="string">'property'</span>
</div><div id="_line0655" class="line">0655                     [varargin,foundIdx] = <a href="#_sub14" class="code" title="subprocessPropertyArgs">processPropertyArgs</a>(varargin{:});
</div><div id="_line0656" class="line">0656                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0657" class="line">0657                 <span class="keyword">case</span> <span class="string">'depth'</span>
</div><div id="_line0658" class="line">0658                     [varargin,foundIdx] = <a href="#_sub15" class="code" title="subprocessDepthArgs">processDepthArgs</a>(varargin{:});
</div><div id="_line0659" class="line">0659                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0660" class="line">0660                 <span class="keyword">case</span> <span class="string">'flat'</span>
</div><div id="_line0661" class="line">0661                     varargin = {<span class="string">'depth'</span>,0, varargin{min(2:end):end}};
</div><div id="_line0662" class="line">0662                     [varargin,foundIdx] = <a href="#_sub15" class="code" title="subprocessDepthArgs">processDepthArgs</a>(varargin{:});
</div><div id="_line0663" class="line">0663                     <span class="keyword">if</span> invertFlag,  foundIdx = ~foundIdx;  invertFlag = false;  <span class="keyword">end</span>
</div><div id="_line0664" class="line">0664                 <span class="keyword">case</span> {<span class="string">'print'</span>,<span class="string">'list'</span>}
</div><div id="_line0665" class="line">0665                     [varargin,listing] = <a href="#_sub10" class="code" title="subprocessPrintArgs">processPrintArgs</a>(varargin{:});
</div><div id="_line0666" class="line">0666                 <span class="keyword">case</span> {<span class="string">'persist'</span>,<span class="string">'nomenu'</span>,<span class="string">'debug'</span>}
</div><div id="_line0667" class="line">0667                     <span class="comment">% ignore - already handled in main function above</span>
</div><div id="_line0668" class="line">0668                 <span class="keyword">otherwise</span>
</div><div id="_line0669" class="line">0669                     error(<span class="string">'YMA:findjobj:IllegalOption'</span>,[<span class="string">'Option '</span> num2str(varargin{1}) <span class="string">' is not a valid option. Type ''help '</span> mfilename <span class="string">''' for the full options list.'</span>]);
</div><div id="_line0670" class="line">0670             <span class="keyword">end</span>
</div><div id="_line0671" class="line">0671 
</div><div id="_line0672" class="line">0672             <span class="comment">% If only parent-child pairs found</span>
</div><div id="_line0673" class="line">0673             foundIdx = find(foundIdx);
</div><div id="_line0674" class="line">0674             <span class="keyword">if</span> ~isempty(foundIdx) &amp;&amp; isequal(parentIdx(foundIdx(2:2:end)),foundIdx(1:2:end))
</div><div id="_line0675" class="line">0675                 <span class="comment">% Return just the children (the parent panels are uninteresting)</span>
</div><div id="_line0676" class="line">0676                 foundIdx(1:2:end) = [];
</div><div id="_line0677" class="line">0677             <span class="keyword">end</span>
</div><div id="_line0678" class="line">0678             
</div><div id="_line0679" class="line">0679             <span class="comment">% If several possible handles were found and the first is the container of the second</span>
</div><div id="_line0680" class="line">0680             <span class="keyword">if</span> length(foundIdx) == 2 &amp;&amp; isequal(handles(foundIdx(1)).java, handles(foundIdx(2)).getParent)
</div><div id="_line0681" class="line">0681                 <span class="comment">% Discard the uninteresting component container</span>
</div><div id="_line0682" class="line">0682                 foundIdx(1) = [];
</div><div id="_line0683" class="line">0683             <span class="keyword">end</span>
</div><div id="_line0684" class="line">0684 
</div><div id="_line0685" class="line">0685             <span class="comment">% Filter the results</span>
</div><div id="_line0686" class="line">0686             selectedIdx = selectedIdx(foundIdx);
</div><div id="_line0687" class="line">0687             handles   = handles(foundIdx);
</div><div id="_line0688" class="line">0688             levels    = levels(foundIdx);
</div><div id="_line0689" class="line">0689             parentIdx = parentIdx(foundIdx);
</div><div id="_line0690" class="line">0690             positions = positions(foundIdx,:);
</div><div id="_line0691" class="line">0691 
</div><div id="_line0692" class="line">0692             <span class="comment">% Remove this arg and proceed to the next one</span>
</div><div id="_line0693" class="line">0693             varargin(1) = [];
</div><div id="_line0694" class="line">0694 
</div><div id="_line0695" class="line">0695         <span class="keyword">end</span>  <span class="comment">% Loop over all args</span>
</div><div id="_line0696" class="line">0696     <span class="keyword">end</span>
</div><div id="_line0697" class="line">0697 
</div><div id="_line0698" class="line">0698     <span class="comment">%% Process 'print' option</span>
</div><div id="_line0699" class="line">0699     <a name="_sub10" href="#_subfunctions" class="code">function [varargin,listing] = processPrintArgs(varargin)</a>
</div><div id="_line0700" class="line">0700         <span class="keyword">if</span> length(varargin)&lt;2 || <a href="#_sub52" class="code" title="subischar">ischar</a>(varargin{2})
</div><div id="_line0701" class="line">0701             <span class="comment">% No second arg given, so use the first available element</span>
</div><div id="_line0702" class="line">0702             listingContainer = handles(1);  <span class="comment">%#ok - used in evalc below</span>
</div><div id="_line0703" class="line">0703         <span class="keyword">else</span>
</div><div id="_line0704" class="line">0704             <span class="comment">% Get the element to print from the specified second arg</span>
</div><div id="_line0705" class="line">0705             <span class="keyword">if</span> isnumeric(varargin{2}) &amp;&amp; (varargin{2} == fix(varargin{2}))  <span class="comment">% isinteger doesn't work on doubles...</span>
</div><div id="_line0706" class="line">0706                 <span class="keyword">if</span> (varargin{2} &gt; 0) &amp;&amp; (varargin{2} &lt;= length(handles))
</div><div id="_line0707" class="line">0707                     listingContainer = handles(varargin{2});  <span class="comment">%#ok - used in evalc below</span>
</div><div id="_line0708" class="line">0708                 <span class="keyword">elseif</span> varargin{2} &gt; 0
</div><div id="_line0709" class="line">0709                     error(<span class="string">'YMA:findjobj:IllegalPrintFilter'</span>,<span class="string">'Print filter index %g &gt; number of available elements (%d)'</span>,varargin{2},length(handles));
</div><div id="_line0710" class="line">0710                 <span class="keyword">else</span>
</div><div id="_line0711" class="line">0711                     error(<span class="string">'YMA:findjobj:IllegalPrintFilter'</span>,<span class="string">'Print filter must be a java handle or positive numeric index into handles'</span>);
</div><div id="_line0712" class="line">0712                 <span class="keyword">end</span>
</div><div id="_line0713" class="line">0713             <span class="keyword">elseif</span> ismethod(varargin{2},<span class="string">'list'</span>)
</div><div id="_line0714" class="line">0714                 listingContainer = varargin{2};  <span class="comment">%#ok - used in evalc below</span>
</div><div id="_line0715" class="line">0715             <span class="keyword">else</span>
</div><div id="_line0716" class="line">0716                 error(<span class="string">'YMA:findjobj:IllegalPrintFilter'</span>,<span class="string">'Print filter must be a java handle or numeric index into handles'</span>);
</div><div id="_line0717" class="line">0717             <span class="keyword">end</span>
</div><div id="_line0718" class="line">0718             varargin(2) = [];
</div><div id="_line0719" class="line">0719         <span class="keyword">end</span>
</div><div id="_line0720" class="line">0720 
</div><div id="_line0721" class="line">0721         <span class="comment">% use evalc() to capture output into a Matlab variable</span>
</div><div id="_line0722" class="line">0722         <span class="comment">%listing = evalc('listingContainer.list');</span>
</div><div id="_line0723" class="line">0723 
</div><div id="_line0724" class="line">0724         <span class="comment">% Better solution: loop over all handles and process them one by one</span>
</div><div id="_line0725" class="line">0725         listing = cell(length(handles),1);
</div><div id="_line0726" class="line">0726         <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0727" class="line">0727             listing{componentIdx} = [repmat(<span class="string">' '</span>,1,levels(componentIdx)) char(handles(componentIdx).toString)];
</div><div id="_line0728" class="line">0728         <span class="keyword">end</span>
</div><div id="_line0729" class="line">0729     <span class="keyword">end</span>
</div><div id="_line0730" class="line">0730 
</div><div id="_line0731" class="line">0731     <span class="comment">%% Process 'position' option</span>
</div><div id="_line0732" class="line">0732     <a name="_sub11" href="#_subfunctions" class="code">function [varargin,foundIdx] = processPositionArgs(varargin)</a>
</div><div id="_line0733" class="line">0733         <span class="keyword">if</span> length(varargin)&gt;1
</div><div id="_line0734" class="line">0734             positionFilter = varargin{2};
</div><div id="_line0735" class="line">0735             <span class="comment">%if (isjava(positionFilter) || iscom(positionFilter)) &amp;&amp; ismethod(positionFilter,'getLocation')</span>
</div><div id="_line0736" class="line">0736             <span class="keyword">try</span>  <span class="comment">% try-catch is faster...</span>
</div><div id="_line0737" class="line">0737                 <span class="comment">% Java/COM object passed - get its position</span>
</div><div id="_line0738" class="line">0738                 positionFilter = positionFilter.getLocation;
</div><div id="_line0739" class="line">0739                 filterXY = [positionFilter.getX, positionFilter.getY];
</div><div id="_line0740" class="line">0740             <span class="keyword">catch</span>
</div><div id="_line0741" class="line">0741                 <span class="keyword">if</span> ~isscalar(positionFilter)
</div><div id="_line0742" class="line">0742                     <span class="comment">% position vector passed</span>
</div><div id="_line0743" class="line">0743                     <span class="keyword">if</span> (length(positionFilter)&gt;=2) &amp;&amp; isnumeric(positionFilter)
</div><div id="_line0744" class="line">0744                         <span class="comment">% Remember that java coordinates start at top-left corner, Matlab coords start at bottom left...</span>
</div><div id="_line0745" class="line">0745                         <span class="comment">%positionFilter = java.awt.Point(positionFilter(1), container.getHeight - positionFilter(2));</span>
</div><div id="_line0746" class="line">0746                         filterXY = [container.getX + positionFilter(1), container.getY + contentSize(2) - positionFilter(2)];
</div><div id="_line0747" class="line">0747 
</div><div id="_line0748" class="line">0748                         <span class="comment">% Check for full Matlab position vector (x,y,w,h)</span>
</div><div id="_line0749" class="line">0749                         <span class="comment">%if (length(positionFilter)==4)</span>
</div><div id="_line0750" class="line">0750                         <span class="comment">%    varargin{end+1} = 'size';</span>
</div><div id="_line0751" class="line">0751                         <span class="comment">%    varargin{end+1} = fix(positionFilter(3:4));</span>
</div><div id="_line0752" class="line">0752                         <span class="comment">%end</span>
</div><div id="_line0753" class="line">0753                     <span class="keyword">else</span>
</div><div id="_line0754" class="line">0754                         error(<span class="string">'YMA:findjobj:IllegalPositionFilter'</span>,<span class="string">'Position filter must be a java UI component, or X,Y pair'</span>);
</div><div id="_line0755" class="line">0755                     <span class="keyword">end</span>
</div><div id="_line0756" class="line">0756                 <span class="keyword">elseif</span> length(varargin)&gt;2
</div><div id="_line0757" class="line">0757                     <span class="comment">% x,y passed as separate arg values</span>
</div><div id="_line0758" class="line">0758                     <span class="keyword">if</span> isnumeric(positionFilter) &amp;&amp; isnumeric(varargin{3})
</div><div id="_line0759" class="line">0759                         <span class="comment">% Remember that java coordinates start at top-left corner, Matlab coords start at bottom left...</span>
</div><div id="_line0760" class="line">0760                         <span class="comment">%positionFilter = java.awt.Point(positionFilter, container.getHeight - varargin{3});</span>
</div><div id="_line0761" class="line">0761                         filterXY = [container.getX + positionFilter, container.getY + contentSize(2) - varargin{3}];
</div><div id="_line0762" class="line">0762                         varargin(3) = [];
</div><div id="_line0763" class="line">0763                     <span class="keyword">else</span>
</div><div id="_line0764" class="line">0764                         error(<span class="string">'YMA:findjobj:IllegalPositionFilter'</span>,<span class="string">'Position filter must be a java UI component, or X,Y pair'</span>);
</div><div id="_line0765" class="line">0765                     <span class="keyword">end</span>
</div><div id="_line0766" class="line">0766                 <span class="keyword">else</span>
</div><div id="_line0767" class="line">0767                     error(<span class="string">'YMA:findjobj:IllegalPositionFilter'</span>,<span class="string">'Position filter must be a java UI component, or X,Y pair'</span>);
</div><div id="_line0768" class="line">0768                 <span class="keyword">end</span>
</div><div id="_line0769" class="line">0769             <span class="keyword">end</span>
</div><div id="_line0770" class="line">0770 
</div><div id="_line0771" class="line">0771             <span class="comment">% Compute the required element positions in order to be eligible for a more detailed examination</span>
</div><div id="_line0772" class="line">0772             <span class="comment">% Note: based on the following constraints: 0 &lt;= abs(elementX-filterX) + abs(elementY+elementH-filterY) &lt; 7</span>
</div><div id="_line0773" class="line">0773             baseDeltas = [positions(:,1)-filterXY(1), positions(:,2)-filterXY(2)];  <span class="comment">% faster than repmat()...</span>
</div><div id="_line0774" class="line">0774             <span class="comment">%baseHeight = - baseDeltas(:,2);% -abs(baseDeltas(:,1));</span>
</div><div id="_line0775" class="line">0775             <span class="comment">%minHeight = baseHeight - 7;</span>
</div><div id="_line0776" class="line">0776             <span class="comment">%maxHeight = baseHeight + 7;</span>
</div><div id="_line0777" class="line">0777             <span class="comment">%foundIdx = ~arrayfun(@(b)(invoke(b,'contains',positionFilter)),handles);  % ARGH! - disallowed by Matlab!</span>
</div><div id="_line0778" class="line">0778             <span class="comment">%foundIdx = repmat(false,1,length(handles));</span>
</div><div id="_line0779" class="line">0779             <span class="comment">%foundIdx(length(handles)) = false;  % faster than repmat()...</span>
</div><div id="_line0780" class="line">0780             foundIdx = (abs(baseDeltas(:,1)) &lt; 7) &amp; (abs(baseDeltas(:,2)) &lt; 7); <span class="comment">% &amp; (minHeight &gt;= 0);</span>
</div><div id="_line0781" class="line">0781             <span class="comment">%fi = find(foundIdx);</span>
</div><div id="_line0782" class="line">0782             <span class="comment">%for componentIdx = 1 : length(fi)</span>
</div><div id="_line0783" class="line">0783                 <span class="comment">%foundIdx(componentIdx) = handles(componentIdx).getBounds.contains(positionFilter);</span>
</div><div id="_line0784" class="line">0784 
</div><div id="_line0785" class="line">0785                 <span class="comment">% Search for a point no farther than 7 pixels away (prevents rounding errors)</span>
</div><div id="_line0786" class="line">0786                 <span class="comment">%foundIdx(componentIdx) = handles(componentIdx).getLocationOnScreen.distanceSq(positionFilter) &lt; 50;  % fails for invisible components...</span>
</div><div id="_line0787" class="line">0787 
</div><div id="_line0788" class="line">0788                 <span class="comment">%p = java.awt.Point(positions(componentIdx,1), positions(componentIdx,2) + handles(componentIdx).getHeight);</span>
</div><div id="_line0789" class="line">0789                 <span class="comment">%foundIdx(componentIdx) = p.distanceSq(positionFilter) &lt; 50;</span>
</div><div id="_line0790" class="line">0790 
</div><div id="_line0791" class="line">0791                 <span class="comment">%foundIdx(componentIdx) = sum(([baseDeltas(componentIdx,1),baseDeltas(componentIdx,2)+handles(componentIdx).getHeight]).^2) &lt; 50;</span>
</div><div id="_line0792" class="line">0792 
</div><div id="_line0793" class="line">0793                 <span class="comment">% Following is the fastest method found to date: only eligible elements are checked in detailed</span>
</div><div id="_line0794" class="line">0794             <span class="comment">%    elementHeight = handles(fi(componentIdx)).getHeight;</span>
</div><div id="_line0795" class="line">0795             <span class="comment">%    foundIdx(fi(componentIdx)) = elementHeight &gt; minHeight(fi(componentIdx)) &amp;&amp; ...</span>
</div><div id="_line0796" class="line">0796             <span class="comment">%                                 elementHeight &lt; maxHeight(fi(componentIdx));</span>
</div><div id="_line0797" class="line">0797                 <span class="comment">%disp([componentIdx,elementHeight,minHeight(fi(componentIdx)),maxHeight(fi(componentIdx)),foundIdx(fi(componentIdx))])</span>
</div><div id="_line0798" class="line">0798             <span class="comment">%end</span>
</div><div id="_line0799" class="line">0799 
</div><div id="_line0800" class="line">0800             varargin(2) = [];
</div><div id="_line0801" class="line">0801         <span class="keyword">else</span>
</div><div id="_line0802" class="line">0802             foundIdx = [];
</div><div id="_line0803" class="line">0803         <span class="keyword">end</span>
</div><div id="_line0804" class="line">0804     <span class="keyword">end</span>
</div><div id="_line0805" class="line">0805 
</div><div id="_line0806" class="line">0806     <span class="comment">%% Process 'size' option</span>
</div><div id="_line0807" class="line">0807     <a name="_sub12" href="#_subfunctions" class="code">function [varargin,foundIdx] = processSizeArgs(varargin)</a>
</div><div id="_line0808" class="line">0808         <span class="keyword">if</span> length(varargin)&gt;1
</div><div id="_line0809" class="line">0809             sizeFilter = lower(varargin{2});
</div><div id="_line0810" class="line">0810             <span class="comment">%if (isjava(sizeFilter) || iscom(sizeFilter)) &amp;&amp; ismethod(sizeFilter,'getSize')</span>
</div><div id="_line0811" class="line">0811             <span class="keyword">try</span>  <span class="comment">% try-catch is faster...</span>
</div><div id="_line0812" class="line">0812                 <span class="comment">% Java/COM object passed - get its size</span>
</div><div id="_line0813" class="line">0813                 sizeFilter = sizeFilter.getSize;
</div><div id="_line0814" class="line">0814                 filterWidth  = sizeFilter.getWidth;
</div><div id="_line0815" class="line">0815                 filterHeight = sizeFilter.getHeight;
</div><div id="_line0816" class="line">0816             <span class="keyword">catch</span>
</div><div id="_line0817" class="line">0817                 <span class="keyword">if</span> ~isscalar(sizeFilter)
</div><div id="_line0818" class="line">0818                     <span class="comment">% size vector passed</span>
</div><div id="_line0819" class="line">0819                     <span class="keyword">if</span> (length(sizeFilter)&gt;=2) &amp;&amp; isnumeric(sizeFilter)
</div><div id="_line0820" class="line">0820                         <span class="comment">%sizeFilter = java.awt.Dimension(sizeFilter(1),sizeFilter(2));</span>
</div><div id="_line0821" class="line">0821                         filterWidth  = sizeFilter(1);
</div><div id="_line0822" class="line">0822                         filterHeight = sizeFilter(2);
</div><div id="_line0823" class="line">0823                     <span class="keyword">else</span>
</div><div id="_line0824" class="line">0824                         error(<span class="string">'YMA:findjobj:IllegalSizeFilter'</span>,<span class="string">'Size filter must be a java UI component, or W,H pair'</span>);
</div><div id="_line0825" class="line">0825                     <span class="keyword">end</span>
</div><div id="_line0826" class="line">0826                 <span class="keyword">elseif</span> length(varargin)&gt;2
</div><div id="_line0827" class="line">0827                     <span class="comment">% w,h passed as separate arg values</span>
</div><div id="_line0828" class="line">0828                     <span class="keyword">if</span> isnumeric(sizeFilter) &amp;&amp; isnumeric(varargin{3})
</div><div id="_line0829" class="line">0829                         <span class="comment">%sizeFilter = java.awt.Dimension(sizeFilter,varargin{3});</span>
</div><div id="_line0830" class="line">0830                         filterWidth  = sizeFilter;
</div><div id="_line0831" class="line">0831                         filterHeight = varargin{3};
</div><div id="_line0832" class="line">0832                         varargin(3) = [];
</div><div id="_line0833" class="line">0833                     <span class="keyword">else</span>
</div><div id="_line0834" class="line">0834                         error(<span class="string">'YMA:findjobj:IllegalSizeFilter'</span>,<span class="string">'Size filter must be a java UI component, or W,H pair'</span>);
</div><div id="_line0835" class="line">0835                     <span class="keyword">end</span>
</div><div id="_line0836" class="line">0836                 <span class="keyword">else</span>
</div><div id="_line0837" class="line">0837                     error(<span class="string">'YMA:findjobj:IllegalSizeFilter'</span>,<span class="string">'Size filter must be a java UI component, or W,H pair'</span>);
</div><div id="_line0838" class="line">0838                 <span class="keyword">end</span>
</div><div id="_line0839" class="line">0839             <span class="keyword">end</span>
</div><div id="_line0840" class="line">0840             <span class="comment">%foundIdx = ~arrayfun(@(b)(invoke(b,'contains',sizeFilter)),handles);  % ARGH! - disallowed by Matlab!</span>
</div><div id="_line0841" class="line">0841             foundIdx(length(handles)) = false;  <span class="comment">% faster than repmat()...</span>
</div><div id="_line0842" class="line">0842             <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0843" class="line">0843                 <span class="comment">%foundIdx(componentIdx) = handles(componentIdx).getSize.equals(sizeFilter);</span>
</div><div id="_line0844" class="line">0844                 <span class="comment">% Allow a 2-pixel tollerance to account for non-integer pixel sizes</span>
</div><div id="_line0845" class="line">0845                 foundIdx(componentIdx) = abs(handles(componentIdx).getWidth  - filterWidth)  &lt;= 3 &amp;&amp; <span class="keyword">...</span><span class="comment">  % faster than getSize.equals()</span>
</div><div id="_line0846" class="line">0846                                          abs(handles(componentIdx).getHeight - filterHeight) &lt;= 3;
</div><div id="_line0847" class="line">0847             <span class="keyword">end</span>
</div><div id="_line0848" class="line">0848             varargin(2) = [];
</div><div id="_line0849" class="line">0849         <span class="keyword">else</span>
</div><div id="_line0850" class="line">0850             foundIdx = [];
</div><div id="_line0851" class="line">0851         <span class="keyword">end</span>
</div><div id="_line0852" class="line">0852     <span class="keyword">end</span>
</div><div id="_line0853" class="line">0853 
</div><div id="_line0854" class="line">0854     <span class="comment">%% Process 'class' option</span>
</div><div id="_line0855" class="line">0855     <a name="_sub13" href="#_subfunctions" class="code">function [varargin,foundIdx] = processClassArgs(varargin)</a>
</div><div id="_line0856" class="line">0856         <span class="keyword">if</span> length(varargin)&gt;1
</div><div id="_line0857" class="line">0857             classFilter = varargin{2};
</div><div id="_line0858" class="line">0858             <span class="comment">%if ismethod(classFilter,'getClass')</span>
</div><div id="_line0859" class="line">0859             <span class="keyword">try</span>  <span class="comment">% try-catch is faster...</span>
</div><div id="_line0860" class="line">0860                 classFilter = char(classFilter.getClass);
</div><div id="_line0861" class="line">0861             <span class="keyword">catch</span>
</div><div id="_line0862" class="line">0862                 <span class="keyword">if</span> ~<a href="#_sub52" class="code" title="subischar">ischar</a>(classFilter)
</div><div id="_line0863" class="line">0863                     error(<span class="string">'YMA:findjobj:IllegalClassFilter'</span>,<span class="string">'Class filter must be a java object, class or string'</span>);
</div><div id="_line0864" class="line">0864                 <span class="keyword">end</span>
</div><div id="_line0865" class="line">0865             <span class="keyword">end</span>
</div><div id="_line0866" class="line">0866 
</div><div id="_line0867" class="line">0867             <span class="comment">% Now convert all java classes to java.lang.Strings and compare to the requested filter string</span>
</div><div id="_line0868" class="line">0868             <span class="keyword">try</span>
</div><div id="_line0869" class="line">0869                 foundIdx(length(handles)) = false;  <span class="comment">% faster than repmat()...</span>
</div><div id="_line0870" class="line">0870                 jClassFilter = java.lang.String(classFilter).toLowerCase;
</div><div id="_line0871" class="line">0871                 <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0872" class="line">0872                     <span class="comment">% Note: JVM 1.5's String.contains() appears slightly slower and is available only since Matlab 7.2</span>
</div><div id="_line0873" class="line">0873                     foundIdx(componentIdx) = handles(componentIdx).getClass.toString.toLowerCase.indexOf(jClassFilter) &gt;= 0;
</div><div id="_line0874" class="line">0874                 <span class="keyword">end</span>
</div><div id="_line0875" class="line">0875             <span class="keyword">catch</span>
</div><div id="_line0876" class="line">0876                 <span class="comment">% Simple processing: slower since it does extra processing within opaque.char()</span>
</div><div id="_line0877" class="line">0877                 <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0878" class="line">0878                     <span class="comment">% Note: using @toChar is faster but returns java String, not a Matlab char</span>
</div><div id="_line0879" class="line">0879                     foundIdx(componentIdx) = ~isempty(regexpi(char(handles(componentIdx).getClass),classFilter));
</div><div id="_line0880" class="line">0880                 <span class="keyword">end</span>
</div><div id="_line0881" class="line">0881             <span class="keyword">end</span>
</div><div id="_line0882" class="line">0882 
</div><div id="_line0883" class="line">0883             varargin(2) = [];
</div><div id="_line0884" class="line">0884         <span class="keyword">else</span>
</div><div id="_line0885" class="line">0885             foundIdx = [];
</div><div id="_line0886" class="line">0886         <span class="keyword">end</span>
</div><div id="_line0887" class="line">0887     <span class="keyword">end</span>
</div><div id="_line0888" class="line">0888 
</div><div id="_line0889" class="line">0889     <span class="comment">%% Process 'property' option</span>
</div><div id="_line0890" class="line">0890     <a name="_sub14" href="#_subfunctions" class="code">function [varargin,foundIdx] = processPropertyArgs(varargin)</a>
</div><div id="_line0891" class="line">0891         <span class="keyword">if</span> length(varargin)&gt;1
</div><div id="_line0892" class="line">0892             propertyName = varargin{2};
</div><div id="_line0893" class="line">0893             <span class="keyword">if</span> iscell(propertyName)
</div><div id="_line0894" class="line">0894                 <span class="keyword">if</span> length(propertyName) == 2
</div><div id="_line0895" class="line">0895                     propertyVal  = propertyName{2};
</div><div id="_line0896" class="line">0896                     propertyName = propertyName{1};
</div><div id="_line0897" class="line">0897                 <span class="keyword">elseif</span> length(propertyName) == 1
</div><div id="_line0898" class="line">0898                     propertyName = propertyName{1};
</div><div id="_line0899" class="line">0899                 <span class="keyword">else</span>
</div><div id="_line0900" class="line">0900                     error(<span class="string">'YMA:findjobj:IllegalPropertyFilter'</span>,<span class="string">'Property filter must be a string (case insensitive name of property) or cell array {propName,propValue}'</span>);
</div><div id="_line0901" class="line">0901                 <span class="keyword">end</span>
</div><div id="_line0902" class="line">0902             <span class="keyword">end</span>
</div><div id="_line0903" class="line">0903             <span class="keyword">if</span> ~<a href="#_sub52" class="code" title="subischar">ischar</a>(propertyName)
</div><div id="_line0904" class="line">0904                 error(<span class="string">'YMA:findjobj:IllegalPropertyFilter'</span>,<span class="string">'Property filter must be a string (case insensitive name of property) or cell array {propName,propValue}'</span>);
</div><div id="_line0905" class="line">0905             <span class="keyword">end</span>
</div><div id="_line0906" class="line">0906             propertyName = lower(propertyName);
</div><div id="_line0907" class="line">0907             <span class="comment">%foundIdx = arrayfun(@(h)isprop(h,propertyName),handles);  % ARGH! - disallowed by Matlab!</span>
</div><div id="_line0908" class="line">0908             foundIdx(length(handles)) = false;  <span class="comment">% faster than repmat()...</span>
</div><div id="_line0909" class="line">0909 
</div><div id="_line0910" class="line">0910             <span class="comment">% Split processing depending on whether a specific property value was requested (ugly but faster...)</span>
</div><div id="_line0911" class="line">0911             <span class="keyword">if</span> exist(<span class="string">'propertyVal'</span>,<span class="string">'var'</span>)
</div><div id="_line0912" class="line">0912                 <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0913" class="line">0913                     <span class="keyword">try</span>
</div><div id="_line0914" class="line">0914                         <span class="comment">% Find out whether this element has the specified property</span>
</div><div id="_line0915" class="line">0915                         <span class="comment">% Note: findprop() and its return value schema.prop are undocumented and unsupported!</span>
</div><div id="_line0916" class="line">0916                         prop = findprop(handles(componentIdx),propertyName);  <span class="comment">% faster than isprop() &amp; enables partial property names</span>
</div><div id="_line0917" class="line">0917 
</div><div id="_line0918" class="line">0918                         <span class="comment">% If found, compare it to the actual element's property value</span>
</div><div id="_line0919" class="line">0919                         foundIdx(componentIdx) = ~isempty(prop) &amp;&amp; isequal(get(handles(componentIdx),prop.Name),propertyVal);
</div><div id="_line0920" class="line">0920                     <span class="keyword">catch</span>
</div><div id="_line0921" class="line">0921                         <span class="comment">% Some Java classes have a write-only property (like LabelPeer with 'Text'), so we end up here</span>
</div><div id="_line0922" class="line">0922                         <span class="comment">% In these cases, simply assume that the property value doesn't match and continue</span>
</div><div id="_line0923" class="line">0923                         foundIdx(componentIdx) = false;
</div><div id="_line0924" class="line">0924                     <span class="keyword">end</span>
</div><div id="_line0925" class="line">0925                 <span class="keyword">end</span>
</div><div id="_line0926" class="line">0926             <span class="keyword">else</span>
</div><div id="_line0927" class="line">0927                 <span class="keyword">for</span> componentIdx = 1 : length(handles)
</div><div id="_line0928" class="line">0928                     <span class="keyword">try</span>
</div><div id="_line0929" class="line">0929                         <span class="comment">% Find out whether this element has the specified property</span>
</div><div id="_line0930" class="line">0930                         <span class="comment">% Note: findprop() and its return value schema.prop are undocumented and unsupported!</span>
</div><div id="_line0931" class="line">0931                         foundIdx(componentIdx) = ~isempty(findprop(handles(componentIdx),propertyName));
</div><div id="_line0932" class="line">0932                     <span class="keyword">catch</span>
</div><div id="_line0933" class="line">0933                         foundIdx(componentIdx) = false;
</div><div id="_line0934" class="line">0934                     <span class="keyword">end</span>
</div><div id="_line0935" class="line">0935                 <span class="keyword">end</span>
</div><div id="_line0936" class="line">0936             <span class="keyword">end</span>
</div><div id="_line0937" class="line">0937             varargin(2) = [];
</div><div id="_line0938" class="line">0938         <span class="keyword">else</span>
</div><div id="_line0939" class="line">0939             foundIdx = [];
</div><div id="_line0940" class="line">0940         <span class="keyword">end</span>
</div><div id="_line0941" class="line">0941     <span class="keyword">end</span>
</div><div id="_line0942" class="line">0942 
</div><div id="_line0943" class="line">0943     <span class="comment">%% Process 'depth' option</span>
</div><div id="_line0944" class="line">0944     <a name="_sub15" href="#_subfunctions" class="code">function [varargin,foundIdx] = processDepthArgs(varargin)</a>
</div><div id="_line0945" class="line">0945         <span class="keyword">if</span> length(varargin)&gt;1
</div><div id="_line0946" class="line">0946             level = varargin{2};
</div><div id="_line0947" class="line">0947             <span class="keyword">if</span> ~isnumeric(level)
</div><div id="_line0948" class="line">0948                 error(<span class="string">'YMA:findjobj:IllegalDepthFilter'</span>,<span class="string">'Depth filter must be a number (=maximal element depth)'</span>);
</div><div id="_line0949" class="line">0949             <span class="keyword">end</span>
</div><div id="_line0950" class="line">0950             foundIdx = (levels &lt;= level);
</div><div id="_line0951" class="line">0951             varargin(2) = [];
</div><div id="_line0952" class="line">0952         <span class="keyword">else</span>
</div><div id="_line0953" class="line">0953             foundIdx = [];
</div><div id="_line0954" class="line">0954         <span class="keyword">end</span>
</div><div id="_line0955" class="line">0955     <span class="keyword">end</span>
</div><div id="_line0956" class="line">0956 
</div><div id="_line0957" class="line">0957     <span class="comment">%% Convert property data into a string</span>
</div><div id="_line0958" class="line">0958     <a name="_sub16" href="#_subfunctions" class="code">function data = charizeData(data)</a>
</div><div id="_line0959" class="line">0959         <span class="keyword">if</span> isa(data,<span class="string">'com.mathworks.hg.types.HGCallback'</span>)
</div><div id="_line0960" class="line">0960             data = get(data,<span class="string">'Callback'</span>);
</div><div id="_line0961" class="line">0961         <span class="keyword">end</span>
</div><div id="_line0962" class="line">0962         <span class="keyword">if</span> ~<a href="#_sub52" class="code" title="subischar">ischar</a>(data) &amp;&amp; ~isa(data,<span class="string">'java.lang.String'</span>)
</div><div id="_line0963" class="line">0963             newData = strtrim(evalc(<span class="string">'disp(data)'</span>));
</div><div id="_line0964" class="line">0964             <span class="keyword">try</span>
</div><div id="_line0965" class="line">0965                 newData = regexprep(newData,<span class="string">'  +'</span>,<span class="string">' '</span>);
</div><div id="_line0966" class="line">0966                 newData = regexprep(newData,<span class="string">'Columns \d+ through \d+\s'</span>,<span class="string">''</span>);
</div><div id="_line0967" class="line">0967                 newData = regexprep(newData,<span class="string">'Column \d+\s'</span>,<span class="string">''</span>);
</div><div id="_line0968" class="line">0968             <span class="keyword">catch</span>
</div><div id="_line0969" class="line">0969                 <span class="comment">%never mind...</span>
</div><div id="_line0970" class="line">0970             <span class="keyword">end</span>
</div><div id="_line0971" class="line">0971             <span class="keyword">if</span> iscell(data)
</div><div id="_line0972" class="line">0972                 newData = [<span class="string">'{ '</span> newData <span class="string">' }'</span>];
</div><div id="_line0973" class="line">0973             <span class="keyword">elseif</span> isempty(data)
</div><div id="_line0974" class="line">0974                 newData = <span class="string">''</span>;
</div><div id="_line0975" class="line">0975             <span class="keyword">elseif</span> isnumeric(data) || islogical(data) || any(ishandle(data)) || numel(data) &gt; 1 <span class="comment">%&amp;&amp; ~isscalar(data)</span>
</div><div id="_line0976" class="line">0976                 newData = [<span class="string">'['</span> newData <span class="string">']'</span>];
</div><div id="_line0977" class="line">0977             <span class="keyword">end</span>
</div><div id="_line0978" class="line">0978             data = newData;
</div><div id="_line0979" class="line">0979         <span class="keyword">elseif</span> ~isempty(data)
</div><div id="_line0980" class="line">0980             data = [<span class="string">''''</span> data <span class="string">''''</span>];
</div><div id="_line0981" class="line">0981         <span class="keyword">end</span>
</div><div id="_line0982" class="line">0982     <span class="keyword">end</span>  <span class="comment">% charizeData</span>
</div><div id="_line0983" class="line">0983 
</div><div id="_line0984" class="line">0984     <span class="comment">%% Prepare a hierarchical callbacks table data</span>
</div><div id="_line0985" class="line">0985     <a name="_sub17" href="#_subfunctions" class="code">function setProp(list,name,value,category)</a>
</div><div id="_line0986" class="line">0986         prop = eval(<span class="string">'com.jidesoft.grid.DefaultProperty();'</span>);  <span class="comment">% prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line0987" class="line">0987         prop.setName(name);
</div><div id="_line0988" class="line">0988         prop.setType(java.lang.String(<span class="string">''</span>).getClass);
</div><div id="_line0989" class="line">0989         prop.setValue(value);
</div><div id="_line0990" class="line">0990         prop.setEditable(true);
</div><div id="_line0991" class="line">0991         prop.setExpert(true);
</div><div id="_line0992" class="line">0992         <span class="comment">%prop.setCategory(['&lt;html&gt;&lt;b&gt;&lt;u&gt;&lt;font color=&quot;blue&quot;&gt;' category ' callbacks']);</span>
</div><div id="_line0993" class="line">0993         prop.setCategory([category <span class="string">' callbacks'</span>]);
</div><div id="_line0994" class="line">0994         list.add(prop);
</div><div id="_line0995" class="line">0995     <span class="keyword">end</span>  <span class="comment">% getTreeData</span>
</div><div id="_line0996" class="line">0996 
</div><div id="_line0997" class="line">0997     <span class="comment">%% Prepare a hierarchical callbacks table data</span>
</div><div id="_line0998" class="line">0998     <a name="_sub18" href="#_subfunctions" class="code">function list = getTreeData(data)</a>
</div><div id="_line0999" class="line">0999         list = java.util.ArrayList();
</div><div id="_line1000" class="line">1000         names = regexprep(data,<span class="string">'([A-Z][a-z]+).*'</span>,<span class="string">'$1'</span>);
</div><div id="_line1001" class="line">1001         <span class="comment">%hash = java.util.Hashtable;</span>
</div><div id="_line1002" class="line">1002         others = {};
</div><div id="_line1003" class="line">1003         <span class="keyword">for</span> propIdx = 1 : length(data)
</div><div id="_line1004" class="line">1004             <span class="keyword">if</span> (propIdx &lt; length(data) &amp;&amp; strcmp(names{propIdx},names{propIdx+1})) || <span class="keyword">...</span>
</div><div id="_line1005" class="line">1005                (propIdx &gt; 1            &amp;&amp; strcmp(names{propIdx},names{propIdx-1}))
</div><div id="_line1006" class="line">1006                 <span class="comment">% Child callback property</span>
</div><div id="_line1007" class="line">1007                 <a href="#_sub17" class="code" title="subsetProp">setProp</a>(list,data{propIdx,1},data{propIdx,2},names{propIdx});
</div><div id="_line1008" class="line">1008             <span class="keyword">else</span>
</div><div id="_line1009" class="line">1009                 <span class="comment">% Singular callback property =&gt; Add to 'Other' category at bottom of the list</span>
</div><div id="_line1010" class="line">1010                 others(end+1,:) = data(propIdx,:);  <span class="comment">%#ok</span>
</div><div id="_line1011" class="line">1011             <span class="keyword">end</span>
</div><div id="_line1012" class="line">1012         <span class="keyword">end</span>
</div><div id="_line1013" class="line">1013         <span class="keyword">for</span> propIdx = 1 : size(others,1)
</div><div id="_line1014" class="line">1014             <a href="#_sub17" class="code" title="subsetProp">setProp</a>(list,others{propIdx,1},others{propIdx,2},<span class="string">'Other'</span>);
</div><div id="_line1015" class="line">1015         <span class="keyword">end</span>
</div><div id="_line1016" class="line">1016     <span class="keyword">end</span>  <span class="comment">% getTreeData</span>
</div><div id="_line1017" class="line">1017 
</div><div id="_line1018" class="line">1018     <span class="comment">%% Get callbacks table data</span>
</div><div id="_line1019" class="line">1019     <a name="_sub19" href="#_subfunctions" class="code">function [cbData, cbHeaders, cbTableEnabled] = getCbsData(obj, stripStdCbsFlag)</a>
</div><div id="_line1020" class="line">1020         <span class="comment">% Initialize</span>
</div><div id="_line1021" class="line">1021         cbData = {<span class="string">'(no callbacks)'</span>};
</div><div id="_line1022" class="line">1022         cbHeaders = {<span class="string">'Callback name'</span>};
</div><div id="_line1023" class="line">1023         cbTableEnabled = false;
</div><div id="_line1024" class="line">1024 
</div><div id="_line1025" class="line">1025         <span class="keyword">try</span>
</div><div id="_line1026" class="line">1026             classHdl = classhandle(handle(obj));
</div><div id="_line1027" class="line">1027             cbNames = get(classHdl.Events,<span class="string">'Name'</span>);
</div><div id="_line1028" class="line">1028             <span class="keyword">if</span> ~isempty(cbNames) &amp;&amp; ~iscom(obj)  <span class="comment">%only java-based please...</span>
</div><div id="_line1029" class="line">1029                 cbNames = strcat(cbNames,<span class="string">'Callback'</span>);
</div><div id="_line1030" class="line">1030             <span class="keyword">end</span>
</div><div id="_line1031" class="line">1031             propNames = get(classHdl.Properties,<span class="string">'Name'</span>);
</div><div id="_line1032" class="line">1032             propCbIdx = [];
</div><div id="_line1033" class="line">1033             <span class="keyword">if</span> <a href="#_sub52" class="code" title="subischar">ischar</a>(propNames),  propNames={propNames};  <span class="keyword">end</span>  <span class="comment">% handle case of a single callback</span>
</div><div id="_line1034" class="line">1034             <span class="keyword">if</span> ~isempty(propNames)
</div><div id="_line1035" class="line">1035                 propCbIdx = find(~cellfun(@isempty,regexp(propNames,<span class="string">'(Fcn|Callback)$'</span>)));
</div><div id="_line1036" class="line">1036                 cbNames = unique([cbNames; propNames(propCbIdx)]);  <span class="comment">%#ok logical is faster but less debuggable...</span>
</div><div id="_line1037" class="line">1037             <span class="keyword">end</span>
</div><div id="_line1038" class="line">1038             <span class="keyword">if</span> ~isempty(cbNames)
</div><div id="_line1039" class="line">1039                 <span class="keyword">if</span> stripStdCbsFlag
</div><div id="_line1040" class="line">1040                     cbNames = <a href="#_sub37" class="code" title="substripStdCbs">stripStdCbs</a>(cbNames);
</div><div id="_line1041" class="line">1041                 <span class="keyword">end</span>
</div><div id="_line1042" class="line">1042                 <span class="keyword">if</span> iscell(cbNames)
</div><div id="_line1043" class="line">1043                     cbNames = sort(cbNames);
</div><div id="_line1044" class="line">1044                     <span class="keyword">if</span> size(cbNames,1) &lt; size(cbNames,2)
</div><div id="_line1045" class="line">1045                         cbNames = cbNames';
</div><div id="_line1046" class="line">1046                     <span class="keyword">end</span>
</div><div id="_line1047" class="line">1047                 <span class="keyword">end</span>
</div><div id="_line1048" class="line">1048                 hgHandleFlag = 0;  <span class="keyword">try</span> hgHandleFlag = ishghandle(obj); <span class="keyword">catch</span>, <span class="keyword">end</span>  <span class="comment">%#ok</span>
</div><div id="_line1049" class="line">1049                 <span class="keyword">try</span>
</div><div id="_line1050" class="line">1050                     obj = handle(obj,<span class="string">'CallbackProperties'</span>);
</div><div id="_line1051" class="line">1051                 <span class="keyword">catch</span>
</div><div id="_line1052" class="line">1052                     hgHandleFlag = 1;
</div><div id="_line1053" class="line">1053                 <span class="keyword">end</span>
</div><div id="_line1054" class="line">1054                 <span class="keyword">if</span> hgHandleFlag
</div><div id="_line1055" class="line">1055                     <span class="comment">% HG handles don't allow CallbackProperties - search only for *Fcn</span>
</div><div id="_line1056" class="line">1056                     cbNames = propNames(propCbIdx);
</div><div id="_line1057" class="line">1057                 <span class="keyword">end</span>
</div><div id="_line1058" class="line">1058                 <span class="keyword">if</span> iscom(obj)
</div><div id="_line1059" class="line">1059                     cbs = obj.eventlisteners;
</div><div id="_line1060" class="line">1060                     <span class="keyword">if</span> ~isempty(cbs)
</div><div id="_line1061" class="line">1061                         cbNamesRegistered = cbs(:,1);
</div><div id="_line1062" class="line">1062                         cbData = setdiff(cbNames,cbNamesRegistered);
</div><div id="_line1063" class="line">1063                         <span class="comment">%cbData = charizeData(cbData);</span>
</div><div id="_line1064" class="line">1064                         <span class="keyword">if</span> size(cbData,2) &gt; size(cbData(1))
</div><div id="_line1065" class="line">1065                             cbData = cbData';
</div><div id="_line1066" class="line">1066                         <span class="keyword">end</span>
</div><div id="_line1067" class="line">1067                         cbData = [cbData, cellstr(repmat(<span class="string">' '</span>,length(cbData),1))];
</div><div id="_line1068" class="line">1068                         cbData = [cbData; cbs];
</div><div id="_line1069" class="line">1069                         [sortedNames, sortedIdx] = sort(cbData(:,1));
</div><div id="_line1070" class="line">1070                         sortedCbs = cellfun(@<a href="#_sub16" class="code" title="subcharizeData">charizeData</a>,cbData(sortedIdx,2),<span class="string">'un'</span>,0);
</div><div id="_line1071" class="line">1071                         cbData = [sortedNames, sortedCbs];
</div><div id="_line1072" class="line">1072                     <span class="keyword">else</span>
</div><div id="_line1073" class="line">1073                         cbData = [cbNames, cellstr(repmat(<span class="string">' '</span>,length(cbNames),1))];
</div><div id="_line1074" class="line">1074                     <span class="keyword">end</span>
</div><div id="_line1075" class="line">1075                 <span class="keyword">elseif</span> iscell(cbNames)
</div><div id="_line1076" class="line">1076                     cbNames = sort(cbNames);
</div><div id="_line1077" class="line">1077                     <span class="comment">%cbData = [cbNames, get(obj,cbNames)'];</span>
</div><div id="_line1078" class="line">1078                     cbData = cbNames;
</div><div id="_line1079" class="line">1079                     oldWarn = warning(<span class="string">'off'</span>,<span class="string">'MATLAB:hg:JavaSetHGProperty'</span>);
</div><div id="_line1080" class="line">1080                     warning(<span class="string">'off'</span>,<span class="string">'MATLAB:hg:PossibleDeprecatedJavaSetHGProperty'</span>);
</div><div id="_line1081" class="line">1081                     <span class="keyword">for</span> idx = 1 : length(cbNames)
</div><div id="_line1082" class="line">1082                         <span class="keyword">try</span>
</div><div id="_line1083" class="line">1083                             cbData{idx,2} = <a href="#_sub16" class="code" title="subcharizeData">charizeData</a>(get(obj,cbNames{idx}));
</div><div id="_line1084" class="line">1084                         <span class="keyword">catch</span>
</div><div id="_line1085" class="line">1085                             cbData{idx,2} = <span class="string">'(callback value inaccessible)'</span>;
</div><div id="_line1086" class="line">1086                         <span class="keyword">end</span>
</div><div id="_line1087" class="line">1087                     <span class="keyword">end</span>
</div><div id="_line1088" class="line">1088                     warning(oldWarn);
</div><div id="_line1089" class="line">1089                 <span class="keyword">else</span>  <span class="comment">% only one event callback</span>
</div><div id="_line1090" class="line">1090                     <span class="comment">%cbData = {cbNames, get(obj,cbNames)'};</span>
</div><div id="_line1091" class="line">1091                     <span class="comment">%cbData{1,2} = charizeData(cbData{1,2});</span>
</div><div id="_line1092" class="line">1092                     <span class="keyword">try</span>
</div><div id="_line1093" class="line">1093                         cbData = {cbNames, <a href="#_sub16" class="code" title="subcharizeData">charizeData</a>(get(obj,cbNames))};
</div><div id="_line1094" class="line">1094                     <span class="keyword">catch</span>
</div><div id="_line1095" class="line">1095                         cbData = {cbNames, <span class="string">'(callback value inaccessible)'</span>};
</div><div id="_line1096" class="line">1096                     <span class="keyword">end</span>
</div><div id="_line1097" class="line">1097                 <span class="keyword">end</span>
</div><div id="_line1098" class="line">1098                 cbHeaders = {<span class="string">'Callback name'</span>,<span class="string">'Callback value'</span>};
</div><div id="_line1099" class="line">1099                 cbTableEnabled = true;
</div><div id="_line1100" class="line">1100             <span class="keyword">end</span>
</div><div id="_line1101" class="line">1101         <span class="keyword">catch</span>
</div><div id="_line1102" class="line">1102             <span class="comment">% never mind - use default (empty) data</span>
</div><div id="_line1103" class="line">1103         <span class="keyword">end</span>
</div><div id="_line1104" class="line">1104     <span class="keyword">end</span>  <span class="comment">% getCbsData</span>
</div><div id="_line1105" class="line">1105 
</div><div id="_line1106" class="line">1106     <span class="comment">%% Get relative (0.0-1.0) divider location</span>
</div><div id="_line1107" class="line">1107     <a name="_sub20" href="#_subfunctions" class="code">function divLocation = getRalativeDivlocation(jDiv)</a>
</div><div id="_line1108" class="line">1108         divLocation = jDiv.getDividerLocation;
</div><div id="_line1109" class="line">1109         <span class="keyword">if</span> divLocation &gt; 1  <span class="comment">% i.e. [pixels]</span>
</div><div id="_line1110" class="line">1110             visibleRect = jDiv.getVisibleRect;
</div><div id="_line1111" class="line">1111             <span class="keyword">if</span> jDiv.getOrientation == 0  <span class="comment">% vertical</span>
</div><div id="_line1112" class="line">1112                 start = visibleRect.getY;
</div><div id="_line1113" class="line">1113                 extent = visibleRect.getHeight - start;
</div><div id="_line1114" class="line">1114             <span class="keyword">else</span>
</div><div id="_line1115" class="line">1115                 start = visibleRect.getX;
</div><div id="_line1116" class="line">1116                 extent = visibleRect.getWidth - start;
</div><div id="_line1117" class="line">1117             <span class="keyword">end</span>
</div><div id="_line1118" class="line">1118             divLocation = (divLocation - start) / extent;
</div><div id="_line1119" class="line">1119         <span class="keyword">end</span>
</div><div id="_line1120" class="line">1120     <span class="keyword">end</span>  <span class="comment">% getRalativeDivlocation</span>
</div><div id="_line1121" class="line">1121 
</div><div id="_line1122" class="line">1122     <span class="comment">%% Try to set a treenode icon based on a container's icon</span>
</div><div id="_line1123" class="line">1123     <a name="_sub21" href="#_subfunctions" class="code">function setTreeNodeIcon(treenode,container)</a>
</div><div id="_line1124" class="line">1124         <span class="keyword">try</span>
</div><div id="_line1125" class="line">1125             iconImage = [];
</div><div id="_line1126" class="line">1126             iconImage = container.getIcon;
</div><div id="_line1127" class="line">1127             <span class="keyword">if</span> ~isempty(findprop(handle(iconImage),<span class="string">'Image'</span>))  <span class="comment">% get(iconImage,'Image') is easier but leaks memory...</span>
</div><div id="_line1128" class="line">1128                 iconImage = iconImage.getImage;
</div><div id="_line1129" class="line">1129             <span class="keyword">else</span>
</div><div id="_line1130" class="line">1130                 a=b; <span class="comment">%#ok cause an error</span>
</div><div id="_line1131" class="line">1131             <span class="keyword">end</span>
</div><div id="_line1132" class="line">1132         <span class="keyword">catch</span>
</div><div id="_line1133" class="line">1133             <span class="keyword">try</span>
</div><div id="_line1134" class="line">1134                 iconImage = container.getIconImage;
</div><div id="_line1135" class="line">1135             <span class="keyword">catch</span>
</div><div id="_line1136" class="line">1136                 <span class="keyword">try</span>
</div><div id="_line1137" class="line">1137                     <span class="keyword">if</span> ~isempty(iconImage)
</div><div id="_line1138" class="line">1138                         ge = java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment;
</div><div id="_line1139" class="line">1139                         gd = ge.getDefaultScreenDevice;
</div><div id="_line1140" class="line">1140                         gc = gd.getDefaultConfiguration;
</div><div id="_line1141" class="line">1141                         image = gc.createCompatibleImage(iconImage.getIconWidth, iconImage.getIconHeight);  <span class="comment">% a BufferedImage object</span>
</div><div id="_line1142" class="line">1142                         g = image.createGraphics;
</div><div id="_line1143" class="line">1143                         iconImage.paintIcon([], g, 0, 0);
</div><div id="_line1144" class="line">1144                         g.dispose;
</div><div id="_line1145" class="line">1145                         iconImage = image;
</div><div id="_line1146" class="line">1146                     <span class="keyword">end</span>
</div><div id="_line1147" class="line">1147                 <span class="keyword">catch</span>
</div><div id="_line1148" class="line">1148                     <span class="comment">% never mind...</span>
</div><div id="_line1149" class="line">1149                 <span class="keyword">end</span>
</div><div id="_line1150" class="line">1150             <span class="keyword">end</span>
</div><div id="_line1151" class="line">1151         <span class="keyword">end</span>
</div><div id="_line1152" class="line">1152         <span class="keyword">if</span> ~isempty(iconImage)
</div><div id="_line1153" class="line">1153             iconImage = <a href="#_sub34" class="code" title="subsetIconSize">setIconSize</a>(iconImage);
</div><div id="_line1154" class="line">1154             treenode.setIcon(iconImage);
</div><div id="_line1155" class="line">1155         <span class="keyword">end</span>
</div><div id="_line1156" class="line">1156     <span class="keyword">end</span>  <span class="comment">% setTreeNodeIcon</span>
</div><div id="_line1157" class="line">1157 
</div><div id="_line1158" class="line">1158     <span class="comment">%% Present the object hierarchy tree</span>
</div><div id="_line1159" class="line">1159     <a name="_sub22" href="#_subfunctions" class="code">function presentObjectTree()</a>
</div><div id="_line1160" class="line">1160         <span class="keyword">persistent</span> lastVersionCheck
</div><div id="_line1161" class="line">1161         <span class="keyword">if</span> isempty(lastVersionCheck),  lastVersionCheck = now-1;  <span class="keyword">end</span>
</div><div id="_line1162" class="line">1162 
</div><div id="_line1163" class="line">1163         import java.awt.*
</div><div id="_line1164" class="line">1164         import javax.swing.*
</div><div id="_line1165" class="line">1165         hTreeFig = findall(0,<span class="string">'tag'</span>,<span class="string">'findjobjFig'</span>);
</div><div id="_line1166" class="line">1166         iconpath = [matlabroot, <span class="string">'/toolbox/matlab/icons/'</span>];
</div><div id="_line1167" class="line">1167         cbHideStd = 0;  <span class="comment">% Initial state of the cbHideStdCbs checkbox</span>
</div><div id="_line1168" class="line">1168         <span class="keyword">if</span> isempty(hTreeFig)
</div><div id="_line1169" class="line">1169             <span class="comment">% Prepare the figure</span>
</div><div id="_line1170" class="line">1170             hTreeFig = figure(<span class="string">'tag'</span>,<span class="string">'findjobjFig'</span>,<span class="string">'menuBar'</span>,<span class="string">'none'</span>,<span class="string">'toolBar'</span>,<span class="string">'none'</span>,<span class="string">'Name'</span>,<span class="string">'FindJObj'</span>,<span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="string">'handleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'IntegerHandle'</span>,<span class="string">'off'</span>);
</div><div id="_line1171" class="line">1171             figIcon = ImageIcon([iconpath <span class="string">'tool_legend.gif'</span>]);
</div><div id="_line1172" class="line">1172             drawnow;
</div><div id="_line1173" class="line">1173             <span class="keyword">try</span>
</div><div id="_line1174" class="line">1174                 mde = com.mathworks.mde.desk.MLDesktop.getInstance;
</div><div id="_line1175" class="line">1175                 jTreeFig = mde.getClient(<span class="string">'FindJObj'</span>).getTopLevelAncestor;
</div><div id="_line1176" class="line">1176                 jTreeFig.setIcon(figIcon);
</div><div id="_line1177" class="line">1177             <span class="keyword">catch</span>
</div><div id="_line1178" class="line">1178                 warning(<span class="string">'off'</span>,<span class="string">'MATLAB:HandleGraphics:ObsoletedProperty:JavaFrame'</span>);  <span class="comment">% R2008b compatibility</span>
</div><div id="_line1179" class="line">1179                 jTreeFig = get(hTreeFig,<span class="string">'JavaFrame'</span>);
</div><div id="_line1180" class="line">1180                 jTreeFig.setFigureIcon(figIcon);
</div><div id="_line1181" class="line">1181             <span class="keyword">end</span>
</div><div id="_line1182" class="line">1182             vsplitPaneLocation = 0.8;
</div><div id="_line1183" class="line">1183             hsplitPaneLocation = 0.5;
</div><div id="_line1184" class="line">1184         <span class="keyword">else</span>
</div><div id="_line1185" class="line">1185             <span class="comment">% Remember cbHideStdCbs checkbox &amp; dividers state for later</span>
</div><div id="_line1186" class="line">1186             userdata = get(hTreeFig, <span class="string">'userdata'</span>);
</div><div id="_line1187" class="line">1187             <span class="keyword">try</span> cbHideStd = userdata.cbHideStdCbs.isSelected; <span class="keyword">catch</span>, <span class="keyword">end</span>  <span class="comment">%#ok</span>
</div><div id="_line1188" class="line">1188             <span class="keyword">try</span>
</div><div id="_line1189" class="line">1189                 vsplitPaneLocation = <a href="#_sub20" class="code" title="subgetRalativeDivlocation">getRalativeDivlocation</a>(userdata.vsplitPane);
</div><div id="_line1190" class="line">1190                 hsplitPaneLocation = <a href="#_sub20" class="code" title="subgetRalativeDivlocation">getRalativeDivlocation</a>(userdata.hsplitPane);
</div><div id="_line1191" class="line">1191             <span class="keyword">catch</span>
</div><div id="_line1192" class="line">1192                 vsplitPaneLocation = 0.8;
</div><div id="_line1193" class="line">1193                 hsplitPaneLocation = 0.5;
</div><div id="_line1194" class="line">1194             <span class="keyword">end</span>
</div><div id="_line1195" class="line">1195 
</div><div id="_line1196" class="line">1196             <span class="comment">% Clear the figure and redraw</span>
</div><div id="_line1197" class="line">1197             clf(hTreeFig);
</div><div id="_line1198" class="line">1198             figure(hTreeFig);   <span class="comment">% bring to front</span>
</div><div id="_line1199" class="line">1199         <span class="keyword">end</span>
</div><div id="_line1200" class="line">1200 
</div><div id="_line1201" class="line">1201         <span class="comment">% Traverse all HG children, if root container was a HG handle</span>
</div><div id="_line1202" class="line">1202         <span class="keyword">if</span> ishghandle(origContainer) <span class="comment">%&amp;&amp; ~isequal(origContainer,container)</span>
</div><div id="_line1203" class="line">1203             <a href="#_sub50" class="code" title="subtraverseHGContainer">traverseHGContainer</a>(origContainer,0,0);
</div><div id="_line1204" class="line">1204         <span class="keyword">end</span>
</div><div id="_line1205" class="line">1205 
</div><div id="_line1206" class="line">1206         <span class="comment">% Prepare the tree pane</span>
</div><div id="_line1207" class="line">1207         warning(<span class="string">'off'</span>,<span class="string">'MATLAB:uitreenode:MigratingFunction'</span>);  <span class="comment">% R2008b compatibility</span>
</div><div id="_line1208" class="line">1208         warning(<span class="string">'off'</span>,<span class="string">'MATLAB:uitreenode:DeprecatedFunction'</span>); <span class="comment">% R2008a compatibility</span>
</div><div id="_line1209" class="line">1209         tree_h = com.mathworks.hg.peer.UITreePeer;
</div><div id="_line1210" class="line">1210         hasChildren = sum(allParents==1) &gt; 1;
</div><div id="_line1211" class="line">1211         icon = [iconpath <span class="string">'upfolder.gif'</span>];
</div><div id="_line1212" class="line">1212         [rootName, rootTitle] = <a href="#_sub36" class="code" title="subgetNodeName">getNodeName</a>(container);
</div><div id="_line1213" class="line">1213         <span class="keyword">try</span>
</div><div id="_line1214" class="line">1214             root = uitreenode(<span class="string">'v0'</span>, handle(container), rootName, icon, ~hasChildren);
</div><div id="_line1215" class="line">1215         <span class="keyword">catch</span>  <span class="comment">% old matlab version don't have the 'v0' option</span>
</div><div id="_line1216" class="line">1216             root = uitreenode(handle(container), rootName, icon, ~hasChildren);
</div><div id="_line1217" class="line">1217         <span class="keyword">end</span>
</div><div id="_line1218" class="line">1218         <a href="#_sub21" class="code" title="subsetTreeNodeIcon">setTreeNodeIcon</a>(root,container);  <span class="comment">% constructor must accept a char icon unfortunately, so need to do this afterwards...</span>
</div><div id="_line1219" class="line">1219         <span class="keyword">if</span> ~isempty(rootTitle)
</div><div id="_line1220" class="line">1220             set(hTreeFig, <span class="string">'Name'</span>,[<span class="string">'FindJObj - '</span> char(rootTitle)]);
</div><div id="_line1221" class="line">1221         <span class="keyword">end</span>
</div><div id="_line1222" class="line">1222         nodedata.idx = 1;
</div><div id="_line1223" class="line">1223         nodedata.obj = container;
</div><div id="_line1224" class="line">1224         set(root,<span class="string">'userdata'</span>,nodedata);
</div><div id="_line1225" class="line">1225         root.setUserObject(container);
</div><div id="_line1226" class="line">1226         setappdata(root,<span class="string">'childHandle'</span>,container);
</div><div id="_line1227" class="line">1227         tree_h.setRoot(root);
</div><div id="_line1228" class="line">1228         treePane = tree_h.getScrollPane;
</div><div id="_line1229" class="line">1229         treePane.setMinimumSize(Dimension(50,50));
</div><div id="_line1230" class="line">1230         jTreeObj = treePane.getViewport.getComponent(0);
</div><div id="_line1231" class="line">1231         jTreeObj.setShowsRootHandles(true)
</div><div id="_line1232" class="line">1232         jTreeObj.getSelectionModel.setSelectionMode(javax.swing.tree.TreeSelectionModel.DISCONTIGUOUS_TREE_SELECTION);
</div><div id="_line1233" class="line">1233         <span class="comment">%jTreeObj.setVisible(0);</span>
</div><div id="_line1234" class="line">1234         <span class="comment">%jTreeObj.getCellRenderer.setLeafIcon([]);</span>
</div><div id="_line1235" class="line">1235         <span class="comment">%jTreeObj.getCellRenderer.setOpenIcon(figIcon);</span>
</div><div id="_line1236" class="line">1236         <span class="comment">%jTreeObj.getCellRenderer.setClosedIcon([]);</span>
</div><div id="_line1237" class="line">1237         treePanel = JPanel(BorderLayout);
</div><div id="_line1238" class="line">1238         treePanel.add(treePane, BorderLayout.CENTER);
</div><div id="_line1239" class="line">1239         progressBar = JProgressBar(0);
</div><div id="_line1240" class="line">1240         progressBar.setMaximum(length(allHandles) + length(hg_handles));  <span class="comment">% = # of all nodes</span>
</div><div id="_line1241" class="line">1241         treePanel.add(progressBar, BorderLayout.SOUTH);
</div><div id="_line1242" class="line">1242 
</div><div id="_line1243" class="line">1243         <span class="comment">% Prepare the image pane</span>
</div><div id="_line1244" class="line">1244 <span class="comment">%disable for now, until we get it working...</span>
</div><div id="_line1245" class="line">1245 <span class="comment">%{</span>
</div><div id="_line1246" class="line">1246         <span class="keyword">try</span>
</div><div id="_line1247" class="line">1247             hFig = ancestor(origContainer,<span class="string">'figure'</span>);
</div><div id="_line1248" class="line">1248             [cdata, cm] = getframe(hFig);  <span class="comment">%#ok cm unused</span>
</div><div id="_line1249" class="line">1249             tempfname = [tempname <span class="string">'.png'</span>];
</div><div id="_line1250" class="line">1250             imwrite(cdata,tempfname);  <span class="comment">% don't know how to pass directly to BufferedImage, so use disk...</span>
</div><div id="_line1251" class="line">1251             jImg = javax.imageio.ImageIO.read(java.io.File(tempfname));
</div><div id="_line1252" class="line">1252             <span class="keyword">try</span> delete(tempfname);  <span class="keyword">catch</span>  <span class="keyword">end</span>
</div><div id="_line1253" class="line">1253             imgPanel = JPanel();
</div><div id="_line1254" class="line">1254             leftPanel = JSplitPane(JSplitPane.VERTICAL_SPLIT, treePanel, imgPanel);
</div><div id="_line1255" class="line">1255             leftPanel.setOneTouchExpandable(true);
</div><div id="_line1256" class="line">1256             leftPanel.setContinuousLayout(true);
</div><div id="_line1257" class="line">1257             leftPanel.setResizeWeight(0.8);
</div><div id="_line1258" class="line">1258         <span class="keyword">catch</span>
</div><div id="_line1259" class="line">1259             leftPanel = treePanel;
</div><div id="_line1260" class="line">1260         <span class="keyword">end</span>
</div><div id="_line1261" class="line">1261 <span class="comment">%}</span>
</div><div id="_line1262" class="line">1262         leftPanel = treePanel;
</div><div id="_line1263" class="line">1263 
</div><div id="_line1264" class="line">1264         <span class="comment">% Prepare the inspector pane</span>
</div><div id="_line1265" class="line">1265         classNameLabel = JLabel([<span class="string">'      '</span> char(class(container))]);
</div><div id="_line1266" class="line">1266         classNameLabel.setForeground(Color.blue);
</div><div id="_line1267" class="line">1267         <a href="#_sub32" class="code" title="subupdateNodeTooltip">updateNodeTooltip</a>(container, classNameLabel);
</div><div id="_line1268" class="line">1268         inspectorPanel = JPanel(BorderLayout);
</div><div id="_line1269" class="line">1269         inspectorPanel.add(classNameLabel, BorderLayout.NORTH);
</div><div id="_line1270" class="line">1270         <span class="comment">% TODO: Maybe uncomment the following when we add the HG tree - in the meantime it's unused (java properties are un-groupable)</span>
</div><div id="_line1271" class="line">1271         <span class="comment">%objReg = com.mathworks.services.ObjectRegistry.getLayoutRegistry;</span>
</div><div id="_line1272" class="line">1272         <span class="comment">%toolBar = awtinvoke('com.mathworks.mlwidgets.inspector.PropertyView$ToolBarStyle','valueOf(Ljava.lang.String;)','GROUPTOOLBAR');</span>
</div><div id="_line1273" class="line">1273         <span class="comment">%inspectorPane = com.mathworks.mlwidgets.inspector.PropertyView(objReg, toolBar);</span>
</div><div id="_line1274" class="line">1274         inspectorPane = com.mathworks.mlwidgets.inspector.PropertyView;
</div><div id="_line1275" class="line">1275         identifiers = <a href="#_sub24" class="code" title="subdisableDbstopError">disableDbstopError</a>;  <span class="comment">%#ok &quot;dbstop if error&quot; causes inspect.m to croak due to a bug - so workaround</span>
</div><div id="_line1276" class="line">1276         inspectorPane.setObject(container);
</div><div id="_line1277" class="line">1277         inspectorPane.setAutoUpdate(true);
</div><div id="_line1278" class="line">1278         <span class="comment">% TODO: Add property listeners</span>
</div><div id="_line1279" class="line">1279         <span class="comment">% TODO: Display additional props</span>
</div><div id="_line1280" class="line">1280         inspectorTable = inspectorPane;
</div><div id="_line1281" class="line">1281         <span class="keyword">try</span>
</div><div id="_line1282" class="line">1282             <span class="keyword">while</span> ~isa(inspectorTable,<span class="string">'javax.swing.JTable'</span>)
</div><div id="_line1283" class="line">1283                 inspectorTable = inspectorTable.getComponent(0);
</div><div id="_line1284" class="line">1284             <span class="keyword">end</span>
</div><div id="_line1285" class="line">1285         <span class="keyword">catch</span>
</div><div id="_line1286" class="line">1286             <span class="comment">% R2010a</span>
</div><div id="_line1287" class="line">1287             inspectorTable = inspectorPane.getComponent(0).getScrollPane.getViewport.getComponent(0);
</div><div id="_line1288" class="line">1288         <span class="keyword">end</span>
</div><div id="_line1289" class="line">1289         toolTipText = <span class="string">'hover mouse over the red classname above to see the full list of properties'</span>;
</div><div id="_line1290" class="line">1290         inspectorTable.setToolTipText(toolTipText);
</div><div id="_line1291" class="line">1291         jideTableUtils = [];
</div><div id="_line1292" class="line">1292         <span class="keyword">try</span>
</div><div id="_line1293" class="line">1293             <span class="comment">% Try JIDE features - see http://www.jidesoft.com/products/JIDE_Grids_Developer_Guide.pdf</span>
</div><div id="_line1294" class="line">1294             com.mathworks.mwswing.MJUtilities.initJIDE;
</div><div id="_line1295" class="line">1295             jideTableUtils = eval(<span class="string">'com.jidesoft.grid.TableUtils;'</span>);  <span class="comment">% prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1296" class="line">1296             jideTableUtils.autoResizeAllColumns(inspectorTable);
</div><div id="_line1297" class="line">1297             inspectorTable.setRowAutoResizes(true);
</div><div id="_line1298" class="line">1298             inspectorTable.getModel.setShowExpert(1);
</div><div id="_line1299" class="line">1299         <span class="keyword">catch</span>
</div><div id="_line1300" class="line">1300             <span class="comment">% JIDE is probably unavailable - never mind...</span>
</div><div id="_line1301" class="line">1301         <span class="keyword">end</span>
</div><div id="_line1302" class="line">1302         inspectorPanel.add(inspectorPane, BorderLayout.CENTER);
</div><div id="_line1303" class="line">1303         <span class="comment">% TODO: Add data update listeners</span>
</div><div id="_line1304" class="line">1304 
</div><div id="_line1305" class="line">1305         <span class="comment">% Prepare the callbacks pane</span>
</div><div id="_line1306" class="line">1306         callbacksPanel = JPanel(BorderLayout);
</div><div id="_line1307" class="line">1307         stripStdCbsFlag = true;  <span class="comment">% initial value</span>
</div><div id="_line1308" class="line">1308         [cbData, cbHeaders, cbTableEnabled] = <a href="#_sub19" class="code" title="subgetCbsData">getCbsData</a>(container, stripStdCbsFlag);
</div><div id="_line1309" class="line">1309         <span class="comment">%{</span>
</div><div id="_line1310" class="line">1310         <span class="comment">%classHdl = classhandle(handle(container));</span>
</div><div id="_line1311" class="line">1311         <span class="comment">%eventNames = get(classHdl.Events,'Name');</span>
</div><div id="_line1312" class="line">1312         <span class="comment">%if ~isempty(eventNames)</span>
</div><div id="_line1313" class="line">1313         <span class="comment">%    cbNames = sort(strcat(eventNames,'Callback'));</span>
</div><div id="_line1314" class="line">1314         <span class="comment">%    try</span>
</div><div id="_line1315" class="line">1315         <span class="comment">%        cbData = [cbNames, get(container,cbNames)'];</span>
</div><div id="_line1316" class="line">1316         <span class="comment">%    catch</span>
</div><div id="_line1317" class="line">1317         <span class="comment">%        % R2010a</span>
</div><div id="_line1318" class="line">1318         <span class="comment">%        cbData = cbNames;</span>
</div><div id="_line1319" class="line">1319         <span class="comment">%        if isempty(cbData)</span>
</div><div id="_line1320" class="line">1320         <span class="comment">%            cbData = {};</span>
</div><div id="_line1321" class="line">1321         <span class="comment">%        elseif ~iscell(cbData)</span>
</div><div id="_line1322" class="line">1322         <span class="comment">%            cbData = {cbData};</span>
</div><div id="_line1323" class="line">1323         <span class="comment">%        end</span>
</div><div id="_line1324" class="line">1324         <span class="comment">%        for idx = 1 : length(cbNames)</span>
</div><div id="_line1325" class="line">1325         <span class="comment">%            cbData{idx,2} = get(container,cbNames{idx});</span>
</div><div id="_line1326" class="line">1326         <span class="comment">%        end</span>
</div><div id="_line1327" class="line">1327         <span class="comment">%    end</span>
</div><div id="_line1328" class="line">1328         <span class="comment">%    cbTableEnabled = true;</span>
</div><div id="_line1329" class="line">1329         <span class="comment">%else</span>
</div><div id="_line1330" class="line">1330         <span class="comment">%    cbData = {'(no callbacks)',''};</span>
</div><div id="_line1331" class="line">1331         <span class="comment">%    cbTableEnabled = false;</span>
</div><div id="_line1332" class="line">1332         <span class="comment">%end</span>
</div><div id="_line1333" class="line">1333         <span class="comment">%cbHeaders = {'Callback name','Callback value'};</span>
</div><div id="_line1334" class="line">1334         <span class="comment">%}</span>
</div><div id="_line1335" class="line">1335         <span class="keyword">try</span>
</div><div id="_line1336" class="line">1336             <span class="comment">% Use JideTable if available on this system</span>
</div><div id="_line1337" class="line">1337             <span class="comment">%callbacksTableModel = javax.swing.table.DefaultTableModel(cbData,cbHeaders);  %#ok</span>
</div><div id="_line1338" class="line">1338             <span class="comment">%callbacksTable = eval('com.jidesoft.grid.PropertyTable(callbacksTableModel);');  % prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1339" class="line">1339             <span class="keyword">try</span>
</div><div id="_line1340" class="line">1340                 list = <a href="#_sub18" class="code" title="subgetTreeData">getTreeData</a>(cbData);  <span class="comment">%#ok</span>
</div><div id="_line1341" class="line">1341                 model = eval(<span class="string">'com.jidesoft.grid.PropertyTableModel(list);'</span>);  <span class="comment">%#ok prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1342" class="line">1342 
</div><div id="_line1343" class="line">1343                 <span class="comment">% Auto-expand if only one category</span>
</div><div id="_line1344" class="line">1344                 <span class="keyword">if</span> model.getRowCount==1   <span class="comment">% length(model.getCategories)==1 fails for some unknown reason...</span>
</div><div id="_line1345" class="line">1345                     model.expandFirstLevel;
</div><div id="_line1346" class="line">1346                 <span class="keyword">end</span>
</div><div id="_line1347" class="line">1347 
</div><div id="_line1348" class="line">1348                 <span class="comment">%callbacksTable = eval('com.jidesoft.grid.TreeTable(model);');  %#ok prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1349" class="line">1349                 callbacksTable = eval(<span class="string">'com.jidesoft.grid.PropertyTable(model);'</span>);  <span class="comment">%#ok prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1350" class="line">1350 
</div><div id="_line1351" class="line">1351                 <span class="comment">%callbacksTable.expandFirstLevel;</span>
</div><div id="_line1352" class="line">1352                 callbacksTable.setShowsRootHandles(true);
</div><div id="_line1353" class="line">1353                 callbacksTable.setShowTreeLines(false);
</div><div id="_line1354" class="line">1354                 <span class="comment">%callbacksTable.setShowNonEditable(0);  %=SHOW_NONEDITABLE_NEITHER</span>
</div><div id="_line1355" class="line">1355                 callbacksPane = eval(<span class="string">'com.jidesoft.grid.PropertyPane(callbacksTable);'</span>);  <span class="comment">% prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1356" class="line">1356                 callbacksPane.setShowDescription(false);
</div><div id="_line1357" class="line">1357             <span class="keyword">catch</span>
</div><div id="_line1358" class="line">1358                 callbacksTable = eval(<span class="string">'com.jidesoft.grid.TreeTable(cbData,cbHeaders);'</span>);  <span class="comment">% prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1359" class="line">1359             <span class="keyword">end</span>
</div><div id="_line1360" class="line">1360             callbacksTable.setRowAutoResizes(true);
</div><div id="_line1361" class="line">1361             callbacksTable.setColumnAutoResizable(true);
</div><div id="_line1362" class="line">1362             callbacksTable.setColumnResizable(true);
</div><div id="_line1363" class="line">1363             jideTableUtils.autoResizeAllColumns(callbacksTable);
</div><div id="_line1364" class="line">1364             callbacksTable.setTableHeader([]);  <span class="comment">% hide the column headers since now we can resize columns with the gridline</span>
</div><div id="_line1365" class="line">1365             callbacksLabel = JLabel(<span class="string">' Callbacks:'</span>);  <span class="comment">% The column headers are replaced with a header label</span>
</div><div id="_line1366" class="line">1366             callbacksLabel.setForeground(Color.blue);
</div><div id="_line1367" class="line">1367             <span class="comment">%callbacksPanel.add(callbacksLabel, BorderLayout.NORTH);</span>
</div><div id="_line1368" class="line">1368 
</div><div id="_line1369" class="line">1369             <span class="comment">% Add checkbox to show/hide standard callbacks</span>
</div><div id="_line1370" class="line">1370             callbacksTopPanel = JPanel;
</div><div id="_line1371" class="line">1371             callbacksTopPanel.setLayout(BoxLayout(callbacksTopPanel, BoxLayout.LINE_AXIS));
</div><div id="_line1372" class="line">1372             callbacksTopPanel.add(callbacksLabel);
</div><div id="_line1373" class="line">1373             callbacksTopPanel.add(Box.createHorizontalGlue);
</div><div id="_line1374" class="line">1374             jcb = JCheckBox(<span class="string">'Hide standard callbacks'</span>, cbHideStd);
</div><div id="_line1375" class="line">1375             set(handle(jcb,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>,{@<a href="#_sub38" class="code" title="subcbHideStdCbs_Callback">cbHideStdCbs_Callback</a>,callbacksTable});
</div><div id="_line1376" class="line">1376             <span class="keyword">try</span>
</div><div id="_line1377" class="line">1377                 set(jcb, <span class="string">'userdata'</span>,callbacksTable, <span class="string">'tooltip'</span>,<span class="string">'Hide standard Swing callbacks - only component-specific callbacks will be displayed'</span>);
</div><div id="_line1378" class="line">1378             <span class="keyword">catch</span>
</div><div id="_line1379" class="line">1379                 jcb.setToolTipText(<span class="string">'Hide standard Swing callbacks - only component-specific callbacks will be displayed'</span>);
</div><div id="_line1380" class="line">1380                 <span class="comment">%setappdata(jcb,'userdata',callbacksTable);</span>
</div><div id="_line1381" class="line">1381             <span class="keyword">end</span>
</div><div id="_line1382" class="line">1382             callbacksTopPanel.add(jcb);
</div><div id="_line1383" class="line">1383             callbacksPanel.add(callbacksTopPanel, BorderLayout.NORTH);
</div><div id="_line1384" class="line">1384         <span class="keyword">catch</span>
</div><div id="_line1385" class="line">1385             <span class="comment">% Otherwise, use a standard Swing JTable (keep the headers to enable resizing)</span>
</div><div id="_line1386" class="line">1386             callbacksTable = JTable(cbData,cbHeaders);
</div><div id="_line1387" class="line">1387         <span class="keyword">end</span>
</div><div id="_line1388" class="line">1388         cbToolTipText = <span class="string">'Callbacks may be ''strings'', @funcHandle or {@funcHandle,arg1,...}'</span>;
</div><div id="_line1389" class="line">1389         callbacksTable.setToolTipText(cbToolTipText);
</div><div id="_line1390" class="line">1390         callbacksTable.setGridColor(inspectorTable.getGridColor);
</div><div id="_line1391" class="line">1391         cbNameTextField = JTextField;
</div><div id="_line1392" class="line">1392         cbNameTextField.setEditable(false);  <span class="comment">% ensure that the callback names are not modified...</span>
</div><div id="_line1393" class="line">1393         cbNameCellEditor = DefaultCellEditor(cbNameTextField);
</div><div id="_line1394" class="line">1394         cbNameCellEditor.setClickCountToStart(intmax);  <span class="comment">% i.e, never enter edit mode...</span>
</div><div id="_line1395" class="line">1395         callbacksTable.getColumnModel.getColumn(0).setCellEditor(cbNameCellEditor);
</div><div id="_line1396" class="line">1396         <span class="keyword">if</span> ~cbTableEnabled
</div><div id="_line1397" class="line">1397             callbacksTable.getColumnModel.getColumn(1).setCellEditor(cbNameCellEditor);
</div><div id="_line1398" class="line">1398         <span class="keyword">end</span>
</div><div id="_line1399" class="line">1399         hModel = callbacksTable.getModel;
</div><div id="_line1400" class="line">1400         set(handle(hModel,<span class="string">'CallbackProperties'</span>), <span class="string">'TableChangedCallback'</span>,{@<a href="#_sub47" class="code" title="subtbCallbacksChanged">tbCallbacksChanged</a>,container,callbacksTable});
</div><div id="_line1401" class="line">1401         <span class="comment">%set(hModel, 'UserData',container);</span>
</div><div id="_line1402" class="line">1402         <span class="keyword">try</span>
</div><div id="_line1403" class="line">1403             cbScrollPane = callbacksPane; <span class="comment">%JScrollPane(callbacksPane);</span>
</div><div id="_line1404" class="line">1404             <span class="comment">%cbScrollPane.setHorizontalScrollBarPolicy(cbScrollPane.HORIZONTAL_SCROLLBAR_NEVER);</span>
</div><div id="_line1405" class="line">1405         <span class="keyword">catch</span>
</div><div id="_line1406" class="line">1406             cbScrollPane = JScrollPane(callbacksTable);
</div><div id="_line1407" class="line">1407             cbScrollPane.setVerticalScrollBarPolicy(cbScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);
</div><div id="_line1408" class="line">1408         <span class="keyword">end</span>
</div><div id="_line1409" class="line">1409         callbacksPanel.add(cbScrollPane, BorderLayout.CENTER);
</div><div id="_line1410" class="line">1410         callbacksPanel.setToolTipText(cbToolTipText);
</div><div id="_line1411" class="line">1411 
</div><div id="_line1412" class="line">1412         <span class="comment">% Prepare the top-bottom JSplitPanes</span>
</div><div id="_line1413" class="line">1413         vsplitPane = JSplitPane(JSplitPane.VERTICAL_SPLIT, inspectorPanel, callbacksPanel);
</div><div id="_line1414" class="line">1414         vsplitPane.setOneTouchExpandable(true);
</div><div id="_line1415" class="line">1415         vsplitPane.setContinuousLayout(true);
</div><div id="_line1416" class="line">1416         vsplitPane.setResizeWeight(0.8);
</div><div id="_line1417" class="line">1417 
</div><div id="_line1418" class="line">1418         <span class="comment">% Prepare the left-right JSplitPane</span>
</div><div id="_line1419" class="line">1419         hsplitPane = JSplitPane(JSplitPane.HORIZONTAL_SPLIT, leftPanel, vsplitPane);
</div><div id="_line1420" class="line">1420         hsplitPane.setOneTouchExpandable(true);
</div><div id="_line1421" class="line">1421         hsplitPane.setContinuousLayout(true);
</div><div id="_line1422" class="line">1422         hsplitPane.setResizeWeight(0.6);
</div><div id="_line1423" class="line">1423         pos = getpixelposition(hTreeFig);
</div><div id="_line1424" class="line">1424 
</div><div id="_line1425" class="line">1425         <span class="comment">% Prepare the bottom pane with all buttons</span>
</div><div id="_line1426" class="line">1426         lowerPanel = JPanel(FlowLayout);
</div><div id="_line1427" class="line">1427         blogUrlLabel = <span class="string">'&lt;a href=&quot;http://UndocumentedMatlab.com&quot;&gt;Undocumented&lt;br&gt;Matlab.com&lt;/a&gt;'</span>;
</div><div id="_line1428" class="line">1428         jWebsite = <a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(blogUrlLabel, @<a href="#_sub39" class="code" title="subbtWebsite_Callback">btWebsite_Callback</a>, <span class="string">'Visit the UndocumentedMatlab.com blog'</span>);
</div><div id="_line1429" class="line">1429         jWebsite.setContentAreaFilled(0);
</div><div id="_line1430" class="line">1430         lowerPanel.add(jWebsite);
</div><div id="_line1431" class="line">1431         lowerPanel.add(<a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(<span class="string">'Refresh&lt;br&gt;tree'</span>,        {@<a href="#_sub40" class="code" title="subbtRefresh_Callback">btRefresh_Callback</a>, origContainer, hTreeFig}, <span class="string">'Rescan the component tree, from the root down'</span>));
</div><div id="_line1432" class="line">1432         lowerPanel.add(<a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(<span class="string">'Export to&lt;br&gt;workspace'</span>, {@<a href="#_sub41" class="code" title="subbtExport_Callback">btExport_Callback</a>,  jTreeObj, classNameLabel}, <span class="string">'Export the selected component handles to workspace variable findjobj_hdls'</span>));
</div><div id="_line1433" class="line">1433         lowerPanel.add(<a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(<span class="string">'Request&lt;br&gt;focus'</span>,       {@<a href="#_sub42" class="code" title="subbtFocus_Callback">btFocus_Callback</a>,   jTreeObj, root}, <span class="string">'Set the focus on the first selected component'</span>));
</div><div id="_line1434" class="line">1434         lowerPanel.add(<a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(<span class="string">'Inspect&lt;br&gt;object'</span>,      {@<a href="#_sub43" class="code" title="subbtInspect_Callback">btInspect_Callback</a>, jTreeObj, root}, <span class="string">'View the signature of all methods supported by the first selected component'</span>));
</div><div id="_line1435" class="line">1435         lowerPanel.add(<a href="#_sub27" class="code" title="subcreateJButton">createJButton</a>(<span class="string">'Check for&lt;br&gt;updates'</span>,   {@<a href="#_sub44" class="code" title="subbtCheckFex_Callback">btCheckFex_Callback</a>}, <span class="string">'Check the MathWorks FileExchange for the latest version of FindJObj'</span>));
</div><div id="_line1436" class="line">1436 
</div><div id="_line1437" class="line">1437         <span class="comment">% Display everything on-screen</span>
</div><div id="_line1438" class="line">1438         globalPanel = JPanel(BorderLayout);
</div><div id="_line1439" class="line">1439         globalPanel.add(hsplitPane, BorderLayout.CENTER);
</div><div id="_line1440" class="line">1440         globalPanel.add(lowerPanel, BorderLayout.SOUTH);
</div><div id="_line1441" class="line">1441         [obj, hcontainer] = javacomponent(globalPanel, [0,0,pos(3:4)], hTreeFig);
</div><div id="_line1442" class="line">1442         set(hcontainer,<span class="string">'units'</span>,<span class="string">'normalized'</span>);
</div><div id="_line1443" class="line">1443         drawnow;
</div><div id="_line1444" class="line">1444         hsplitPane.setDividerLocation(hsplitPaneLocation);  <span class="comment">% this only works after the JSplitPane is displayed...</span>
</div><div id="_line1445" class="line">1445         vsplitPane.setDividerLocation(vsplitPaneLocation);  <span class="comment">% this only works after the JSplitPane is displayed...</span>
</div><div id="_line1446" class="line">1446         <span class="comment">%restoreDbstopError(identifiers);</span>
</div><div id="_line1447" class="line">1447 
</div><div id="_line1448" class="line">1448         <span class="comment">% Refresh &amp; resize the screenshot thumbnail</span>
</div><div id="_line1449" class="line">1449 <span class="comment">%disable for now, until we get it working...</span>
</div><div id="_line1450" class="line">1450 <span class="comment">%{</span>
</div><div id="_line1451" class="line">1451         <span class="keyword">try</span>
</div><div id="_line1452" class="line">1452             hAx = axes(<span class="string">'Parent'</span>,hTreeFig, <span class="string">'units'</span>,<span class="string">'pixels'</span>, <span class="string">'position'</span>,[10,10,250,150], <span class="string">'visible'</span>,<span class="string">'off'</span>);
</div><div id="_line1453" class="line">1453             axis(hAx,<span class="string">'image'</span>);
</div><div id="_line1454" class="line">1454             image(cdata,<span class="string">'Parent'</span>,hAx);
</div><div id="_line1455" class="line">1455             axis(hAx,<span class="string">'off'</span>);
</div><div id="_line1456" class="line">1456             set(hAx,<span class="string">'UserData'</span>,cdata);
</div><div id="_line1457" class="line">1457             set(imgPanel, <span class="string">'ComponentResizedCallback'</span>,{@<a href="#_sub23" class="code" title="subresizeImg">resizeImg</a>, hAx}, <span class="string">'UserData'</span>,lowerPanel);
</div><div id="_line1458" class="line">1458             imgPanel.getGraphics.drawImage(jImg, 0, 0, []);
</div><div id="_line1459" class="line">1459         <span class="keyword">catch</span>
</div><div id="_line1460" class="line">1460             <span class="comment">% Never mind...</span>
</div><div id="_line1461" class="line">1461         <span class="keyword">end</span>
</div><div id="_line1462" class="line">1462 <span class="comment">%}</span>
</div><div id="_line1463" class="line">1463         <span class="comment">% If all handles were selected (i.e., none were filtered) then only select the first</span>
</div><div id="_line1464" class="line">1464         <span class="keyword">if</span> (length(selectedIdx) == length(allHandles)) &amp;&amp; ~isempty(selectedIdx)
</div><div id="_line1465" class="line">1465             selectedIdx = 1;
</div><div id="_line1466" class="line">1466         <span class="keyword">end</span>
</div><div id="_line1467" class="line">1467 
</div><div id="_line1468" class="line">1468         <span class="comment">% Store handles for callback use</span>
</div><div id="_line1469" class="line">1469         userdata.handles = allHandles;
</div><div id="_line1470" class="line">1470         userdata.levels  = allLevels;
</div><div id="_line1471" class="line">1471         userdata.parents = allParents;
</div><div id="_line1472" class="line">1472         userdata.hg_handles = hg_handles;
</div><div id="_line1473" class="line">1473         userdata.hg_levels  = hg_levels;
</div><div id="_line1474" class="line">1474         userdata.hg_parents = hg_parentIdx;
</div><div id="_line1475" class="line">1475         userdata.initialIdx = selectedIdx;
</div><div id="_line1476" class="line">1476         userdata.userSelected = false;  <span class="comment">% Indicates the user has modified the initial selections</span>
</div><div id="_line1477" class="line">1477         userdata.inInit = true;
</div><div id="_line1478" class="line">1478         userdata.jTree = jTreeObj;
</div><div id="_line1479" class="line">1479         userdata.jTreePeer = tree_h;
</div><div id="_line1480" class="line">1480         userdata.vsplitPane = vsplitPane;
</div><div id="_line1481" class="line">1481         userdata.hsplitPane = hsplitPane;
</div><div id="_line1482" class="line">1482         userdata.classNameLabel = classNameLabel;
</div><div id="_line1483" class="line">1483         userdata.inspectorPane = inspectorPane;
</div><div id="_line1484" class="line">1484         userdata.callbacksTable = callbacksTable;
</div><div id="_line1485" class="line">1485         userdata.jideTableUtils = jideTableUtils;
</div><div id="_line1486" class="line">1486         <span class="keyword">try</span>
</div><div id="_line1487" class="line">1487             userdata.cbHideStdCbs = jcb;
</div><div id="_line1488" class="line">1488         <span class="keyword">catch</span>
</div><div id="_line1489" class="line">1489             userdata.cbHideStdCbs = [];
</div><div id="_line1490" class="line">1490         <span class="keyword">end</span>
</div><div id="_line1491" class="line">1491 
</div><div id="_line1492" class="line">1492         <span class="comment">% Update userdata for use in callbacks</span>
</div><div id="_line1493" class="line">1493         <span class="keyword">try</span>
</div><div id="_line1494" class="line">1494             set(tree_h,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1495" class="line">1495         <span class="keyword">catch</span>
</div><div id="_line1496" class="line">1496             setappdata(tree_h,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1497" class="line">1497         <span class="keyword">end</span>
</div><div id="_line1498" class="line">1498         <span class="keyword">try</span>
</div><div id="_line1499" class="line">1499             set(callbacksTable,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1500" class="line">1500         <span class="keyword">catch</span>
</div><div id="_line1501" class="line">1501             setappdata(callbacksTable,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1502" class="line">1502         <span class="keyword">end</span>
</div><div id="_line1503" class="line">1503         set(hTreeFig,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1504" class="line">1504 
</div><div id="_line1505" class="line">1505         <span class="comment">% Select the root node if requested</span>
</div><div id="_line1506" class="line">1506         <span class="comment">% Note: we must do so here since all other nodes except the root are processed by expandNode</span>
</div><div id="_line1507" class="line">1507         <span class="keyword">if</span> any(selectedIdx==1)
</div><div id="_line1508" class="line">1508             tree_h.setSelectedNode(root);
</div><div id="_line1509" class="line">1509         <span class="keyword">end</span>
</div><div id="_line1510" class="line">1510 
</div><div id="_line1511" class="line">1511         <span class="comment">% Set the initial cbHideStdCbs state</span>
</div><div id="_line1512" class="line">1512         <span class="keyword">try</span>
</div><div id="_line1513" class="line">1513             <span class="keyword">if</span> jcb.isSelected
</div><div id="_line1514" class="line">1514                 drawnow;
</div><div id="_line1515" class="line">1515                 evd.getSource.isSelected = jcb.isSelected;
</div><div id="_line1516" class="line">1516                 <a href="#_sub38" class="code" title="subcbHideStdCbs_Callback">cbHideStdCbs_Callback</a>(jcb,evd,callbacksTable);
</div><div id="_line1517" class="line">1517             <span class="keyword">end</span>
</div><div id="_line1518" class="line">1518         <span class="keyword">catch</span>
</div><div id="_line1519" class="line">1519             <span class="comment">% never mind...</span>
</div><div id="_line1520" class="line">1520         <span class="keyword">end</span>
</div><div id="_line1521" class="line">1521 
</div><div id="_line1522" class="line">1522         <span class="comment">% Set the callback functions</span>
</div><div id="_line1523" class="line">1523         tree_hh = handle(tree_h,<span class="string">'CallbackProperties'</span>);
</div><div id="_line1524" class="line">1524         set(tree_hh, <span class="string">'NodeExpandedCallback'</span>, {@<a href="#_sub33" class="code" title="subnodeExpanded">nodeExpanded</a>, tree_h});
</div><div id="_line1525" class="line">1525         set(tree_hh, <span class="string">'NodeSelectedCallback'</span>, {@<a href="#_sub29" class="code" title="subnodeSelected">nodeSelected</a>, tree_h});
</div><div id="_line1526" class="line">1526 
</div><div id="_line1527" class="line">1527         <span class="comment">% Set the tree mouse-click callback</span>
</div><div id="_line1528" class="line">1528         <span class="comment">% Note: default actions (expand/collapse) will still be performed?</span>
</div><div id="_line1529" class="line">1529         <span class="comment">% Note: MousePressedCallback is better than MouseClickedCallback</span>
</div><div id="_line1530" class="line">1530         <span class="comment">%       since it fires immediately when mouse button is pressed,</span>
</div><div id="_line1531" class="line">1531         <span class="comment">%       without waiting for its release, as MouseClickedCallback does</span>
</div><div id="_line1532" class="line">1532         handleTree = tree_h.getScrollPane;
</div><div id="_line1533" class="line">1533         jTreeObj = handleTree.getViewport.getComponent(0);
</div><div id="_line1534" class="line">1534         jTreeObjh = handle(jTreeObj,<span class="string">'CallbackProperties'</span>);
</div><div id="_line1535" class="line">1535         set(jTreeObjh, <span class="string">'MousePressedCallback'</span>, {@<a href="#_sub54" class="code" title="subtreeMousePressedCallback">treeMousePressedCallback</a>,tree_h});  <span class="comment">% context (right-click) menu</span>
</div><div id="_line1536" class="line">1536         set(jTreeObjh, <span class="string">'MouseMovedCallback'</span>,   @<a href="#_sub57" class="code" title="subtreeMouseMovedCallback">treeMouseMovedCallback</a>);    <span class="comment">% mouse hover tooltips</span>
</div><div id="_line1537" class="line">1537 
</div><div id="_line1538" class="line">1538         <span class="comment">% Update userdata</span>
</div><div id="_line1539" class="line">1539         userdata.inInit = false;
</div><div id="_line1540" class="line">1540         <span class="keyword">try</span>
</div><div id="_line1541" class="line">1541             set(tree_h,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1542" class="line">1542         <span class="keyword">catch</span>
</div><div id="_line1543" class="line">1543             setappdata(tree_h,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1544" class="line">1544         <span class="keyword">end</span>
</div><div id="_line1545" class="line">1545         set(hTreeFig,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1546" class="line">1546 
</div><div id="_line1547" class="line">1547         <span class="comment">% Pre-expand all rows</span>
</div><div id="_line1548" class="line">1548         <span class="comment">%treePane.setVisible(false);</span>
</div><div id="_line1549" class="line">1549         <a href="#_sub26" class="code" title="subexpandNode">expandNode</a>(progressBar, jTreeObj, tree_h, root, 0);
</div><div id="_line1550" class="line">1550         <span class="comment">%treePane.setVisible(true);</span>
</div><div id="_line1551" class="line">1551         <span class="comment">%jTreeObj.setVisible(1);</span>
</div><div id="_line1552" class="line">1552 
</div><div id="_line1553" class="line">1553         <span class="comment">% Hide the progressbar now that we've finished expanding all rows</span>
</div><div id="_line1554" class="line">1554         <span class="keyword">try</span>
</div><div id="_line1555" class="line">1555             hsplitPane.getLeftComponent.setTopComponent(treePane);
</div><div id="_line1556" class="line">1556         <span class="keyword">catch</span>
</div><div id="_line1557" class="line">1557             <span class="comment">% Probably not a vSplitPane on the left...</span>
</div><div id="_line1558" class="line">1558             hsplitPane.setLeftComponent(treePane);
</div><div id="_line1559" class="line">1559         <span class="keyword">end</span>
</div><div id="_line1560" class="line">1560         hsplitPane.setDividerLocation(hsplitPaneLocation);  <span class="comment">% need to do it again...</span>
</div><div id="_line1561" class="line">1561 
</div><div id="_line1562" class="line">1562         <span class="comment">% Set keyboard focus on the tree</span>
</div><div id="_line1563" class="line">1563         jTreeObj.requestFocus;
</div><div id="_line1564" class="line">1564         drawnow;
</div><div id="_line1565" class="line">1565 
</div><div id="_line1566" class="line">1566         <span class="comment">% Check for a newer version (only in non-deployed mode, and only twice a day)</span>
</div><div id="_line1567" class="line">1567         <span class="keyword">if</span> ~isdeployed &amp;&amp; now-lastVersionCheck &gt; 0.5
</div><div id="_line1568" class="line">1568             <a href="#_sub45" class="code" title="subcheckVersion">checkVersion</a>();
</div><div id="_line1569" class="line">1569             lastVersionCheck = now;
</div><div id="_line1570" class="line">1570         <span class="keyword">end</span>
</div><div id="_line1571" class="line">1571 
</div><div id="_line1572" class="line">1572         <span class="comment">% Reset the last error</span>
</div><div id="_line1573" class="line">1573         lasterr(<span class="string">''</span>);  <span class="comment">%#ok</span>
</div><div id="_line1574" class="line">1574     <span class="keyword">end</span>
</div><div id="_line1575" class="line">1575 
</div><div id="_line1576" class="line">1576     <span class="comment">%% Rresize image pane</span>
</div><div id="_line1577" class="line">1577     <a name="_sub23" href="#_subfunctions" class="code">function resizeImg(varargin)  </a><span class="comment">%#ok - unused (TODO: waiting for img placement fix...)</span>
</div><div id="_line1578" class="line">1578         <span class="keyword">try</span>
</div><div id="_line1579" class="line">1579             hPanel = varargin{1};
</div><div id="_line1580" class="line">1580             hAx    = varargin{3};
</div><div id="_line1581" class="line">1581             lowerPanel = get(hPanel,<span class="string">'UserData'</span>);
</div><div id="_line1582" class="line">1582             newJPos = cell2mat(get(hPanel,{<span class="string">'X'</span>,<span class="string">'Y'</span>,<span class="string">'Width'</span>,<span class="string">'Height'</span>}));
</div><div id="_line1583" class="line">1583             newMPos = [1,get(lowerPanel,<span class="string">'Height'</span>),newJPos(3:4)];
</div><div id="_line1584" class="line">1584             set(hAx, <span class="string">'units'</span>,<span class="string">'pixels'</span>, <span class="string">'position'</span>,newMPos, <span class="string">'Visible'</span>,<span class="string">'on'</span>);
</div><div id="_line1585" class="line">1585             uistack(hAx,<span class="string">'top'</span>);  <span class="comment">% no good...</span>
</div><div id="_line1586" class="line">1586             set(hPanel,<span class="string">'Opaque'</span>,<span class="string">'off'</span>);  <span class="comment">% also no good...</span>
</div><div id="_line1587" class="line">1587         <span class="keyword">catch</span>
</div><div id="_line1588" class="line">1588             <span class="comment">% Never mind...</span>
</div><div id="_line1589" class="line">1589             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line1590" class="line">1590         <span class="keyword">end</span>
</div><div id="_line1591" class="line">1591         <span class="keyword">return</span>;
</div><div id="_line1592" class="line">1592     <span class="keyword">end</span>
</div><div id="_line1593" class="line">1593 
</div><div id="_line1594" class="line">1594     <span class="comment">%% &quot;dbstop if error&quot; causes inspect.m to croak due to a bug - so workaround by temporarily disabling this dbstop</span>
</div><div id="_line1595" class="line">1595     <a name="_sub24" href="#_subfunctions" class="code">function identifiers = disableDbstopError</a>
</div><div id="_line1596" class="line">1596         dbStat = dbstatus;
</div><div id="_line1597" class="line">1597         idx = find(strcmp({dbStat.cond},<span class="string">'error'</span>));
</div><div id="_line1598" class="line">1598         identifiers = [dbStat(idx).identifier];
</div><div id="_line1599" class="line">1599         <span class="keyword">if</span> ~isempty(idx)
</div><div id="_line1600" class="line">1600             dbclear <span class="keyword">if</span> error;
</div><div id="_line1601" class="line">1601             msgbox(<span class="string">'''dbstop if error'' had to be disabled due to a Matlab bug that would have caused Matlab to crash.'</span>, <span class="string">'FindJObj'</span>, <span class="string">'warn'</span>);
</div><div id="_line1602" class="line">1602         <span class="keyword">end</span>
</div><div id="_line1603" class="line">1603     <span class="keyword">end</span>
</div><div id="_line1604" class="line">1604 
</div><div id="_line1605" class="line">1605     <span class="comment">%% Restore any previous &quot;dbstop if error&quot;</span>
</div><div id="_line1606" class="line">1606     <a name="_sub25" href="#_subfunctions" class="code">function restoreDbstopError(identifiers)  </a><span class="comment">%#ok</span>
</div><div id="_line1607" class="line">1607         <span class="keyword">for</span> itemIdx = 1 : length(identifiers)
</div><div id="_line1608" class="line">1608             eval([<span class="string">'dbstop if error '</span> identifiers{itemIdx}]);
</div><div id="_line1609" class="line">1609         <span class="keyword">end</span>
</div><div id="_line1610" class="line">1610     <span class="keyword">end</span>
</div><div id="_line1611" class="line">1611 
</div><div id="_line1612" class="line">1612     <span class="comment">%% Recursively expand all nodes (except toolbar/menubar) in startup</span>
</div><div id="_line1613" class="line">1613     <a name="_sub26" href="#_subfunctions" class="code">function expandNode(progressBar, tree, tree_h, parentNode, parentRow)</a>
</div><div id="_line1614" class="line">1614         <span class="keyword">try</span>
</div><div id="_line1615" class="line">1615             <span class="keyword">if</span> nargin &lt; 5
</div><div id="_line1616" class="line">1616                 parentPath = javax.swing.tree.TreePath(parentNode.getPath);
</div><div id="_line1617" class="line">1617                 parentRow = tree.getRowForPath(parentPath);
</div><div id="_line1618" class="line">1618             <span class="keyword">end</span>
</div><div id="_line1619" class="line">1619             tree.expandRow(parentRow);
</div><div id="_line1620" class="line">1620             progressBar.setValue(progressBar.getValue+1);
</div><div id="_line1621" class="line">1621             numChildren = parentNode.getChildCount;
</div><div id="_line1622" class="line">1622             <span class="keyword">if</span> (numChildren == 0)
</div><div id="_line1623" class="line">1623                 pause(0.0002);  <span class="comment">% as short as possible...</span>
</div><div id="_line1624" class="line">1624                 drawnow;
</div><div id="_line1625" class="line">1625             <span class="keyword">end</span>
</div><div id="_line1626" class="line">1626             nodesToUnExpand = {<span class="string">'FigureMenuBar'</span>,<span class="string">'MLMenuBar'</span>,<span class="string">'MJToolBar'</span>,<span class="string">'Box'</span>,<span class="string">'uimenu'</span>,<span class="string">'uitoolbar'</span>,<span class="string">'ScrollBar'</span>};
</div><div id="_line1627" class="line">1627             numChildren = parentNode.getChildCount;
</div><div id="_line1628" class="line">1628             <span class="keyword">for</span> childIdx = 0 : numChildren-1
</div><div id="_line1629" class="line">1629                 childNode = parentNode.getChildAt(childIdx);
</div><div id="_line1630" class="line">1630 
</div><div id="_line1631" class="line">1631                 <span class="comment">% Pre-select the node based upon the user's FINDJOBJ filters</span>
</div><div id="_line1632" class="line">1632                 <span class="keyword">try</span>
</div><div id="_line1633" class="line">1633                     nodedata = get(childNode, <span class="string">'userdata'</span>);
</div><div id="_line1634" class="line">1634                     <span class="keyword">try</span>
</div><div id="_line1635" class="line">1635                         userdata = get(tree_h, <span class="string">'userdata'</span>);
</div><div id="_line1636" class="line">1636                     <span class="keyword">catch</span>
</div><div id="_line1637" class="line">1637                         userdata = getappdata(tree_h, <span class="string">'userdata'</span>);
</div><div id="_line1638" class="line">1638                     <span class="keyword">end</span>
</div><div id="_line1639" class="line">1639                     <span class="comment">%fprintf('%d - %s\n',nodedata.idx,char(nodedata.obj))</span>
</div><div id="_line1640" class="line">1640                     <span class="keyword">if</span> ~ishghandle(nodedata.obj) &amp;&amp; ~userdata.userSelected &amp;&amp; any(userdata.initialIdx == nodedata.idx)
</div><div id="_line1641" class="line">1641                         pause(0.0002);  <span class="comment">% as short as possible...</span>
</div><div id="_line1642" class="line">1642                         drawnow;
</div><div id="_line1643" class="line">1643                         <span class="keyword">if</span> isempty(tree_h.getSelectedNodes)
</div><div id="_line1644" class="line">1644                             tree_h.setSelectedNode(childNode);
</div><div id="_line1645" class="line">1645                         <span class="keyword">else</span>
</div><div id="_line1646" class="line">1646                             newSelectedNodes = [tree_h.getSelectedNodes, childNode];
</div><div id="_line1647" class="line">1647                             tree_h.setSelectedNodes(newSelectedNodes);
</div><div id="_line1648" class="line">1648                         <span class="keyword">end</span>
</div><div id="_line1649" class="line">1649                     <span class="keyword">end</span>
</div><div id="_line1650" class="line">1650                 <span class="keyword">catch</span>
</div><div id="_line1651" class="line">1651                     <span class="comment">% never mind...</span>
</div><div id="_line1652" class="line">1652                     <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line1653" class="line">1653                 <span class="keyword">end</span>
</div><div id="_line1654" class="line">1654 
</div><div id="_line1655" class="line">1655                 <span class="comment">% Expand child node if not leaf &amp; not toolbar/menubar</span>
</div><div id="_line1656" class="line">1656                 <span class="keyword">if</span> childNode.isLeafNode
</div><div id="_line1657" class="line">1657 
</div><div id="_line1658" class="line">1658                     <span class="comment">% This is a leaf node, so simply update the progress-bar</span>
</div><div id="_line1659" class="line">1659                     progressBar.setValue(progressBar.getValue+1);
</div><div id="_line1660" class="line">1660 
</div><div id="_line1661" class="line">1661                 <span class="keyword">else</span>
</div><div id="_line1662" class="line">1662                     <span class="comment">% Expand all non-leaves</span>
</div><div id="_line1663" class="line">1663                     <a href="#_sub26" class="code" title="subexpandNode">expandNode</a>(progressBar, tree, tree_h, childNode);
</div><div id="_line1664" class="line">1664 
</div><div id="_line1665" class="line">1665                     <span class="comment">% Re-collapse toolbar/menubar etc., and also invisible containers</span>
</div><div id="_line1666" class="line">1666                     <span class="comment">% Note: if we simply did nothing, progressbar would not have been updated...</span>
</div><div id="_line1667" class="line">1667                     <span class="keyword">try</span>
</div><div id="_line1668" class="line">1668                         childHandle = getappdata(childNode,<span class="string">'childHandle'</span>);  <span class="comment">%=childNode.getUserObject</span>
</div><div id="_line1669" class="line">1669                         visible = childHandle.isVisible;
</div><div id="_line1670" class="line">1670                     <span class="keyword">catch</span>
</div><div id="_line1671" class="line">1671                         visible = 1;
</div><div id="_line1672" class="line">1672                     <span class="keyword">end</span>
</div><div id="_line1673" class="line">1673                     visible = visible &amp;&amp; isempty(findstr(get(childNode,<span class="string">'Name'</span>),<span class="string">'color=&quot;gray&quot;'</span>));
</div><div id="_line1674" class="line">1674                     <span class="comment">%if any(strcmp(childNode.getName,nodesToUnExpand))</span>
</div><div id="_line1675" class="line">1675                     <span class="comment">%name = char(childNode.getName);</span>
</div><div id="_line1676" class="line">1676                     <span class="keyword">if</span> any(cellfun(@(s)~isempty(strmatch(s,char(childNode.getName))),nodesToUnExpand)) || ~visible
</div><div id="_line1677" class="line">1677                         childPath = javax.swing.tree.TreePath(childNode.getPath);
</div><div id="_line1678" class="line">1678                         childRow = tree.getRowForPath(childPath);
</div><div id="_line1679" class="line">1679                         tree.collapseRow(childRow);
</div><div id="_line1680" class="line">1680                     <span class="keyword">end</span>
</div><div id="_line1681" class="line">1681                 <span class="keyword">end</span>
</div><div id="_line1682" class="line">1682             <span class="keyword">end</span>
</div><div id="_line1683" class="line">1683         <span class="keyword">catch</span>
</div><div id="_line1684" class="line">1684             <span class="comment">% never mind...</span>
</div><div id="_line1685" class="line">1685             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line1686" class="line">1686         <span class="keyword">end</span>
</div><div id="_line1687" class="line">1687     <span class="keyword">end</span>
</div><div id="_line1688" class="line">1688 
</div><div id="_line1689" class="line">1689     <span class="comment">%% Create utility buttons</span>
</div><div id="_line1690" class="line">1690     <a name="_sub27" href="#_subfunctions" class="code">function hButton = createJButton(nameStr, handler, toolTipText)</a>
</div><div id="_line1691" class="line">1691         <span class="keyword">try</span>
</div><div id="_line1692" class="line">1692             jButton = javax.swing.JButton([<span class="string">'&lt;html&gt;&lt;body&gt;&lt;center&gt;'</span> nameStr]);
</div><div id="_line1693" class="line">1693             jButton.setCursor(java.awt.Cursor.getPredefinedCursor(java.awt.Cursor.HAND_CURSOR));
</div><div id="_line1694" class="line">1694             jButton.setToolTipText(toolTipText);
</div><div id="_line1695" class="line">1695             <span class="keyword">try</span>
</div><div id="_line1696" class="line">1696                 minSize = jButton.getMinimumSize;
</div><div id="_line1697" class="line">1697             <span class="keyword">catch</span>
</div><div id="_line1698" class="line">1698                 minSize = jButton.getMinimumSize;  <span class="comment">% for HG2 - strange indeed that this is needed!</span>
</div><div id="_line1699" class="line">1699             <span class="keyword">end</span>
</div><div id="_line1700" class="line">1700             jButton.setMinimumSize(java.awt.Dimension(minSize.getWidth,35));
</div><div id="_line1701" class="line">1701             hButton = handle(jButton,<span class="string">'CallbackProperties'</span>);
</div><div id="_line1702" class="line">1702             set(hButton,<span class="string">'ActionPerformedCallback'</span>,handler);
</div><div id="_line1703" class="line">1703         <span class="keyword">catch</span>
</div><div id="_line1704" class="line">1704             <span class="comment">% Never mind...</span>
</div><div id="_line1705" class="line">1705             a= 1;
</div><div id="_line1706" class="line">1706         <span class="keyword">end</span>
</div><div id="_line1707" class="line">1707     <span class="keyword">end</span>
</div><div id="_line1708" class="line">1708 
</div><div id="_line1709" class="line">1709     <span class="comment">%% Flash a component off/on for the specified duration</span>
</div><div id="_line1710" class="line">1710     <span class="comment">% note: starts with 'on'; if numTimes is odd then ends with 'on', otherwise with 'off'</span>
</div><div id="_line1711" class="line">1711     <a name="_sub28" href="#_subfunctions" class="code">function flashComponent(jComps,delaySecs,numTimes)</a>
</div><div id="_line1712" class="line">1712         <span class="keyword">persistent</span> redBorder redBorderPanels
</div><div id="_line1713" class="line">1713         <span class="keyword">try</span>
</div><div id="_line1714" class="line">1714             <span class="comment">% Handle callback data from right-click (context-menu)</span>
</div><div id="_line1715" class="line">1715             <span class="keyword">if</span> iscell(numTimes)
</div><div id="_line1716" class="line">1716                 [jComps,delaySecs,numTimes] = deal(numTimes{:});
</div><div id="_line1717" class="line">1717             <span class="keyword">end</span>
</div><div id="_line1718" class="line">1718 
</div><div id="_line1719" class="line">1719             <span class="keyword">if</span> isempty(redBorder)  <span class="comment">% reuse if possible</span>
</div><div id="_line1720" class="line">1720                 redBorder = javax.swing.border.LineBorder(java.awt.Color.red,2,0);
</div><div id="_line1721" class="line">1721             <span class="keyword">end</span>
</div><div id="_line1722" class="line">1722             <span class="keyword">for</span> compIdx = 1 : length(jComps)
</div><div id="_line1723" class="line">1723                 <span class="keyword">try</span>
</div><div id="_line1724" class="line">1724                     oldBorder{compIdx} = jComps(compIdx).getBorder;  <span class="comment">%#ok grow</span>
</div><div id="_line1725" class="line">1725                 <span class="keyword">catch</span>
</div><div id="_line1726" class="line">1726                     oldBorder{compIdx} = [];  <span class="comment">%#ok grow</span>
</div><div id="_line1727" class="line">1727                 <span class="keyword">end</span>
</div><div id="_line1728" class="line">1728                 isSettable(compIdx) = ismethod(jComps(compIdx),<span class="string">'setBorder'</span>);  <span class="comment">%#ok grow</span>
</div><div id="_line1729" class="line">1729                 <span class="keyword">if</span> isSettable(compIdx)
</div><div id="_line1730" class="line">1730                     <span class="keyword">try</span>
</div><div id="_line1731" class="line">1731                         <span class="comment">% some components prevent border modification:</span>
</div><div id="_line1732" class="line">1732                         oldBorderFlag = jComps(compIdx).isBorderPainted;
</div><div id="_line1733" class="line">1733                         <span class="keyword">if</span> ~oldBorderFlag
</div><div id="_line1734" class="line">1734                             jComps(compIdx).setBorderPainted(1);
</div><div id="_line1735" class="line">1735                             isSettable(compIdx) = jComps(compIdx).isBorderPainted;  <span class="comment">%#ok grow</span>
</div><div id="_line1736" class="line">1736                             jComps(compIdx).setBorderPainted(oldBorderFlag);
</div><div id="_line1737" class="line">1737                         <span class="keyword">end</span>
</div><div id="_line1738" class="line">1738                     <span class="keyword">catch</span>
</div><div id="_line1739" class="line">1739                         <span class="comment">% do nothing...</span>
</div><div id="_line1740" class="line">1740                     <span class="keyword">end</span>
</div><div id="_line1741" class="line">1741                 <span class="keyword">end</span>
</div><div id="_line1742" class="line">1742                 <span class="keyword">if</span> compIdx &gt; length(redBorderPanels)
</div><div id="_line1743" class="line">1743                     redBorderPanels{compIdx} = javax.swing.JPanel;
</div><div id="_line1744" class="line">1744                     redBorderPanels{compIdx}.setBorder(redBorder);
</div><div id="_line1745" class="line">1745                     redBorderPanels{compIdx}.setOpaque(0);  <span class="comment">% transparent interior, red border</span>
</div><div id="_line1746" class="line">1746                 <span class="keyword">end</span>
</div><div id="_line1747" class="line">1747                 <span class="keyword">try</span>
</div><div id="_line1748" class="line">1748                     redBorderPanels{compIdx}.setBounds(jComps(compIdx).getBounds);
</div><div id="_line1749" class="line">1749                 <span class="keyword">catch</span>
</div><div id="_line1750" class="line">1750                     <span class="comment">% never mind - might be an HG handle</span>
</div><div id="_line1751" class="line">1751                 <span class="keyword">end</span>
</div><div id="_line1752" class="line">1752             <span class="keyword">end</span>
</div><div id="_line1753" class="line">1753             <span class="keyword">for</span> idx = 1 : 2*numTimes
</div><div id="_line1754" class="line">1754                 <span class="keyword">if</span> idx&gt;1,  pause(delaySecs);  <span class="keyword">end</span>  <span class="comment">% don't pause at start</span>
</div><div id="_line1755" class="line">1755                 visible = mod(idx,2);
</div><div id="_line1756" class="line">1756                 <span class="keyword">for</span> compIdx = 1 : length(jComps)
</div><div id="_line1757" class="line">1757                     <span class="keyword">try</span>
</div><div id="_line1758" class="line">1758                         jComp = jComps(compIdx);
</div><div id="_line1759" class="line">1759 
</div><div id="_line1760" class="line">1760                         <span class="comment">% Prevent Matlab crash (java buffer overflow...)</span>
</div><div id="_line1761" class="line">1761                         <span class="keyword">if</span> jComp.isa(<span class="string">'com.mathworks.mwswing.desk.DTSplitPane'</span>) || <span class="keyword">...</span>
</div><div id="_line1762" class="line">1762                            jComp.isa(<span class="string">'com.mathworks.mwswing.MJSplitPane'</span>)
</div><div id="_line1763" class="line">1763                             <span class="keyword">continue</span>;
</div><div id="_line1764" class="line">1764                         <span class="keyword">end</span>
</div><div id="_line1765" class="line">1765 
</div><div id="_line1766" class="line">1766                         <span class="comment">% HG handles are highlighted by setting their 'Selected' property</span>
</div><div id="_line1767" class="line">1767                         <span class="keyword">if</span> isa(jComp,<span class="string">'uimenu'</span>)
</div><div id="_line1768" class="line">1768                             <span class="keyword">if</span> visible
</div><div id="_line1769" class="line">1769                                 oldColor = get(jComp,<span class="string">'ForegroundColor'</span>);
</div><div id="_line1770" class="line">1770                                 setappdata(jComp,<span class="string">'findjobj_oldColor'</span>,oldColor);
</div><div id="_line1771" class="line">1771                                 set(jComp,<span class="string">'ForegroundColor'</span>,<span class="string">'red'</span>);
</div><div id="_line1772" class="line">1772                             <span class="keyword">else</span>
</div><div id="_line1773" class="line">1773                                 oldColor = getappdata(jComp,<span class="string">'findjobj_oldColor'</span>);
</div><div id="_line1774" class="line">1774                                 set(jComp,<span class="string">'ForegroundColor'</span>,oldColor);
</div><div id="_line1775" class="line">1775                                 rmappdata(jComp,<span class="string">'ForegroundColor'</span>);
</div><div id="_line1776" class="line">1776                             <span class="keyword">end</span>
</div><div id="_line1777" class="line">1777                             
</div><div id="_line1778" class="line">1778                         <span class="keyword">elseif</span> ishghandle(jComp)
</div><div id="_line1779" class="line">1779                             <span class="keyword">if</span> visible
</div><div id="_line1780" class="line">1780                                 set(jComp,<span class="string">'Selected'</span>,<span class="string">'on'</span>);
</div><div id="_line1781" class="line">1781                             <span class="keyword">else</span>
</div><div id="_line1782" class="line">1782                                 set(jComp,<span class="string">'Selected'</span>,<span class="string">'off'</span>);
</div><div id="_line1783" class="line">1783                             <span class="keyword">end</span>
</div><div id="_line1784" class="line">1784 
</div><div id="_line1785" class="line">1785                         <span class="keyword">else</span> <span class="comment">%if isjava(jComp)</span>
</div><div id="_line1786" class="line">1786 
</div><div id="_line1787" class="line">1787                             jParent = jComps(compIdx).getParent;
</div><div id="_line1788" class="line">1788 
</div><div id="_line1789" class="line">1789                             <span class="comment">% Most Java components allow modifying their borders</span>
</div><div id="_line1790" class="line">1790                             <span class="keyword">if</span> isSettable(compIdx)
</div><div id="_line1791" class="line">1791                                 <span class="keyword">if</span> visible
</div><div id="_line1792" class="line">1792                                     jComp.setBorder(redBorder);
</div><div id="_line1793" class="line">1793                                     <span class="keyword">try</span> jComp.setBorderPainted(1); <span class="keyword">catch</span>, <span class="keyword">end</span>  <span class="comment">%#ok</span>
</div><div id="_line1794" class="line">1794                                 <span class="keyword">else</span> <span class="comment">%if ~isempty(oldBorder{compIdx})</span>
</div><div id="_line1795" class="line">1795                                     jComp.setBorder(oldBorder{compIdx});
</div><div id="_line1796" class="line">1796                                 <span class="keyword">end</span>
</div><div id="_line1797" class="line">1797                                 jComp.repaint;
</div><div id="_line1798" class="line">1798 
</div><div id="_line1799" class="line">1799                             <span class="comment">% The other Java components are highlighted by a transparent red-border</span>
</div><div id="_line1800" class="line">1800                             <span class="comment">% panel that is placed on top of them in their parent's space</span>
</div><div id="_line1801" class="line">1801                             <span class="keyword">elseif</span> ~isempty(jParent)
</div><div id="_line1802" class="line">1802                                 <span class="keyword">if</span> visible
</div><div id="_line1803" class="line">1803                                     jParent.add(redBorderPanels{compIdx});
</div><div id="_line1804" class="line">1804                                     jParent.setComponentZOrder(redBorderPanels{compIdx},0);
</div><div id="_line1805" class="line">1805                                 <span class="keyword">else</span>
</div><div id="_line1806" class="line">1806                                     jParent.remove(redBorderPanels{compIdx});
</div><div id="_line1807" class="line">1807                                 <span class="keyword">end</span>
</div><div id="_line1808" class="line">1808                                 jParent.repaint
</div><div id="_line1809" class="line">1809                             <span class="keyword">end</span>
</div><div id="_line1810" class="line">1810                         <span class="keyword">end</span>
</div><div id="_line1811" class="line">1811                     <span class="keyword">catch</span>
</div><div id="_line1812" class="line">1812                         <span class="comment">% never mind - try the next component (if any)</span>
</div><div id="_line1813" class="line">1813                     <span class="keyword">end</span>
</div><div id="_line1814" class="line">1814                 <span class="keyword">end</span>
</div><div id="_line1815" class="line">1815                 drawnow;
</div><div id="_line1816" class="line">1816             <span class="keyword">end</span>
</div><div id="_line1817" class="line">1817         <span class="keyword">catch</span>
</div><div id="_line1818" class="line">1818             <span class="comment">% never mind...</span>
</div><div id="_line1819" class="line">1819             <a href="#_sub51" class="code" title="subdispError">dispError</a>;
</div><div id="_line1820" class="line">1820         <span class="keyword">end</span>
</div><div id="_line1821" class="line">1821         <span class="keyword">return</span>;  <span class="comment">% debug point</span>
</div><div id="_line1822" class="line">1822     <span class="keyword">end</span>  <span class="comment">% flashComponent</span>
</div><div id="_line1823" class="line">1823 
</div><div id="_line1824" class="line">1824     <span class="comment">%% Select tree node</span>
</div><div id="_line1825" class="line">1825     <a name="_sub29" href="#_subfunctions" class="code">function nodeSelected(src, evd, tree)  </a><span class="comment">%#ok</span>
</div><div id="_line1826" class="line">1826         <span class="keyword">try</span>
</div><div id="_line1827" class="line">1827             <span class="keyword">if</span> iscell(tree)
</div><div id="_line1828" class="line">1828                 [src,node] = deal(tree{:});
</div><div id="_line1829" class="line">1829             <span class="keyword">else</span>
</div><div id="_line1830" class="line">1830                 node = evd.getCurrentNode;
</div><div id="_line1831" class="line">1831             <span class="keyword">end</span>
</div><div id="_line1832" class="line">1832             <span class="comment">%nodeHandle = node.getUserObject;</span>
</div><div id="_line1833" class="line">1833             nodedata = get(node,<span class="string">'userdata'</span>);
</div><div id="_line1834" class="line">1834             nodeHandle = nodedata.obj;
</div><div id="_line1835" class="line">1835             <span class="keyword">try</span>
</div><div id="_line1836" class="line">1836                 userdata = get(src,<span class="string">'userdata'</span>);
</div><div id="_line1837" class="line">1837             <span class="keyword">catch</span>
</div><div id="_line1838" class="line">1838                 <span class="keyword">try</span>
</div><div id="_line1839" class="line">1839                     userdata = getappdata(java(src),<span class="string">'userdata'</span>);
</div><div id="_line1840" class="line">1840                 <span class="keyword">catch</span>
</div><div id="_line1841" class="line">1841                     userdata = getappdata(src,<span class="string">'userdata'</span>);
</div><div id="_line1842" class="line">1842                 <span class="keyword">end</span>
</div><div id="_line1843" class="line">1843                 <span class="keyword">if</span> isempty(userdata)
</div><div id="_line1844" class="line">1844                     <span class="keyword">try</span> userdata = get(java(src),<span class="string">'userdata'</span>); <span class="keyword">catch</span>, <span class="keyword">end</span>
</div><div id="_line1845" class="line">1845                 <span class="keyword">end</span>
</div><div id="_line1846" class="line">1846             <span class="keyword">end</span>
</div><div id="_line1847" class="line">1847             <span class="keyword">if</span> ~isempty(nodeHandle) &amp;&amp; ~isempty(userdata)
</div><div id="_line1848" class="line">1848                 numSelections  = userdata.jTree.getSelectionCount;
</div><div id="_line1849" class="line">1849                 selectionPaths = userdata.jTree.getSelectionPaths;
</div><div id="_line1850" class="line">1850                 <span class="keyword">if</span> (numSelections == 1)
</div><div id="_line1851" class="line">1851                     <span class="comment">% Indicate that the user has modified the initial selection (except if this was an initial auto-selected node)</span>
</div><div id="_line1852" class="line">1852                     <span class="keyword">if</span> ~userdata.inInit
</div><div id="_line1853" class="line">1853                         userdata.userSelected = true;
</div><div id="_line1854" class="line">1854                         <span class="keyword">try</span>
</div><div id="_line1855" class="line">1855                             set(src,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1856" class="line">1856                         <span class="keyword">catch</span>
</div><div id="_line1857" class="line">1857                             <span class="keyword">try</span>
</div><div id="_line1858" class="line">1858                                 setappdata(java(src),<span class="string">'userdata'</span>,userdata);
</div><div id="_line1859" class="line">1859                             <span class="keyword">catch</span>
</div><div id="_line1860" class="line">1860                                 setappdata(src,<span class="string">'userdata'</span>,userdata);
</div><div id="_line1861" class="line">1861                             <span class="keyword">end</span>
</div><div id="_line1862" class="line">1862                         <span class="keyword">end</span>
</div><div id="_line1863" class="line">1863                     <span class="keyword">end</span>
</div><div id="_line1864" class="line">1864 
</div><div id="_line1865" class="line">1865                     <span class="comment">% Update the fully-qualified class name label</span>
</div><div id="_line1866" class="line">1866                     numInitialIdx = length(userdata.initialIdx);
</div><div id="_line1867" class="line">1867                     thisHandle = nodeHandle;
</div><div id="_line1868" class="line">1868                     <span class="keyword">try</span>
</div><div id="_line1869" class="line">1869                         <span class="keyword">if</span> ~ishghandle(thisHandle)
</div><div id="_line1870" class="line">1870                             thisHandle = java(nodeHandle);
</div><div id="_line1871" class="line">1871                         <span class="keyword">end</span>
</div><div id="_line1872" class="line">1872                     <span class="keyword">catch</span>
</div><div id="_line1873" class="line">1873                         <span class="comment">% never mind...</span>
</div><div id="_line1874" class="line">1874                     <span class="keyword">end</span>
</div><div id="_line1875" class="line">1875                     <span class="keyword">if</span> ~userdata.inInit || (numInitialIdx == 1)
</div><div id="_line1876" class="line">1876                         userdata.classNameLabel.setText([<span class="string">'      '</span> char(class(thisHandle))]);
</div><div id="_line1877" class="line">1877                     <span class="keyword">else</span>
</div><div id="_line1878" class="line">1878                         userdata.classNameLabel.setText([<span class="string">' '</span> num2str(numInitialIdx) <span class="string">'x handles (some handles hidden by unexpanded tree nodes)'</span>]);
</div><div id="_line1879" class="line">1879                     <span class="keyword">end</span>
</div><div id="_line1880" class="line">1880                     <span class="keyword">if</span> ishghandle(thisHandle)
</div><div id="_line1881" class="line">1881                         userdata.classNameLabel.setText(userdata.classNameLabel.getText.concat(<span class="string">' (HG handle)'</span>));
</div><div id="_line1882" class="line">1882                     <span class="keyword">end</span>
</div><div id="_line1883" class="line">1883                     userdata.inspectorPane.dispose;  <span class="comment">% remove props listeners - doesn't work...</span>
</div><div id="_line1884" class="line">1884                     <a href="#_sub32" class="code" title="subupdateNodeTooltip">updateNodeTooltip</a>(nodeHandle, userdata.classNameLabel);
</div><div id="_line1885" class="line">1885 
</div><div id="_line1886" class="line">1886                     <span class="comment">% Update the data properties inspector pane</span>
</div><div id="_line1887" class="line">1887                     <span class="comment">% Note: we can't simply use the evd nodeHandle, because this node might have been DE-selected with only one other node left selected...</span>
</div><div id="_line1888" class="line">1888                     <span class="comment">%nodeHandle = selectionPaths(1).getLastPathComponent.getUserObject;</span>
</div><div id="_line1889" class="line">1889                     nodedata = get(selectionPaths(1).getLastPathComponent,<span class="string">'userdata'</span>);
</div><div id="_line1890" class="line">1890                     nodeHandle = nodedata.obj;
</div><div id="_line1891" class="line">1891                     <span class="comment">%identifiers = disableDbstopError;  % &quot;dbstop if error&quot; causes inspect.m to croak due to a bug - so workaround</span>
</div><div id="_line1892" class="line">1892                     userdata.inspectorPane.setObject(thisHandle);
</div><div id="_line1893" class="line">1893 
</div><div id="_line1894" class="line">1894                     <span class="comment">% Update the callbacks table</span>
</div><div id="_line1895" class="line">1895                     <span class="keyword">try</span>
</div><div id="_line1896" class="line">1896                         stripStdCbsFlag = getappdata(userdata.callbacksTable,<span class="string">'hideStdCbs'</span>);
</div><div id="_line1897" class="line">1897                         [cbData, cbHeaders, cbTableEnabled] = <a href="#_sub19" class="code" title="subgetCbsData">getCbsData</a>(nodeHandle, stripStdCbsFlag);  <span class="comment">%#ok cbTableEnabled unused</span>
</div><div id="_line1898" class="line">1898                         <span class="keyword">try</span>
</div><div id="_line1899" class="line">1899                             <span class="comment">% Use JideTable if available on this system</span>
</div><div id="_line1900" class="line">1900                             list = <a href="#_sub18" class="code" title="subgetTreeData">getTreeData</a>(cbData);  <span class="comment">%#ok</span>
</div><div id="_line1901" class="line">1901                             callbacksTableModel = eval(<span class="string">'com.jidesoft.grid.PropertyTableModel(list);'</span>);  <span class="comment">%#ok prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line1902" class="line">1902                             
</div><div id="_line1903" class="line">1903                             <span class="comment">% Expand if only one category</span>
</div><div id="_line1904" class="line">1904                             <span class="keyword">if</span> length(callbacksTableModel.getCategories)==1
</div><div id="_line1905" class="line">1905                                 callbacksTableModel.expandFirstLevel;
</div><div id="_line1906" class="line">1906                             <span class="keyword">end</span>
</div><div id="_line1907" class="line">1907                         <span class="keyword">catch</span>
</div><div id="_line1908" class="line">1908                             callbacksTableModel = javax.swing.table.DefaultTableModel(cbData,cbHeaders);
</div><div id="_line1909" class="line">1909                         <span class="keyword">end</span>
</div><div id="_line1910" class="line">1910                         set(handle(callbacksTableModel,<span class="string">'CallbackProperties'</span>), <span class="string">'TableChangedCallback'</span>,{@<a href="#_sub47" class="code" title="subtbCallbacksChanged">tbCallbacksChanged</a>,nodeHandle,userdata.callbacksTable});
</div><div id="_line1911" class="line">1911                         <span class="comment">%set(callbacksTableModel, 'UserData',nodeHandle);</span>
</div><div id="_line1912" class="line">1912                         userdata.callbacksTable.setModel(callbacksTableModel)
</div><div id="_line1913" class="line">1913                         userdata.callbacksTable.setRowAutoResizes(true);
</div><div id="_line1914" class="line">1914                         userdata.jideTableUtils.autoResizeAllColumns(userdata.callbacksTable);
</div><div id="_line1915" class="line">1915                     <span class="keyword">catch</span>
</div><div id="_line1916" class="line">1916                         <span class="comment">% never mind...</span>
</div><div id="_line1917" class="line">1917                         <span class="comment">%dispError</span>
</div><div id="_line1918" class="line">1918                     <span class="keyword">end</span>
</div><div id="_line1919" class="line">1919                     pause(0.005);
</div><div id="_line1920" class="line">1920                     drawnow;
</div><div id="_line1921" class="line">1921                     <span class="comment">%restoreDbstopError(identifiers);</span>
</div><div id="_line1922" class="line">1922 
</div><div id="_line1923" class="line">1923                     <span class="comment">% Highlight the selected object (if visible)</span>
</div><div id="_line1924" class="line">1924                     <a href="#_sub28" class="code" title="subflashComponent">flashComponent</a>(nodeHandle,0.2,3);
</div><div id="_line1925" class="line">1925 
</div><div id="_line1926" class="line">1926                 <span class="keyword">elseif</span> (numSelections &gt; 1)  <span class="comment">% Multiple selections</span>
</div><div id="_line1927" class="line">1927 
</div><div id="_line1928" class="line">1928                     <span class="comment">% Get the list of all selected nodes</span>
</div><div id="_line1929" class="line">1929                     jArray = javaArray(<span class="string">'java.lang.Object'</span>, numSelections);
</div><div id="_line1930" class="line">1930                     toolTipStr = <span class="string">'&lt;html&gt;'</span>;
</div><div id="_line1931" class="line">1931                     sameClassFlag = true;
</div><div id="_line1932" class="line">1932                     <span class="keyword">for</span> idx = 1 : numSelections
</div><div id="_line1933" class="line">1933                         <span class="comment">%jArray(idx) = selectionPaths(idx).getLastPathComponent.getUserObject;</span>
</div><div id="_line1934" class="line">1934                         nodedata = get(selectionPaths(idx).getLastPathComponent,<span class="string">'userdata'</span>);
</div><div id="_line1935" class="line">1935                         <span class="keyword">try</span>
</div><div id="_line1936" class="line">1936                             jArray(idx) = java(nodedata.obj);
</div><div id="_line1937" class="line">1937                         <span class="keyword">catch</span>
</div><div id="_line1938" class="line">1938                             jArray(idx) = nodedata.obj;
</div><div id="_line1939" class="line">1939                         <span class="keyword">end</span>
</div><div id="_line1940" class="line">1940                         toolTipStr = [toolTipStr <span class="string">'&amp;nbsp;'</span> class(jArray(idx)) <span class="string">'&amp;nbsp;'</span>];  <span class="comment">%#ok grow</span>
</div><div id="_line1941" class="line">1941                         <span class="keyword">if</span> (idx &lt; numSelections),  toolTipStr = [toolTipStr <span class="string">'&lt;br&gt;'</span>];  <span class="keyword">end</span>  <span class="comment">%#ok grow</span>
</div><div id="_line1942" class="line">1942                         <span class="keyword">if</span> (idx &gt; 1) &amp;&amp; sameClassFlag &amp;&amp; ~isequal(jArray(idx).getClass,jArray(1).getClass)
</div><div id="_line1943" class="line">1943                             sameClassFlag = false;
</div><div id="_line1944" class="line">1944                         <span class="keyword">end</span>
</div><div id="_line1945" class="line">1945                     <span class="keyword">end</span>
</div><div id="_line1946" class="line">1946                     toolTipStr = [toolTipStr <span class="string">'&lt;/html&gt;'</span>];
</div><div id="_line1947" class="line">1947 
</div><div id="_line1948" class="line">1948                     <span class="comment">% Update the fully-qualified class name label</span>
</div><div id="_line1949" class="line">1949                     <span class="keyword">if</span> sameClassFlag
</div><div id="_line1950" class="line">1950                         classNameStr = class(jArray(1));
</div><div id="_line1951" class="line">1951                     <span class="keyword">else</span>
</div><div id="_line1952" class="line">1952                         classNameStr = <span class="string">'handle'</span>;
</div><div id="_line1953" class="line">1953                     <span class="keyword">end</span>
</div><div id="_line1954" class="line">1954                     <span class="keyword">if</span> all(ishghandle(jArray))
</div><div id="_line1955" class="line">1955                         <span class="keyword">if</span> strcmp(classNameStr,<span class="string">'handle'</span>)
</div><div id="_line1956" class="line">1956                             classNameStr = <span class="string">'HG handles'</span>;
</div><div id="_line1957" class="line">1957                         <span class="keyword">else</span>
</div><div id="_line1958" class="line">1958                             classNameStr = [classNameStr <span class="string">' (HG handles)'</span>];
</div><div id="_line1959" class="line">1959                         <span class="keyword">end</span>
</div><div id="_line1960" class="line">1960                     <span class="keyword">end</span>
</div><div id="_line1961" class="line">1961                     classNameStr = [<span class="string">' '</span> num2str(numSelections) <span class="string">'x '</span> classNameStr];
</div><div id="_line1962" class="line">1962                     userdata.classNameLabel.setText(classNameStr);
</div><div id="_line1963" class="line">1963                     userdata.classNameLabel.setToolTipText(toolTipStr);
</div><div id="_line1964" class="line">1964 
</div><div id="_line1965" class="line">1965                     <span class="comment">% Update the data properties inspector pane</span>
</div><div id="_line1966" class="line">1966                     <span class="comment">%identifiers = disableDbstopError;  % &quot;dbstop if error&quot; causes inspect.m to croak due to a bug - so workaround</span>
</div><div id="_line1967" class="line">1967                     userdata.inspectorPane.getRegistry.setSelected(jArray, true);
</div><div id="_line1968" class="line">1968 
</div><div id="_line1969" class="line">1969                     <span class="comment">% Update the callbacks table</span>
</div><div id="_line1970" class="line">1970                     <span class="keyword">try</span>
</div><div id="_line1971" class="line">1971                         <span class="comment">% Get intersecting callback names &amp; values</span>
</div><div id="_line1972" class="line">1972                         stripStdCbsFlag = getappdata(userdata.callbacksTable,<span class="string">'hideStdCbs'</span>);
</div><div id="_line1973" class="line">1973                         [cbData, cbHeaders, cbTableEnabled] = <a href="#_sub19" class="code" title="subgetCbsData">getCbsData</a>(jArray(1), stripStdCbsFlag);  <span class="comment">%#ok cbHeaders &amp; cbTableEnabled unused</span>
</div><div id="_line1974" class="line">1974                         <span class="keyword">if</span> ~isempty(cbData)
</div><div id="_line1975" class="line">1975                             cbNames = cbData(:,1);
</div><div id="_line1976" class="line">1976                             <span class="keyword">for</span> idx = 2 : length(jArray)
</div><div id="_line1977" class="line">1977                                 [cbData2, cbHeaders2] = <a href="#_sub19" class="code" title="subgetCbsData">getCbsData</a>(jArray(idx), stripStdCbsFlag);  <span class="comment">%#ok cbHeaders2 unused</span>
</div><div id="_line1978" class="line">1978                                 <span class="keyword">if</span> ~isempty(cbData2)
</div><div id="_line1979" class="line">1979                                     newCbNames = cbData2(:,1);
</div><div id="_line1980" class="line">1980                                     [cbNames, cbIdx, cb2Idx] = intersect(cbNames,newCbNames);  <span class="comment">%#ok cb2Idx unused</span>
</div><div id="_line1981" class="line">1981                                     cbData = cbData(cbIdx,:);
</div><div id="_line1982" class="line">1982                                     <span class="keyword">for</span> cbIdx = 1 : length(cbNames)
</div><div id="_line1983" class="line">1983                                         newIdx = find(strcmp(cbNames{cbIdx},newCbNames));
</div><div id="_line1984" class="line">1984                                         <span class="keyword">if</span> ~isequal(cbData2{newIdx,2}, cbData{cbIdx,2})
</div><div id="_line1985" class="line">1985                                             cbData{cbIdx,2} = <span class="string">'&lt;different values&gt;'</span>;
</div><div id="_line1986" class="line">1986                                         <span class="keyword">end</span>
</div><div id="_line1987" class="line">1987                                     <span class="keyword">end</span>
</div><div id="_line1988" class="line">1988                                 <span class="keyword">else</span>
</div><div id="_line1989" class="line">1989                                     cbData = cbData([],:);  <span class="comment">%=empty cell array</span>
</div><div id="_line1990" class="line">1990                                 <span class="keyword">end</span>
</div><div id="_line1991" class="line">1991                                 <span class="keyword">if</span> isempty(cbData)
</div><div id="_line1992" class="line">1992                                     <span class="keyword">break</span>;
</div><div id="_line1993" class="line">1993                                 <span class="keyword">end</span>
</div><div id="_line1994" class="line">1994                             <span class="keyword">end</span>
</div><div id="_line1995" class="line">1995                         <span class="keyword">end</span>
</div><div id="_line1996" class="line">1996                         cbHeaders = {<span class="string">'Callback name'</span>,<span class="string">'Callback value'</span>};
</div><div id="_line1997" class="line">1997                         <span class="keyword">try</span>
</div><div id="_line1998" class="line">1998                             <span class="comment">% Use JideTable if available on this system</span>
</div><div id="_line1999" class="line">1999                             list = <a href="#_sub18" class="code" title="subgetTreeData">getTreeData</a>(cbData);  <span class="comment">%#ok</span>
</div><div id="_line2000" class="line">2000                             callbacksTableModel = eval(<span class="string">'com.jidesoft.grid.PropertyTableModel(list);'</span>);  <span class="comment">%#ok prevent JIDE alert by run-time (not load-time) evaluation</span>
</div><div id="_line2001" class="line">2001                             
</div><div id="_line2002" class="line">2002                             <span class="comment">% Expand if only one category</span>
</div><div id="_line2003" class="line">2003                             <span class="keyword">if</span> length(callbacksTableModel.getCategories)==1
</div><div id="_line2004" class="line">2004                                 callbacksTableModel.expandFirstLevel;
</div><div id="_line2005" class="line">2005                             <span class="keyword">end</span>
</div><div id="_line2006" class="line">2006                         <span class="keyword">catch</span>
</div><div id="_line2007" class="line">2007                             callbacksTableModel = javax.swing.table.DefaultTableModel(cbData,cbHeaders);
</div><div id="_line2008" class="line">2008                         <span class="keyword">end</span>
</div><div id="_line2009" class="line">2009                         set(handle(callbacksTableModel,<span class="string">'CallbackProperties'</span>), <span class="string">'TableChangedCallback'</span>,{@<a href="#_sub47" class="code" title="subtbCallbacksChanged">tbCallbacksChanged</a>,jArray,userdata.callbacksTable});
</div><div id="_line2010" class="line">2010                         <span class="comment">%set(callbacksTableModel, 'UserData',jArray);</span>
</div><div id="_line2011" class="line">2011                         userdata.callbacksTable.setModel(callbacksTableModel)
</div><div id="_line2012" class="line">2012                         userdata.callbacksTable.setRowAutoResizes(true);
</div><div id="_line2013" class="line">2013                         userdata.jideTableUtils.autoResizeAllColumns(userdata.callbacksTable);
</div><div id="_line2014" class="line">2014                     <span class="keyword">catch</span>
</div><div id="_line2015" class="line">2015                         <span class="comment">% never mind...</span>
</div><div id="_line2016" class="line">2016                         <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2017" class="line">2017                     <span class="keyword">end</span>
</div><div id="_line2018" class="line">2018 
</div><div id="_line2019" class="line">2019                     pause(0.005);
</div><div id="_line2020" class="line">2020                     drawnow;
</div><div id="_line2021" class="line">2021                     <span class="comment">%restoreDbstopError(identifiers);</span>
</div><div id="_line2022" class="line">2022 
</div><div id="_line2023" class="line">2023                     <span class="comment">% Highlight the selected objects (if visible)</span>
</div><div id="_line2024" class="line">2024                     <a href="#_sub28" class="code" title="subflashComponent">flashComponent</a>(jArray,0.2,3);
</div><div id="_line2025" class="line">2025                 <span class="keyword">end</span>
</div><div id="_line2026" class="line">2026 
</div><div id="_line2027" class="line">2027                 <span class="comment">% TODO: Auto-highlight selected object (?)</span>
</div><div id="_line2028" class="line">2028                 <span class="comment">%nodeHandle.requestFocus;</span>
</div><div id="_line2029" class="line">2029             <span class="keyword">end</span>
</div><div id="_line2030" class="line">2030         <span class="keyword">catch</span>
</div><div id="_line2031" class="line">2031             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2032" class="line">2032         <span class="keyword">end</span>
</div><div id="_line2033" class="line">2033     <span class="keyword">end</span>
</div><div id="_line2034" class="line">2034 
</div><div id="_line2035" class="line">2035     <span class="comment">%% IFF utility function for annonymous cellfun funcs</span>
</div><div id="_line2036" class="line">2036     <a name="_sub30" href="#_subfunctions" class="code">function result = iff(test,trueVal,falseVal)  </a><span class="comment">%#ok</span>
</div><div id="_line2037" class="line">2037         <span class="keyword">try</span>
</div><div id="_line2038" class="line">2038             <span class="keyword">if</span> test
</div><div id="_line2039" class="line">2039                 result = trueVal;
</div><div id="_line2040" class="line">2040             <span class="keyword">else</span>
</div><div id="_line2041" class="line">2041                 result = falseVal;
</div><div id="_line2042" class="line">2042             <span class="keyword">end</span>
</div><div id="_line2043" class="line">2043         <span class="keyword">catch</span>
</div><div id="_line2044" class="line">2044             result = false;
</div><div id="_line2045" class="line">2045         <span class="keyword">end</span>
</div><div id="_line2046" class="line">2046     <span class="keyword">end</span>
</div><div id="_line2047" class="line">2047 
</div><div id="_line2048" class="line">2048     <span class="comment">%% Get an HTML representation of the object's properties</span>
</div><div id="_line2049" class="line">2049     <a name="_sub31" href="#_subfunctions" class="code">function dataFieldsStr = getPropsHtml(nodeHandle, dataFields)</a>
</div><div id="_line2050" class="line">2050         <span class="keyword">try</span>
</div><div id="_line2051" class="line">2051             <span class="comment">% Get a text representation of the fieldnames &amp; values</span>
</div><div id="_line2052" class="line">2052             undefinedStr = <span class="string">''</span>;
</div><div id="_line2053" class="line">2053             hiddenStr = <span class="string">''</span>;
</div><div id="_line2054" class="line">2054             dataFieldsStr = <span class="string">''</span>;  <span class="comment">% just in case the following croaks...</span>
</div><div id="_line2055" class="line">2055             <span class="keyword">if</span> isempty(dataFields)
</div><div id="_line2056" class="line">2056                 <span class="keyword">return</span>;
</div><div id="_line2057" class="line">2057             <span class="keyword">end</span>
</div><div id="_line2058" class="line">2058             dataFieldsStr = evalc(<span class="string">'disp(dataFields)'</span>);
</div><div id="_line2059" class="line">2059             <span class="keyword">if</span> dataFieldsStr(end)==char(10),  dataFieldsStr=dataFieldsStr(1:end-1);  <span class="keyword">end</span>
</div><div id="_line2060" class="line">2060 
</div><div id="_line2061" class="line">2061             <span class="comment">% Strip out callbacks</span>
</div><div id="_line2062" class="line">2062             dataFieldsStr = regexprep(dataFieldsStr,<span class="string">'^\s*\w*Callback(Data)?:[^\n]*$'</span>,<span class="string">''</span>,<span class="string">'lineanchors'</span>);
</div><div id="_line2063" class="line">2063             dataFieldsStr = regexprep(dataFieldsStr,<span class="string">'\n\n'</span>,<span class="string">'\n'</span>);
</div><div id="_line2064" class="line">2064 
</div><div id="_line2065" class="line">2065             <span class="comment">% Convert into a Matlab handle()</span>
</div><div id="_line2066" class="line">2066             <span class="comment">%nodeHandle = handle(nodeHandle);</span>
</div><div id="_line2067" class="line">2067             <span class="keyword">try</span>
</div><div id="_line2068" class="line">2068                 <span class="comment">% ensure this is a Matlab handle, not a java object</span>
</div><div id="_line2069" class="line">2069                 nodeHandle = handle(nodeHandle, <span class="string">'CallbackProperties'</span>);
</div><div id="_line2070" class="line">2070             <span class="keyword">catch</span>
</div><div id="_line2071" class="line">2071                 <span class="keyword">try</span>
</div><div id="_line2072" class="line">2072                     <span class="comment">% HG handles don't allow CallbackProperties...</span>
</div><div id="_line2073" class="line">2073                     nodeHandle = handle(nodeHandle);
</div><div id="_line2074" class="line">2074                 <span class="keyword">catch</span>
</div><div id="_line2075" class="line">2075                     <span class="comment">% Some Matlab class objects simply cannot be converted into a handle()</span>
</div><div id="_line2076" class="line">2076                 <span class="keyword">end</span>
</div><div id="_line2077" class="line">2077             <span class="keyword">end</span>
</div><div id="_line2078" class="line">2078 
</div><div id="_line2079" class="line">2079             <span class="comment">% HTMLize tooltip data</span>
</div><div id="_line2080" class="line">2080             <span class="comment">% First, set the fields' font based on its read-write status</span>
</div><div id="_line2081" class="line">2081             fieldNames = fieldnames(dataFields);
</div><div id="_line2082" class="line">2082             <span class="keyword">for</span> fieldIdx = 1 : length(fieldNames)
</div><div id="_line2083" class="line">2083                 thisFieldName = fieldNames{fieldIdx};
</div><div id="_line2084" class="line">2084                 <span class="comment">%accessFlags = get(findprop(nodeHandle,thisFieldName),'AccessFlags');</span>
</div><div id="_line2085" class="line">2085                 <span class="keyword">try</span>
</div><div id="_line2086" class="line">2086                     hProp = findprop(nodeHandle,thisFieldName);
</div><div id="_line2087" class="line">2087                     accessFlags = get(hProp,<span class="string">'AccessFlags'</span>);
</div><div id="_line2088" class="line">2088                     visible = get(hProp,<span class="string">'Visible'</span>);
</div><div id="_line2089" class="line">2089                 <span class="keyword">catch</span>
</div><div id="_line2090" class="line">2090                     accessFlags = [];
</div><div id="_line2091" class="line">2091                     visible = <span class="string">'on'</span>;
</div><div id="_line2092" class="line">2092                 <span class="keyword">end</span>
</div><div id="_line2093" class="line">2093                 <span class="keyword">if</span> isfield(accessFlags,<span class="string">'PublicSet'</span>) &amp;&amp; strcmp(accessFlags.PublicSet,<span class="string">'on'</span>)
</div><div id="_line2094" class="line">2094                     <span class="comment">% Bolden read/write fields</span>
</div><div id="_line2095" class="line">2095                     thisFieldFormat = [<span class="string">'&lt;b&gt;'</span> thisFieldName <span class="string">'&lt;b&gt;:$2'</span>];
</div><div id="_line2096" class="line">2096                 <span class="keyword">elseif</span> ~isfield(accessFlags,<span class="string">'PublicSet'</span>)
</div><div id="_line2097" class="line">2097                     <span class="comment">% Undefined - probably a Matlab-defined field of com.mathworks.hg.peer.FigureFrameProxy...</span>
</div><div id="_line2098" class="line">2098                     thisFieldFormat = [<span class="string">'&lt;font color=&quot;blue&quot;&gt;'</span> thisFieldName <span class="string">'&lt;/font&gt;:$2'</span>];
</div><div id="_line2099" class="line">2099                     undefinedStr = <span class="string">', &lt;font color=&quot;blue&quot;&gt;undefined&lt;/font&gt;'</span>;
</div><div id="_line2100" class="line">2100                 <span class="keyword">else</span> <span class="comment">% PublicSet=='off'</span>
</div><div id="_line2101" class="line">2101                     <span class="comment">% Gray-out &amp; italicize any read-only fields</span>
</div><div id="_line2102" class="line">2102                     thisFieldFormat = [<span class="string">'&lt;font color=&quot;#C0C0C0&quot;&gt;'</span> thisFieldName <span class="string">'&lt;/font&gt;:&lt;font color=&quot;#C0C0C0&quot;&gt;$2&lt;/font&gt;'</span>];
</div><div id="_line2103" class="line">2103                 <span class="keyword">end</span>
</div><div id="_line2104" class="line">2104                 <span class="keyword">if</span> strcmpi(visible,<span class="string">'off'</span>)
</div><div id="_line2105" class="line">2105                     <span class="comment">%thisFieldFormat = ['&lt;i&gt;' thisFieldFormat '&lt;/i&gt;']; %#ok&lt;AGROW&gt;</span>
</div><div id="_line2106" class="line">2106                     thisFieldFormat = regexprep(thisFieldFormat, <span class="string">'(.*):(.*)'</span>, <span class="string">'&lt;i&gt;$1:&lt;i&gt;$2'</span>);
</div><div id="_line2107" class="line">2107                     hiddenStr = <span class="string">', &lt;i&gt;hidden&lt;/i&gt;'</span>;
</div><div id="_line2108" class="line">2108                 <span class="keyword">end</span>
</div><div id="_line2109" class="line">2109                 dataFieldsStr = regexprep(dataFieldsStr, [<span class="string">'([\s\n])'</span> thisFieldName <span class="string">':([^\n]*)'</span>], [<span class="string">'$1'</span> thisFieldFormat]);
</div><div id="_line2110" class="line">2110             <span class="keyword">end</span>
</div><div id="_line2111" class="line">2111         <span class="keyword">catch</span>
</div><div id="_line2112" class="line">2112             <span class="comment">% never mind... - probably an ambiguous property name</span>
</div><div id="_line2113" class="line">2113             <span class="comment">%dispError</span>
</div><div id="_line2114" class="line">2114         <span class="keyword">end</span>
</div><div id="_line2115" class="line">2115 
</div><div id="_line2116" class="line">2116         <span class="comment">% Method 1: simple &lt;br&gt; list</span>
</div><div id="_line2117" class="line">2117         <span class="comment">%dataFieldsStr = strrep(dataFieldsStr,char(10),'&amp;nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;');</span>
</div><div id="_line2118" class="line">2118 
</div><div id="_line2119" class="line">2119         <span class="comment">% Method 2: 2-column &lt;table&gt;</span>
</div><div id="_line2120" class="line">2120         dataFieldsStr = regexprep(dataFieldsStr, <span class="string">'^\s*([^:]+:)([^\n]*)\n^\s*([^:]+:)([^\n]*)$'</span>, <span class="string">'&lt;tr&gt;&lt;td&gt;&amp;nbsp;$1&lt;/td&gt;&lt;td&gt;&amp;nbsp;$2&lt;/td&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;$3&lt;/td&gt;&lt;td&gt;&amp;nbsp;$4&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;'</span>, <span class="string">'lineanchors'</span>);
</div><div id="_line2121" class="line">2121         dataFieldsStr = regexprep(dataFieldsStr, <span class="string">'^[^&lt;]\s*([^:]+:)([^\n]*)$'</span>, <span class="string">'&lt;tr&gt;&lt;td&gt;&amp;nbsp;$1&lt;/td&gt;&lt;td&gt;&amp;nbsp;$2&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;'</span>, <span class="string">'lineanchors'</span>);
</div><div id="_line2122" class="line">2122         dataFieldsStr = [<span class="string">'(&lt;b&gt;modifiable&lt;/b&gt;'</span> undefinedStr hiddenStr <span class="string">' &amp;amp; &lt;font color=&quot;#C0C0C0&quot;&gt;read-only&lt;/font&gt; fields)&lt;p&gt;&amp;nbsp;&amp;nbsp;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;'</span> dataFieldsStr <span class="string">'&lt;/table&gt;'</span>];
</div><div id="_line2123" class="line">2123     <span class="keyword">end</span>
</div><div id="_line2124" class="line">2124 
</div><div id="_line2125" class="line">2125     <span class="comment">%% Update tooltip string with a node's data</span>
</div><div id="_line2126" class="line">2126     <a name="_sub32" href="#_subfunctions" class="code">function updateNodeTooltip(nodeHandle, uiObject)</a>
</div><div id="_line2127" class="line">2127         <span class="keyword">try</span>
</div><div id="_line2128" class="line">2128             toolTipStr = class(nodeHandle);
</div><div id="_line2129" class="line">2129             dataFieldsStr = <span class="string">''</span>;
</div><div id="_line2130" class="line">2130 
</div><div id="_line2131" class="line">2131             <span class="comment">% Add HG annotation if relevant</span>
</div><div id="_line2132" class="line">2132             <span class="keyword">if</span> ishghandle(nodeHandle)
</div><div id="_line2133" class="line">2133                 hgStr = <span class="string">' HG Handle'</span>;
</div><div id="_line2134" class="line">2134             <span class="keyword">else</span>
</div><div id="_line2135" class="line">2135                 hgStr = <span class="string">''</span>;
</div><div id="_line2136" class="line">2136             <span class="keyword">end</span>
</div><div id="_line2137" class="line">2137 
</div><div id="_line2138" class="line">2138             <span class="comment">% Prevent HG-Java warnings</span>
</div><div id="_line2139" class="line">2139             oldWarn = warning(<span class="string">'off'</span>,<span class="string">'MATLAB:hg:JavaSetHGProperty'</span>);
</div><div id="_line2140" class="line">2140             warning(<span class="string">'off'</span>,<span class="string">'MATLAB:hg:PossibleDeprecatedJavaSetHGProperty'</span>);
</div><div id="_line2141" class="line">2141 
</div><div id="_line2142" class="line">2142             <span class="comment">% Note: don't bulk-get because (1) not all properties are returned &amp; (2) some properties cause a Java exception</span>
</div><div id="_line2143" class="line">2143             <span class="comment">% Note2: the classhandle approach does not enable access to user-defined schema.props</span>
</div><div id="_line2144" class="line">2144             ch = classhandle(handle(nodeHandle));
</div><div id="_line2145" class="line">2145             dataFields = [];
</div><div id="_line2146" class="line">2146             [sortedNames, sortedIdx] = sort(get(ch.Properties,<span class="string">'Name'</span>));
</div><div id="_line2147" class="line">2147             <span class="keyword">for</span> idx = 1 : length(sortedIdx)
</div><div id="_line2148" class="line">2148                 sp = ch.Properties(sortedIdx(idx));
</div><div id="_line2149" class="line">2149                 <span class="comment">% TODO: some fields (see EOL comment below) generate a Java Exception from: com.mathworks.mlwidgets.inspector.PropertyRootNode$PropertyListener$1$1.run</span>
</div><div id="_line2150" class="line">2150                 <span class="keyword">if</span> strcmp(sp.AccessFlags.PublicGet,<span class="string">'on'</span>) <span class="comment">% &amp;&amp; ~any(strcmp(sp.Name,{'FixedColors','ListboxTop','Extent'}))</span>
</div><div id="_line2151" class="line">2151                     <span class="keyword">try</span>
</div><div id="_line2152" class="line">2152                         dataFields.(sp.Name) = get(nodeHandle, sp.Name);
</div><div id="_line2153" class="line">2153                     <span class="keyword">catch</span>
</div><div id="_line2154" class="line">2154                         dataFields.(sp.Name) = <span class="string">'&lt;font color=&quot;red&quot;&gt;Error!&lt;/font&gt;'</span>;
</div><div id="_line2155" class="line">2155                     <span class="keyword">end</span>
</div><div id="_line2156" class="line">2156                 <span class="keyword">else</span>
</div><div id="_line2157" class="line">2157                     dataFields.(sp.Name) = <span class="string">'(no public getter method)'</span>;
</div><div id="_line2158" class="line">2158                 <span class="keyword">end</span>
</div><div id="_line2159" class="line">2159             <span class="keyword">end</span>
</div><div id="_line2160" class="line">2160             dataFieldsStr = <a href="#_sub31" class="code" title="subgetPropsHtml">getPropsHtml</a>(nodeHandle, dataFields);
</div><div id="_line2161" class="line">2161         <span class="keyword">catch</span>
</div><div id="_line2162" class="line">2162             <span class="comment">% Probably a non-HG java object</span>
</div><div id="_line2163" class="line">2163             <span class="keyword">try</span>
</div><div id="_line2164" class="line">2164                 <span class="comment">% Note: the bulk-get approach enables access to user-defined schema-props, but not to some original classhandle Properties...</span>
</div><div id="_line2165" class="line">2165                 dataFields = get(nodeHandle);
</div><div id="_line2166" class="line">2166                 dataFieldsStr = <a href="#_sub31" class="code" title="subgetPropsHtml">getPropsHtml</a>(nodeHandle, dataFields);
</div><div id="_line2167" class="line">2167             <span class="keyword">catch</span>
</div><div id="_line2168" class="line">2168                 <span class="comment">% Probably a missing property getter implementation</span>
</div><div id="_line2169" class="line">2169                 <span class="keyword">try</span>
</div><div id="_line2170" class="line">2170                     <span class="comment">% Inform the user - bail out on error</span>
</div><div id="_line2171" class="line">2171                     err = lasterror;  <span class="comment">%#ok</span>
</div><div id="_line2172" class="line">2172                     dataFieldsStr = [<span class="string">'&lt;p&gt;'</span> strrep(err.message, char(10), <span class="string">'&lt;br&gt;'</span>)];
</div><div id="_line2173" class="line">2173                 <span class="keyword">catch</span>
</div><div id="_line2174" class="line">2174                     <span class="comment">% forget it...</span>
</div><div id="_line2175" class="line">2175                 <span class="keyword">end</span>
</div><div id="_line2176" class="line">2176             <span class="keyword">end</span>
</div><div id="_line2177" class="line">2177         <span class="keyword">end</span>
</div><div id="_line2178" class="line">2178 
</div><div id="_line2179" class="line">2179         <span class="comment">% Restore warnings</span>
</div><div id="_line2180" class="line">2180         <span class="keyword">try</span> warning(oldWarn); <span class="keyword">catch</span>, <span class="keyword">end</span>
</div><div id="_line2181" class="line">2181 
</div><div id="_line2182" class="line">2182         <span class="comment">% Set the object tooltip</span>
</div><div id="_line2183" class="line">2183         <span class="keyword">if</span> ~isempty(dataFieldsStr)
</div><div id="_line2184" class="line">2184             toolTipStr = [<span class="string">'&lt;html&gt;&amp;nbsp;&lt;b&gt;&lt;font color=&quot;blue&quot;&gt;'</span> char(toolTipStr) <span class="string">'&lt;/font&gt;&lt;/b&gt;'</span> hgStr <span class="string">':&amp;nbsp;'</span> dataFieldsStr <span class="string">'&lt;/html&gt;'</span>];
</div><div id="_line2185" class="line">2185         <span class="keyword">end</span>
</div><div id="_line2186" class="line">2186         uiObject.setToolTipText(toolTipStr);
</div><div id="_line2187" class="line">2187     <span class="keyword">end</span>
</div><div id="_line2188" class="line">2188 
</div><div id="_line2189" class="line">2189     <span class="comment">%% Expand tree node</span>
</div><div id="_line2190" class="line">2190     <a name="_sub33" href="#_subfunctions" class="code">function nodeExpanded(src, evd, tree)  </a><span class="comment">%#ok</span>
</div><div id="_line2191" class="line">2191         <span class="comment">% tree = handle(src);</span>
</div><div id="_line2192" class="line">2192         <span class="comment">% evdsrc = evd.getSource;</span>
</div><div id="_line2193" class="line">2193         evdnode = evd.getCurrentNode;
</div><div id="_line2194" class="line">2194 
</div><div id="_line2195" class="line">2195         <span class="keyword">if</span> ~tree.isLoaded(evdnode)
</div><div id="_line2196" class="line">2196 
</div><div id="_line2197" class="line">2197             <span class="comment">% Get the list of children TreeNodes</span>
</div><div id="_line2198" class="line">2198             childnodes = <a href="#_sub35" class="code" title="subgetChildrenNodes">getChildrenNodes</a>(tree, evdnode);
</div><div id="_line2199" class="line">2199 
</div><div id="_line2200" class="line">2200             <span class="comment">% Add the HG sub-tree (unless already included in the first tree)</span>
</div><div id="_line2201" class="line">2201             childHandle = getappdata(evdnode.handle,<span class="string">'childHandle'</span>);  <span class="comment">%=evdnode.getUserObject</span>
</div><div id="_line2202" class="line">2202             <span class="keyword">if</span> evdnode.isRoot &amp;&amp; ~isempty(hg_handles) &amp;&amp; ~isequal(hg_handles(1).java, childHandle)
</div><div id="_line2203" class="line">2203                 childnodes = [childnodes, <a href="#_sub35" class="code" title="subgetChildrenNodes">getChildrenNodes</a>(tree, evdnode, true)];
</div><div id="_line2204" class="line">2204             <span class="keyword">end</span>
</div><div id="_line2205" class="line">2205 
</div><div id="_line2206" class="line">2206             <span class="comment">% If we have a single child handle, wrap it within a javaArray for tree.add() to &quot;swallow&quot;</span>
</div><div id="_line2207" class="line">2207             <span class="keyword">if</span> (length(childnodes) == 1)
</div><div id="_line2208" class="line">2208                 chnodes = childnodes;
</div><div id="_line2209" class="line">2209                 childnodes = javaArray(<span class="string">'com.mathworks.hg.peer.UITreeNode'</span>, 1);
</div><div id="_line2210" class="line">2210                 childnodes(1) = java(chnodes);
</div><div id="_line2211" class="line">2211             <span class="keyword">end</span>
</div><div id="_line2212" class="line">2212 
</div><div id="_line2213" class="line">2213             <span class="comment">% Add child nodes to the current node</span>
</div><div id="_line2214" class="line">2214             tree.add(evdnode, childnodes);
</div><div id="_line2215" class="line">2215             tree.setLoaded(evdnode, true);
</div><div id="_line2216" class="line">2216         <span class="keyword">end</span>
</div><div id="_line2217" class="line">2217     <span class="keyword">end</span>
</div><div id="_line2218" class="line">2218 
</div><div id="_line2219" class="line">2219     <span class="comment">%% Get an icon image no larger than 16x16 pixels</span>
</div><div id="_line2220" class="line">2220     <a name="_sub34" href="#_subfunctions" class="code">function iconImage = setIconSize(iconImage)</a>
</div><div id="_line2221" class="line">2221         <span class="keyword">try</span>
</div><div id="_line2222" class="line">2222             iconWidth  = iconImage.getWidth;
</div><div id="_line2223" class="line">2223             iconHeight = iconImage.getHeight;
</div><div id="_line2224" class="line">2224             <span class="keyword">if</span> iconWidth &gt; 16
</div><div id="_line2225" class="line">2225                 newHeight = fix(iconHeight * 16 / iconWidth);
</div><div id="_line2226" class="line">2226                 iconImage = iconImage.getScaledInstance(16,newHeight,iconImage.SCALE_SMOOTH);
</div><div id="_line2227" class="line">2227             <span class="keyword">elseif</span> iconHeight &gt; 16
</div><div id="_line2228" class="line">2228                 newWidth = fix(iconWidth * 16 / iconHeight);
</div><div id="_line2229" class="line">2229                 iconImage = iconImage.getScaledInstance(newWidth,16,iconImage.SCALE_SMOOTH);
</div><div id="_line2230" class="line">2230             <span class="keyword">end</span>
</div><div id="_line2231" class="line">2231         <span class="keyword">catch</span>
</div><div id="_line2232" class="line">2232             <span class="comment">% never mind... - return original icon</span>
</div><div id="_line2233" class="line">2233         <span class="keyword">end</span>
</div><div id="_line2234" class="line">2234     <span class="keyword">end</span>  <span class="comment">% setIconSize</span>
</div><div id="_line2235" class="line">2235 
</div><div id="_line2236" class="line">2236     <span class="comment">%% Get list of children nodes</span>
</div><div id="_line2237" class="line">2237     <a name="_sub35" href="#_subfunctions" class="code">function nodes = getChildrenNodes(tree, parentNode, isRootHGNode)</a>
</div><div id="_line2238" class="line">2238         <span class="keyword">try</span>
</div><div id="_line2239" class="line">2239             iconpath = [matlabroot, <span class="string">'/toolbox/matlab/icons/'</span>];
</div><div id="_line2240" class="line">2240             nodes = handle([]);
</div><div id="_line2241" class="line">2241             <span class="keyword">try</span>
</div><div id="_line2242" class="line">2242                 userdata = get(tree,<span class="string">'userdata'</span>);
</div><div id="_line2243" class="line">2243             <span class="keyword">catch</span>
</div><div id="_line2244" class="line">2244                 userdata = getappdata(tree,<span class="string">'userdata'</span>);
</div><div id="_line2245" class="line">2245             <span class="keyword">end</span>
</div><div id="_line2246" class="line">2246             hdls = userdata.handles;
</div><div id="_line2247" class="line">2247             nodedata = get(parentNode,<span class="string">'userdata'</span>);
</div><div id="_line2248" class="line">2248             <span class="keyword">if</span> nargin &lt; 3
</div><div id="_line2249" class="line">2249                 <span class="comment">%isJavaNode = ~ishghandle(parentNode.getUserObject);</span>
</div><div id="_line2250" class="line">2250                 isJavaNode = ~ishghandle(nodedata.obj);
</div><div id="_line2251" class="line">2251                 isRootHGNode = false;
</div><div id="_line2252" class="line">2252             <span class="keyword">else</span>
</div><div id="_line2253" class="line">2253                 isJavaNode = ~isRootHGNode;
</div><div id="_line2254" class="line">2254             <span class="keyword">end</span>
</div><div id="_line2255" class="line">2255 
</div><div id="_line2256" class="line">2256             <span class="comment">% Search for this parent node in the list of all nodes</span>
</div><div id="_line2257" class="line">2257             parents = userdata.parents;
</div><div id="_line2258" class="line">2258             nodeIdx = nodedata.idx;
</div><div id="_line2259" class="line">2259 
</div><div id="_line2260" class="line">2260             <span class="keyword">if</span> isJavaNode &amp;&amp; isempty(nodeIdx)  <span class="comment">% Failback, in case userdata doesn't work for some reason...</span>
</div><div id="_line2261" class="line">2261                 <span class="keyword">for</span> hIdx = 1 : length(hdls)
</div><div id="_line2262" class="line">2262                     <span class="comment">%if isequal(handle(parentNode.getUserObject), hdls(hIdx))</span>
</div><div id="_line2263" class="line">2263                     <span class="keyword">if</span> isequal(handle(nodedata.obj), hdls(hIdx))
</div><div id="_line2264" class="line">2264                         nodeIdx = hIdx;
</div><div id="_line2265" class="line">2265                         <span class="keyword">break</span>;
</div><div id="_line2266" class="line">2266                     <span class="keyword">end</span>
</div><div id="_line2267" class="line">2267                 <span class="keyword">end</span>
</div><div id="_line2268" class="line">2268             <span class="keyword">end</span>
</div><div id="_line2269" class="line">2269             <span class="keyword">if</span> ~isJavaNode
</div><div id="_line2270" class="line">2270                 <span class="keyword">if</span> isRootHGNode  <span class="comment">% =root HG node</span>
</div><div id="_line2271" class="line">2271                     thisChildHandle = userdata.hg_handles(1);
</div><div id="_line2272" class="line">2272                     childName = <a href="#_sub36" class="code" title="subgetNodeName">getNodeName</a>(thisChildHandle);
</div><div id="_line2273" class="line">2273                     hasGrandChildren = any(parents==1);
</div><div id="_line2274" class="line">2274                     icon = [];
</div><div id="_line2275" class="line">2275                     <span class="keyword">if</span> hasGrandChildren &amp;&amp; length(hg_handles)&gt;1
</div><div id="_line2276" class="line">2276                         childName = childName.concat(<span class="string">' - HG root container'</span>);
</div><div id="_line2277" class="line">2277                         icon = [iconpath <span class="string">'figureicon.gif'</span>];
</div><div id="_line2278" class="line">2278                     <span class="keyword">end</span>
</div><div id="_line2279" class="line">2279                     <span class="keyword">try</span>
</div><div id="_line2280" class="line">2280                         nodes = uitreenode(<span class="string">'v0'</span>, thisChildHandle, childName, icon, ~hasGrandChildren);
</div><div id="_line2281" class="line">2281                     <span class="keyword">catch</span>  <span class="comment">% old matlab version don't have the 'v0' option</span>
</div><div id="_line2282" class="line">2282                         <span class="keyword">try</span>
</div><div id="_line2283" class="line">2283                             nodes = uitreenode(thisChildHandle, childName, icon, ~hasGrandChildren);
</div><div id="_line2284" class="line">2284                         <span class="keyword">catch</span>
</div><div id="_line2285" class="line">2285                             <span class="comment">% probably an invalid handle - ignore...</span>
</div><div id="_line2286" class="line">2286                         <span class="keyword">end</span>
</div><div id="_line2287" class="line">2287                     <span class="keyword">end</span>
</div><div id="_line2288" class="line">2288 
</div><div id="_line2289" class="line">2289                     <span class="comment">% Add the handler to the node's internal data</span>
</div><div id="_line2290" class="line">2290                     <span class="comment">% Note: could also use 'userdata', but setUserObject() is recommended for TreeNodes</span>
</div><div id="_line2291" class="line">2291                     <span class="comment">% Note2: however, setUserObject() sets a java *BeenAdapter object for HG handles instead of the required original class, so use setappdata</span>
</div><div id="_line2292" class="line">2292                     <span class="comment">%nodes.setUserObject(thisChildHandle);</span>
</div><div id="_line2293" class="line">2293                     setappdata(nodes,<span class="string">'childHandle'</span>,thisChildHandle);
</div><div id="_line2294" class="line">2294                     nodedata.idx = 1;
</div><div id="_line2295" class="line">2295                     nodedata.obj = thisChildHandle;
</div><div id="_line2296" class="line">2296                     set(nodes,<span class="string">'userdata'</span>,nodedata);
</div><div id="_line2297" class="line">2297                     <span class="keyword">return</span>;
</div><div id="_line2298" class="line">2298                 <span class="keyword">else</span>  <span class="comment">% non-root HG node</span>
</div><div id="_line2299" class="line">2299                     parents = userdata.hg_parents;
</div><div id="_line2300" class="line">2300                     hdls    = userdata.hg_handles;
</div><div id="_line2301" class="line">2301                 <span class="keyword">end</span>  <span class="comment">% if isRootHGNode</span>
</div><div id="_line2302" class="line">2302             <span class="keyword">end</span>  <span class="comment">% if ~isJavaNode</span>
</div><div id="_line2303" class="line">2303 
</div><div id="_line2304" class="line">2304             <span class="comment">% If this node was found, get the list of its children</span>
</div><div id="_line2305" class="line">2305             <span class="keyword">if</span> ~isempty(nodeIdx)
</div><div id="_line2306" class="line">2306                 <span class="comment">%childIdx = setdiff(find(parents==nodeIdx),nodeIdx);</span>
</div><div id="_line2307" class="line">2307                 childIdx = find(parents==nodeIdx);
</div><div id="_line2308" class="line">2308                 childIdx(childIdx==nodeIdx) = [];  <span class="comment">% faster...</span>
</div><div id="_line2309" class="line">2309                 numChildren = length(childIdx);
</div><div id="_line2310" class="line">2310                 <span class="keyword">for</span> cIdx = 1 : numChildren
</div><div id="_line2311" class="line">2311                     thisChildIdx = childIdx(cIdx);
</div><div id="_line2312" class="line">2312                     thisChildHandle = hdls(thisChildIdx);
</div><div id="_line2313" class="line">2313                     childName = <a href="#_sub36" class="code" title="subgetNodeName">getNodeName</a>(thisChildHandle);
</div><div id="_line2314" class="line">2314                     <span class="keyword">try</span>
</div><div id="_line2315" class="line">2315                         visible = thisChildHandle.Visible;
</div><div id="_line2316" class="line">2316                         <span class="keyword">if</span> visible
</div><div id="_line2317" class="line">2317                             <span class="keyword">try</span> visible = thisChildHandle.Width &gt; 0; <span class="keyword">catch</span>, <span class="keyword">end</span>  <span class="comment">%#ok</span>
</div><div id="_line2318" class="line">2318                         <span class="keyword">end</span>
</div><div id="_line2319" class="line">2319                         <span class="keyword">if</span> ~visible
</div><div id="_line2320" class="line">2320                             childName = [<span class="string">'&lt;HTML&gt;&lt;i&gt;&lt;font color=&quot;gray&quot;&gt;'</span> char(childName) <span class="string">'&lt;/font&gt;&lt;/i&gt;&lt;/html&gt;'</span>];  <span class="comment">%#ok grow</span>
</div><div id="_line2321" class="line">2321                         <span class="keyword">end</span>
</div><div id="_line2322" class="line">2322                     <span class="keyword">catch</span>
</div><div id="_line2323" class="line">2323                         <span class="comment">% never mind...</span>
</div><div id="_line2324" class="line">2324                     <span class="keyword">end</span>
</div><div id="_line2325" class="line">2325                     hasGrandChildren = any(parents==thisChildIdx);
</div><div id="_line2326" class="line">2326                     <span class="keyword">try</span>
</div><div id="_line2327" class="line">2327                         isaLabel = isa(thisChildHandle.java,<span class="string">'javax.swing.JLabel'</span>);
</div><div id="_line2328" class="line">2328                     <span class="keyword">catch</span>
</div><div id="_line2329" class="line">2329                         isaLabel = 0;
</div><div id="_line2330" class="line">2330                     <span class="keyword">end</span>
</div><div id="_line2331" class="line">2331                     <span class="keyword">if</span> hasGrandChildren &amp;&amp; ~any(strcmp(class(thisChildHandle),{<span class="string">'axes'</span>}))
</div><div id="_line2332" class="line">2332                         icon = [iconpath <span class="string">'foldericon.gif'</span>];
</div><div id="_line2333" class="line">2333                     <span class="keyword">elseif</span> isaLabel
</div><div id="_line2334" class="line">2334                         icon = [iconpath <span class="string">'tool_text.gif'</span>];
</div><div id="_line2335" class="line">2335                     <span class="keyword">else</span>
</div><div id="_line2336" class="line">2336                         icon = [];
</div><div id="_line2337" class="line">2337                     <span class="keyword">end</span>
</div><div id="_line2338" class="line">2338                     <span class="keyword">try</span>
</div><div id="_line2339" class="line">2339                         nodes(cIdx) = uitreenode(<span class="string">'v0'</span>, thisChildHandle, childName, icon, ~hasGrandChildren);
</div><div id="_line2340" class="line">2340                     <span class="keyword">catch</span>  <span class="comment">% old matlab version don't have the 'v0' option</span>
</div><div id="_line2341" class="line">2341                         <span class="keyword">try</span>
</div><div id="_line2342" class="line">2342                             nodes(cIdx) = uitreenode(thisChildHandle, childName, icon, ~hasGrandChildren);
</div><div id="_line2343" class="line">2343                         <span class="keyword">catch</span>
</div><div id="_line2344" class="line">2344                             <span class="comment">% probably an invalid handle - ignore...</span>
</div><div id="_line2345" class="line">2345                         <span class="keyword">end</span>
</div><div id="_line2346" class="line">2346                     <span class="keyword">end</span>
</div><div id="_line2347" class="line">2347 
</div><div id="_line2348" class="line">2348                     <span class="comment">% Use existing object icon, if available</span>
</div><div id="_line2349" class="line">2349                     <span class="keyword">try</span>
</div><div id="_line2350" class="line">2350                         <a href="#_sub21" class="code" title="subsetTreeNodeIcon">setTreeNodeIcon</a>(nodes(cIdx),thisChildHandle);
</div><div id="_line2351" class="line">2351                     <span class="keyword">catch</span>
</div><div id="_line2352" class="line">2352                         <span class="comment">% probably an invalid handle - ignore...</span>
</div><div id="_line2353" class="line">2353                     <span class="keyword">end</span>
</div><div id="_line2354" class="line">2354 
</div><div id="_line2355" class="line">2355                     <span class="comment">% Pre-select the node based upon the user's FINDJOBJ filters</span>
</div><div id="_line2356" class="line">2356                     <span class="keyword">try</span>
</div><div id="_line2357" class="line">2357                         <span class="keyword">if</span> isJavaNode &amp;&amp; ~userdata.userSelected &amp;&amp; any(userdata.initialIdx == thisChildIdx)
</div><div id="_line2358" class="line">2358                             pause(0.0002);  <span class="comment">% as short as possible...</span>
</div><div id="_line2359" class="line">2359                             drawnow;
</div><div id="_line2360" class="line">2360                             <span class="keyword">if</span> isempty(tree.getSelectedNodes)
</div><div id="_line2361" class="line">2361                                 tree.setSelectedNode(nodes(cIdx));
</div><div id="_line2362" class="line">2362                             <span class="keyword">else</span>
</div><div id="_line2363" class="line">2363                                 newSelectedNodes = [tree.getSelectedNodes, nodes(cIdx).java];
</div><div id="_line2364" class="line">2364                                 tree.setSelectedNodes(newSelectedNodes);
</div><div id="_line2365" class="line">2365                             <span class="keyword">end</span>
</div><div id="_line2366" class="line">2366                         <span class="keyword">end</span>
</div><div id="_line2367" class="line">2367                     <span class="keyword">catch</span>
</div><div id="_line2368" class="line">2368                         <span class="comment">% never mind...</span>
</div><div id="_line2369" class="line">2369                     <span class="keyword">end</span>
</div><div id="_line2370" class="line">2370 
</div><div id="_line2371" class="line">2371                     <span class="comment">% Add the handler to the node's internal data</span>
</div><div id="_line2372" class="line">2372                     <span class="comment">% Note: could also use 'userdata', but setUserObject() is recommended for TreeNodes</span>
</div><div id="_line2373" class="line">2373                     <span class="comment">% Note2: however, setUserObject() sets a java *BeenAdapter object for HG handles instead of the required original class, so use setappdata</span>
</div><div id="_line2374" class="line">2374                     <span class="comment">% Note3: the following will error if invalid handle - ignore</span>
</div><div id="_line2375" class="line">2375                     <span class="keyword">try</span>
</div><div id="_line2376" class="line">2376                         <span class="keyword">if</span> isJavaNode
</div><div id="_line2377" class="line">2377                             thisChildHandle = thisChildHandle.java;
</div><div id="_line2378" class="line">2378                         <span class="keyword">end</span>
</div><div id="_line2379" class="line">2379                         <span class="comment">%nodes(cIdx).setUserObject(thisChildHandle);</span>
</div><div id="_line2380" class="line">2380                         setappdata(nodes(cIdx),<span class="string">'childHandle'</span>,thisChildHandle);
</div><div id="_line2381" class="line">2381                         nodedata.idx = thisChildIdx;
</div><div id="_line2382" class="line">2382                         nodedata.obj = thisChildHandle;
</div><div id="_line2383" class="line">2383                         set(nodes(cIdx),<span class="string">'userdata'</span>,nodedata);
</div><div id="_line2384" class="line">2384                     <span class="keyword">catch</span>
</div><div id="_line2385" class="line">2385                         <span class="comment">% never mind (probably an invalid handle) - leave unchanged (like a leaf)</span>
</div><div id="_line2386" class="line">2386                     <span class="keyword">end</span>
</div><div id="_line2387" class="line">2387                 <span class="keyword">end</span>
</div><div id="_line2388" class="line">2388             <span class="keyword">end</span>
</div><div id="_line2389" class="line">2389         <span class="keyword">catch</span>
</div><div id="_line2390" class="line">2390             <span class="comment">% Never mind - leave unchanged (like a leaf)</span>
</div><div id="_line2391" class="line">2391             <span class="comment">%error('YMA:findjobj:UnknownNodeType', 'Error expanding component tree node');</span>
</div><div id="_line2392" class="line">2392             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2393" class="line">2393         <span class="keyword">end</span>
</div><div id="_line2394" class="line">2394     <span class="keyword">end</span>
</div><div id="_line2395" class="line">2395 
</div><div id="_line2396" class="line">2396     <span class="comment">%% Get a node's name</span>
</div><div id="_line2397" class="line">2397     <a name="_sub36" href="#_subfunctions" class="code">function [nodeName, nodeTitle] = getNodeName(hndl,charsLimit)</a>
</div><div id="_line2398" class="line">2398         <span class="keyword">try</span>
</div><div id="_line2399" class="line">2399             <span class="comment">% Initialize (just in case one of the succeding lines croaks)</span>
</div><div id="_line2400" class="line">2400             nodeName = <span class="string">''</span>;
</div><div id="_line2401" class="line">2401             nodeTitle = <span class="string">''</span>;
</div><div id="_line2402" class="line">2402             <span class="keyword">if</span> ~ismethod(hndl,<span class="string">'getClass'</span>)
</div><div id="_line2403" class="line">2403                 <span class="keyword">try</span>
</div><div id="_line2404" class="line">2404                     nodeName = class(hndl);
</div><div id="_line2405" class="line">2405                 <span class="keyword">catch</span>
</div><div id="_line2406" class="line">2406                     nodeName = hndl.type;  <span class="comment">% last-ditch try...</span>
</div><div id="_line2407" class="line">2407                 <span class="keyword">end</span>
</div><div id="_line2408" class="line">2408             <span class="keyword">else</span>
</div><div id="_line2409" class="line">2409                 nodeName = hndl.getClass.getSimpleName;
</div><div id="_line2410" class="line">2410             <span class="keyword">end</span>
</div><div id="_line2411" class="line">2411 
</div><div id="_line2412" class="line">2412             <span class="comment">% Strip away the package name, leaving only the regular classname</span>
</div><div id="_line2413" class="line">2413             <span class="keyword">if</span> ~isempty(nodeName) &amp;&amp; <a href="#_sub52" class="code" title="subischar">ischar</a>(nodeName)
</div><div id="_line2414" class="line">2414                 nodeName = java.lang.String(nodeName);
</div><div id="_line2415" class="line">2415                 nodeName = nodeName.substring(nodeName.lastIndexOf(<span class="string">'.'</span>)+1);
</div><div id="_line2416" class="line">2416             <span class="keyword">end</span>
</div><div id="_line2417" class="line">2417             <span class="keyword">if</span> (nodeName.length == 0)
</div><div id="_line2418" class="line">2418                 <span class="comment">% fix case of anonymous internal classes, that do not have SimpleNames</span>
</div><div id="_line2419" class="line">2419                 <span class="keyword">try</span>
</div><div id="_line2420" class="line">2420                     nodeName = hndl.getClass.getName;
</div><div id="_line2421" class="line">2421                     nodeName = nodeName.substring(nodeName.lastIndexOf(<span class="string">'.'</span>)+1);
</div><div id="_line2422" class="line">2422                 <span class="keyword">catch</span>
</div><div id="_line2423" class="line">2423                     <span class="comment">% never mind - leave unchanged...</span>
</div><div id="_line2424" class="line">2424                 <span class="keyword">end</span>
</div><div id="_line2425" class="line">2425             <span class="keyword">end</span>
</div><div id="_line2426" class="line">2426 
</div><div id="_line2427" class="line">2427             <span class="comment">% Get any unique identifying string (if available in one of several fields)</span>
</div><div id="_line2428" class="line">2428             labelsToCheck = {<span class="string">'label'</span>,<span class="string">'title'</span>,<span class="string">'text'</span>,<span class="string">'string'</span>,<span class="string">'displayname'</span>,<span class="string">'toolTipText'</span>,<span class="string">'TooltipString'</span>,<span class="string">'actionCommand'</span>,<span class="string">'name'</span>,<span class="string">'Tag'</span>,<span class="string">'style'</span>}; <span class="comment">%,'UIClassID'};</span>
</div><div id="_line2429" class="line">2429             nodeTitle = <span class="string">''</span>;
</div><div id="_line2430" class="line">2430             strField = <span class="string">''</span>;  <span class="comment">%#ok - used for debugging</span>
</div><div id="_line2431" class="line">2431             <span class="keyword">while</span> ((~isa(nodeTitle,<span class="string">'java.lang.String'</span>) &amp;&amp; ~<a href="#_sub52" class="code" title="subischar">ischar</a>(nodeTitle)) || isempty(nodeTitle)) &amp;&amp; ~isempty(labelsToCheck)
</div><div id="_line2432" class="line">2432                 <span class="keyword">try</span>
</div><div id="_line2433" class="line">2433                     nodeTitle = get(hndl,labelsToCheck{1});
</div><div id="_line2434" class="line">2434                     strField = labelsToCheck{1};  <span class="comment">%#ok - used for debugging</span>
</div><div id="_line2435" class="line">2435                 <span class="keyword">catch</span>
</div><div id="_line2436" class="line">2436                     <span class="comment">% never mind - probably missing prop, so skip to next one</span>
</div><div id="_line2437" class="line">2437                 <span class="keyword">end</span>
</div><div id="_line2438" class="line">2438                 labelsToCheck(1) = [];
</div><div id="_line2439" class="line">2439             <span class="keyword">end</span>
</div><div id="_line2440" class="line">2440             <span class="keyword">if</span> length(nodeTitle) ~= numel(nodeTitle)
</div><div id="_line2441" class="line">2441                 <span class="comment">% Multi-line - convert to a long single line</span>
</div><div id="_line2442" class="line">2442                 nodeTitle = nodeTitle';
</div><div id="_line2443" class="line">2443                 nodeTitle = nodeTitle(:)';
</div><div id="_line2444" class="line">2444             <span class="keyword">end</span>
</div><div id="_line2445" class="line">2445             <span class="keyword">if</span> isempty(char(nodeTitle))
</div><div id="_line2446" class="line">2446                 <span class="comment">% No title - check whether this is an HG label whose text is gettable</span>
</div><div id="_line2447" class="line">2447                 <span class="keyword">try</span>
</div><div id="_line2448" class="line">2448                     location = hndl.getLocationOnScreen;
</div><div id="_line2449" class="line">2449                     pos = [location.getX, location.getY, hndl.getWidth, hndl.getHeight];
</div><div id="_line2450" class="line">2450                     <span class="comment">%dist = sum((labelPositions-repmat(pos,size(labelPositions,1),[1,1,1,1])).^2, 2);</span>
</div><div id="_line2451" class="line">2451                     dist = sum((labelPositions-repmat(pos,[size(labelPositions,1),1])).^2, 2);
</div><div id="_line2452" class="line">2452                     [minVal,minIdx] = min(dist);
</div><div id="_line2453" class="line">2453                     <span class="comment">% Allow max distance of 8 = 2^2+2^2 (i.e. X&amp;Y off by up to 2 pixels, W&amp;H exact)</span>
</div><div id="_line2454" class="line">2454                     <span class="keyword">if</span> minVal &lt;= 8  <span class="comment">% 8=2^2+2^2</span>
</div><div id="_line2455" class="line">2455                         nodeTitle = get(hg_labels(minIdx),<span class="string">'string'</span>);
</div><div id="_line2456" class="line">2456                         <span class="comment">% Preserve the label handles &amp; position for the tooltip &amp; context-menu</span>
</div><div id="_line2457" class="line">2457                         <span class="comment">%hg_labels(minIdx) = [];</span>
</div><div id="_line2458" class="line">2458                         <span class="comment">%labelPositions(minIdx,:) = [];</span>
</div><div id="_line2459" class="line">2459                     <span class="keyword">end</span>
</div><div id="_line2460" class="line">2460                 <span class="keyword">catch</span>
</div><div id="_line2461" class="line">2461                     <span class="comment">% never mind...</span>
</div><div id="_line2462" class="line">2462                 <span class="keyword">end</span>
</div><div id="_line2463" class="line">2463             <span class="keyword">end</span>
</div><div id="_line2464" class="line">2464             <span class="keyword">if</span> nargin&lt;2,  charsLimit = 25;  <span class="keyword">end</span>
</div><div id="_line2465" class="line">2465             extraStr = regexprep(nodeTitle,{sprintf(<span class="string">'(.{%d,%d}).*'</span>,charsLimit,min(charsLimit,length(nodeTitle)-1)),<span class="string">' +'</span>},{<span class="string">'$1...'</span>,<span class="string">' '</span>},<span class="string">'once'</span>);
</div><div id="_line2466" class="line">2466             <span class="keyword">if</span> ~isempty(extraStr)
</div><div id="_line2467" class="line">2467                 <span class="keyword">if</span> <a href="#_sub52" class="code" title="subischar">ischar</a>(extraStr)
</div><div id="_line2468" class="line">2468                     nodeName = nodeName.concat(<span class="string">' ('''</span>).concat(extraStr).concat(<span class="string">''')'</span>);
</div><div id="_line2469" class="line">2469                 <span class="keyword">else</span>
</div><div id="_line2470" class="line">2470                     nodeName = nodeName.concat(<span class="string">' ('</span>).concat(num2str(extraStr)).concat(<span class="string">')'</span>);
</div><div id="_line2471" class="line">2471                 <span class="keyword">end</span>
</div><div id="_line2472" class="line">2472                 <span class="comment">%nodeName = nodeName.concat(strField);</span>
</div><div id="_line2473" class="line">2473             <span class="keyword">end</span>
</div><div id="_line2474" class="line">2474         <span class="keyword">catch</span>
</div><div id="_line2475" class="line">2475             <span class="comment">% Never mind - use whatever we have so far</span>
</div><div id="_line2476" class="line">2476             <span class="comment">%dispError</span>
</div><div id="_line2477" class="line">2477         <span class="keyword">end</span>
</div><div id="_line2478" class="line">2478     <span class="keyword">end</span>
</div><div id="_line2479" class="line">2479 
</div><div id="_line2480" class="line">2480     <span class="comment">%% Strip standard Swing callbacks from a list of events</span>
</div><div id="_line2481" class="line">2481     <a name="_sub37" href="#_subfunctions" class="code">function evNames = stripStdCbs(evNames)</a>
</div><div id="_line2482" class="line">2482         <span class="keyword">try</span>
</div><div id="_line2483" class="line">2483             stdEvents = {<span class="string">'AncestorAdded'</span>, <span class="string">'AncestorMoved'</span>, <span class="string">'AncestorRemoved'</span>, <span class="string">'AncestorResized'</span>, <span class="keyword">...</span>
</div><div id="_line2484" class="line">2484                          <span class="string">'CaretPositionChanged'</span>, <span class="string">'ComponentAdded'</span>, <span class="string">'ComponentRemoved'</span>, <span class="keyword">...</span>
</div><div id="_line2485" class="line">2485                          <span class="string">'ComponentHidden'</span>, <span class="string">'ComponentMoved'</span>, <span class="string">'ComponentResized'</span>, <span class="string">'ComponentShown'</span>, <span class="keyword">...</span>
</div><div id="_line2486" class="line">2486                          <span class="string">'PropertyChange'</span>, <span class="string">'FocusGained'</span>, <span class="string">'FocusLost'</span>, <span class="keyword">...</span>
</div><div id="_line2487" class="line">2487                          <span class="string">'HierarchyChanged'</span>, <span class="string">'InputMethodTextChanged'</span>, <span class="keyword">...</span>
</div><div id="_line2488" class="line">2488                          <span class="string">'KeyPressed'</span>, <span class="string">'KeyReleased'</span>, <span class="string">'KeyTyped'</span>, <span class="keyword">...</span>
</div><div id="_line2489" class="line">2489                          <span class="string">'MouseClicked'</span>, <span class="string">'MouseDragged'</span>, <span class="string">'MouseEntered'</span>, <span class="string">'MouseExited'</span>, <span class="keyword">...</span>
</div><div id="_line2490" class="line">2490                          <span class="string">'MouseMoved'</span>, <span class="string">'MousePressed'</span>, <span class="string">'MouseReleased'</span>, <span class="string">'MouseWheelMoved'</span>, <span class="keyword">...</span>
</div><div id="_line2491" class="line">2491                          <span class="string">'VetoableChange'</span>};
</div><div id="_line2492" class="line">2492             stdEvents = [stdEvents, strcat(stdEvents,<span class="string">'Callback'</span>), strcat(stdEvents,<span class="string">'Fcn'</span>)];
</div><div id="_line2493" class="line">2493             evNames = setdiff(evNames,stdEvents)';
</div><div id="_line2494" class="line">2494         <span class="keyword">catch</span>
</div><div id="_line2495" class="line">2495             <span class="comment">% Never mind...</span>
</div><div id="_line2496" class="line">2496             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2497" class="line">2497         <span class="keyword">end</span>
</div><div id="_line2498" class="line">2498     <span class="keyword">end</span>
</div><div id="_line2499" class="line">2499 
</div><div id="_line2500" class="line">2500     <span class="comment">%% Callback function for &lt;Hide standard callbacks&gt; checkbox</span>
</div><div id="_line2501" class="line">2501     <a name="_sub38" href="#_subfunctions" class="code">function cbHideStdCbs_Callback(src, evd, callbacksTable, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2502" class="line">2502         <span class="keyword">try</span>
</div><div id="_line2503" class="line">2503             <span class="comment">% Store the current checkbox value for later use</span>
</div><div id="_line2504" class="line">2504             <span class="keyword">if</span> nargin &lt; 3
</div><div id="_line2505" class="line">2505                 <span class="keyword">try</span>
</div><div id="_line2506" class="line">2506                     callbacksTable = get(src,<span class="string">'userdata'</span>);
</div><div id="_line2507" class="line">2507                 <span class="keyword">catch</span>
</div><div id="_line2508" class="line">2508                     callbacksTable = getappdata(src,<span class="string">'userdata'</span>);
</div><div id="_line2509" class="line">2509                 <span class="keyword">end</span>
</div><div id="_line2510" class="line">2510             <span class="keyword">end</span>
</div><div id="_line2511" class="line">2511             <span class="keyword">if</span> evd.getSource.isSelected
</div><div id="_line2512" class="line">2512                 setappdata(callbacksTable,<span class="string">'hideStdCbs'</span>,1);
</div><div id="_line2513" class="line">2513             <span class="keyword">else</span>
</div><div id="_line2514" class="line">2514                 setappdata(callbacksTable,<span class="string">'hideStdCbs'</span>,[]);
</div><div id="_line2515" class="line">2515             <span class="keyword">end</span>
</div><div id="_line2516" class="line">2516 
</div><div id="_line2517" class="line">2517             <span class="comment">% Rescan the current node</span>
</div><div id="_line2518" class="line">2518             <span class="keyword">try</span>
</div><div id="_line2519" class="line">2519                 userdata = get(callbacksTable,<span class="string">'userdata'</span>);
</div><div id="_line2520" class="line">2520             <span class="keyword">catch</span>
</div><div id="_line2521" class="line">2521                 userdata = getappdata(callbacksTable,<span class="string">'userdata'</span>);
</div><div id="_line2522" class="line">2522             <span class="keyword">end</span>
</div><div id="_line2523" class="line">2523             nodepath = userdata.jTree.getSelectionModel.getSelectionPath;
</div><div id="_line2524" class="line">2524             <span class="keyword">try</span>
</div><div id="_line2525" class="line">2525                 ed.getCurrentNode = nodepath.getLastPathComponent;
</div><div id="_line2526" class="line">2526                 <a href="#_sub29" class="code" title="subnodeSelected">nodeSelected</a>(handle(userdata.jTreePeer),ed,[]);
</div><div id="_line2527" class="line">2527             <span class="keyword">catch</span>
</div><div id="_line2528" class="line">2528                 <span class="comment">% ignore - probably no node selected</span>
</div><div id="_line2529" class="line">2529             <span class="keyword">end</span>
</div><div id="_line2530" class="line">2530         <span class="keyword">catch</span>
</div><div id="_line2531" class="line">2531             <span class="comment">% Never mind...</span>
</div><div id="_line2532" class="line">2532             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2533" class="line">2533         <span class="keyword">end</span>
</div><div id="_line2534" class="line">2534     <span class="keyword">end</span>
</div><div id="_line2535" class="line">2535 
</div><div id="_line2536" class="line">2536     <span class="comment">%% Callback function for &lt;UndocumentedMatlab.com&gt; button</span>
</div><div id="_line2537" class="line">2537     <a name="_sub39" href="#_subfunctions" class="code">function btWebsite_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2538" class="line">2538         <span class="keyword">try</span>
</div><div id="_line2539" class="line">2539             web(<span class="string">'http://UndocumentedMatlab.com/'</span>);
</div><div id="_line2540" class="line">2540         <span class="keyword">catch</span>
</div><div id="_line2541" class="line">2541             <span class="comment">% Never mind...</span>
</div><div id="_line2542" class="line">2542             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2543" class="line">2543         <span class="keyword">end</span>
</div><div id="_line2544" class="line">2544     <span class="keyword">end</span>
</div><div id="_line2545" class="line">2545 
</div><div id="_line2546" class="line">2546     <span class="comment">%% Callback function for &lt;Refresh data&gt; button</span>
</div><div id="_line2547" class="line">2547     <a name="_sub40" href="#_subfunctions" class="code">function btRefresh_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2548" class="line">2548         <span class="keyword">try</span>
</div><div id="_line2549" class="line">2549             <span class="comment">% Set cursor shape to hourglass until we're done</span>
</div><div id="_line2550" class="line">2550             hTreeFig = varargin{2};
</div><div id="_line2551" class="line">2551             set(hTreeFig,<span class="string">'Pointer'</span>,<span class="string">'watch'</span>);
</div><div id="_line2552" class="line">2552             drawnow;
</div><div id="_line2553" class="line">2553             object = varargin{1};
</div><div id="_line2554" class="line">2554 
</div><div id="_line2555" class="line">2555             <span class="comment">% Re-invoke this utility to re-scan the container for all children</span>
</div><div id="_line2556" class="line">2556             <a href="findjobj.html" class="code" title="function [handles,levels,parentIdx,listing] = findjobj(container,varargin) %#ok<*CTCH,*ASGLU,*MSNU,*NASGU>">findjobj</a>(object);
</div><div id="_line2557" class="line">2557         <span class="keyword">catch</span>
</div><div id="_line2558" class="line">2558             <span class="comment">% Never mind...</span>
</div><div id="_line2559" class="line">2559         <span class="keyword">end</span>
</div><div id="_line2560" class="line">2560 
</div><div id="_line2561" class="line">2561         <span class="comment">% Restore default cursor shape</span>
</div><div id="_line2562" class="line">2562         set(hTreeFig,<span class="string">'Pointer'</span>,<span class="string">'arrow'</span>);
</div><div id="_line2563" class="line">2563     <span class="keyword">end</span>
</div><div id="_line2564" class="line">2564 
</div><div id="_line2565" class="line">2565     <span class="comment">%% Callback function for &lt;Export&gt; button</span>
</div><div id="_line2566" class="line">2566     <a name="_sub41" href="#_subfunctions" class="code">function btExport_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2567" class="line">2567         <span class="keyword">try</span>
</div><div id="_line2568" class="line">2568             <span class="comment">% Get the list of all selected nodes</span>
</div><div id="_line2569" class="line">2569             <span class="keyword">if</span> length(varargin) &gt; 1
</div><div id="_line2570" class="line">2570                 jTree = varargin{1};
</div><div id="_line2571" class="line">2571                 numSelections  = jTree.getSelectionCount;
</div><div id="_line2572" class="line">2572                 selectionPaths = jTree.getSelectionPaths;
</div><div id="_line2573" class="line">2573                 hdls = handle([]);
</div><div id="_line2574" class="line">2574                 <span class="keyword">for</span> idx = 1 : numSelections
</div><div id="_line2575" class="line">2575                     <span class="comment">%hdls(idx) = handle(selectionPaths(idx).getLastPathComponent.getUserObject);</span>
</div><div id="_line2576" class="line">2576                     nodedata = get(selectionPaths(idx).getLastPathComponent,<span class="string">'userdata'</span>);
</div><div id="_line2577" class="line">2577                     hdls(idx) = handle(nodedata.obj,<span class="string">'CallbackProperties'</span>);
</div><div id="_line2578" class="line">2578                 <span class="keyword">end</span>
</div><div id="_line2579" class="line">2579 
</div><div id="_line2580" class="line">2580                 <span class="comment">% Assign the handles in the base workspace &amp; inform user</span>
</div><div id="_line2581" class="line">2581                 assignin(<span class="string">'base'</span>,<span class="string">'findjobj_hdls'</span>,hdls);
</div><div id="_line2582" class="line">2582                 classNameLabel = varargin{2};
</div><div id="_line2583" class="line">2583                 msg = [<span class="string">'Exported '</span> char(classNameLabel.getText.trim) <span class="string">' to base workspace variable findjobj_hdls'</span>];
</div><div id="_line2584" class="line">2584             <span class="keyword">else</span>
</div><div id="_line2585" class="line">2585                 <span class="comment">% Right-click (context-menu) callback</span>
</div><div id="_line2586" class="line">2586                 data = varargin{1};
</div><div id="_line2587" class="line">2587                 obj = data{1};
</div><div id="_line2588" class="line">2588                 varName = data{2};
</div><div id="_line2589" class="line">2589                 <span class="keyword">if</span> isempty(varName)
</div><div id="_line2590" class="line">2590                     varName = inputdlg(<span class="string">'Enter workspace variable name'</span>,<span class="string">'FindJObj'</span>);
</div><div id="_line2591" class="line">2591                     <span class="keyword">if</span> isempty(varName),  <span class="keyword">return</span>;  <span class="keyword">end</span>  <span class="comment">% bail out on &lt;Cancel&gt;</span>
</div><div id="_line2592" class="line">2592                     varName = varName{1};
</div><div id="_line2593" class="line">2593                     <span class="keyword">if</span> isempty(varName) || ~<a href="#_sub52" class="code" title="subischar">ischar</a>(varName),  <span class="keyword">return</span>;  <span class="keyword">end</span>  <span class="comment">% bail out on empty/null</span>
</div><div id="_line2594" class="line">2594                     varName = genvarname(varName);
</div><div id="_line2595" class="line">2595                 <span class="keyword">end</span>
</div><div id="_line2596" class="line">2596                 assignin(<span class="string">'base'</span>,varName,handle(obj,<span class="string">'CallbackProperties'</span>));
</div><div id="_line2597" class="line">2597                 msg = [<span class="string">'Exported object to base workspace variable '</span> varName];
</div><div id="_line2598" class="line">2598             <span class="keyword">end</span>
</div><div id="_line2599" class="line">2599             msgbox(msg,<span class="string">'FindJObj'</span>,<span class="string">'help'</span>);
</div><div id="_line2600" class="line">2600         <span class="keyword">catch</span>
</div><div id="_line2601" class="line">2601             <span class="comment">% Never mind...</span>
</div><div id="_line2602" class="line">2602             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2603" class="line">2603         <span class="keyword">end</span>
</div><div id="_line2604" class="line">2604     <span class="keyword">end</span>
</div><div id="_line2605" class="line">2605 
</div><div id="_line2606" class="line">2606     <span class="comment">%% Callback function for &lt;Request focus&gt; button</span>
</div><div id="_line2607" class="line">2607     <a name="_sub42" href="#_subfunctions" class="code">function btFocus_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2608" class="line">2608         <span class="keyword">try</span>
</div><div id="_line2609" class="line">2609             <span class="comment">% Request focus for the specified object</span>
</div><div id="_line2610" class="line">2610             object = <a href="#_sub46" class="code" title="subgetTopSelectedObject">getTopSelectedObject</a>(varargin{:});
</div><div id="_line2611" class="line">2611             object.requestFocus;
</div><div id="_line2612" class="line">2612         <span class="keyword">catch</span>
</div><div id="_line2613" class="line">2613             <span class="keyword">try</span>
</div><div id="_line2614" class="line">2614                 object = object.java.getPeer.requestFocus;
</div><div id="_line2615" class="line">2615                 object.requestFocus;
</div><div id="_line2616" class="line">2616             <span class="keyword">catch</span>
</div><div id="_line2617" class="line">2617                 <span class="comment">% Never mind...</span>
</div><div id="_line2618" class="line">2618                 <span class="comment">%dispError</span>
</div><div id="_line2619" class="line">2619             <span class="keyword">end</span>
</div><div id="_line2620" class="line">2620         <span class="keyword">end</span>
</div><div id="_line2621" class="line">2621     <span class="keyword">end</span>
</div><div id="_line2622" class="line">2622 
</div><div id="_line2623" class="line">2623     <span class="comment">%% Callback function for &lt;Inspect&gt; button</span>
</div><div id="_line2624" class="line">2624     <a name="_sub43" href="#_subfunctions" class="code">function btInspect_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2625" class="line">2625         <span class="keyword">try</span>
</div><div id="_line2626" class="line">2626             <span class="comment">% Inspect the specified object</span>
</div><div id="_line2627" class="line">2627             <span class="keyword">if</span> length(varargin) == 1
</div><div id="_line2628" class="line">2628                 object = varargin{1};
</div><div id="_line2629" class="line">2629             <span class="keyword">else</span>
</div><div id="_line2630" class="line">2630                 object = <a href="#_sub46" class="code" title="subgetTopSelectedObject">getTopSelectedObject</a>(varargin{:});
</div><div id="_line2631" class="line">2631             <span class="keyword">end</span>
</div><div id="_line2632" class="line">2632             <span class="keyword">if</span> isempty(which(<span class="string">'uiinspect'</span>))
</div><div id="_line2633" class="line">2633 
</div><div id="_line2634" class="line">2634                 <span class="comment">% If the user has not indicated NOT to be informed about UIInspect</span>
</div><div id="_line2635" class="line">2635                 <span class="keyword">if</span> ~ispref(<span class="string">'FindJObj'</span>,<span class="string">'dontCheckUIInspect'</span>)
</div><div id="_line2636" class="line">2636 
</div><div id="_line2637" class="line">2637                     <span class="comment">% Ask the user whether to download UIINSPECT (YES, no, no &amp; don't ask again)</span>
</div><div id="_line2638" class="line">2638                     answer = questdlg({<span class="string">'The object inspector requires UIINSPECT from the MathWorks File Exchange. UIINSPECT was created by Yair Altman, like this FindJObj utility.'</span>,<span class="string">''</span>,<span class="string">'Download &amp; install UIINSPECT?'</span>},<span class="string">'UIInspect'</span>,<span class="string">'Yes'</span>,<span class="string">'No'</span>,<span class="string">'No &amp; never ask again'</span>,<span class="string">'Yes'</span>);
</div><div id="_line2639" class="line">2639                     <span class="keyword">switch</span> answer
</div><div id="_line2640" class="line">2640                         <span class="keyword">case</span> <span class="string">'Yes'</span>  <span class="comment">% =&gt; Yes: download &amp; install</span>
</div><div id="_line2641" class="line">2641                             <span class="keyword">try</span>
</div><div id="_line2642" class="line">2642                                 <span class="comment">% Download UIINSPECT</span>
</div><div id="_line2643" class="line">2643                                 baseUrl = <span class="string">'http://www.mathworks.com/matlabcentral/fileexchange/17935'</span>;
</div><div id="_line2644" class="line">2644                                 fileUrl = [baseUrl <span class="string">'?controller=file_infos&amp;download=true'</span>];
</div><div id="_line2645" class="line">2645                                 <span class="comment">%file = urlread(fileUrl);</span>
</div><div id="_line2646" class="line">2646                                 <span class="comment">%file = regexprep(file,[char(13),char(10)],'\n');  %convert to OS-dependent EOL</span>
</div><div id="_line2647" class="line">2647 
</div><div id="_line2648" class="line">2648                                 <span class="comment">% Install...</span>
</div><div id="_line2649" class="line">2649                                 <span class="comment">%newPath = fullfile(fileparts(which(mfilename)),'uiinspect.m');</span>
</div><div id="_line2650" class="line">2650                                 <span class="comment">%fid = fopen(newPath,'wt');</span>
</div><div id="_line2651" class="line">2651                                 <span class="comment">%fprintf(fid,'%s',file);</span>
</div><div id="_line2652" class="line">2652                                 <span class="comment">%fclose(fid);</span>
</div><div id="_line2653" class="line">2653                                 [fpath,fname,fext] = fileparts(which(mfilename));
</div><div id="_line2654" class="line">2654                                 zipFileName = fullfile(fpath,<span class="string">'uiinspect.zip'</span>);
</div><div id="_line2655" class="line">2655                                 urlwrite(fileUrl,zipFileName);
</div><div id="_line2656" class="line">2656                                 unzip(zipFileName,fpath);
</div><div id="_line2657" class="line">2657                                 rehash;
</div><div id="_line2658" class="line">2658                             <span class="keyword">catch</span>
</div><div id="_line2659" class="line">2659                                 <span class="comment">% Error downloading: inform the user</span>
</div><div id="_line2660" class="line">2660                                 msgbox([<span class="string">'Error in downloading: '</span> lasterr], <span class="string">'UIInspect'</span>, <span class="string">'warn'</span>);  <span class="comment">%#ok</span>
</div><div id="_line2661" class="line">2661                                 web(baseUrl);
</div><div id="_line2662" class="line">2662                             <span class="keyword">end</span>
</div><div id="_line2663" class="line">2663 
</div><div id="_line2664" class="line">2664                             <span class="comment">% ...and now run it...</span>
</div><div id="_line2665" class="line">2665                             <span class="comment">%pause(0.1);</span>
</div><div id="_line2666" class="line">2666                             drawnow;
</div><div id="_line2667" class="line">2667                             dummy = which(<span class="string">'uiinspect'</span>);  <span class="comment">%#ok used only to load into memory</span>
</div><div id="_line2668" class="line">2668                             uiinspect(object);
</div><div id="_line2669" class="line">2669                             <span class="keyword">return</span>;
</div><div id="_line2670" class="line">2670 
</div><div id="_line2671" class="line">2671                         <span class="keyword">case</span> <span class="string">'No &amp; never ask again'</span>   <span class="comment">% =&gt; No &amp; don't ask again</span>
</div><div id="_line2672" class="line">2672                             setpref(<span class="string">'FindJObj'</span>,<span class="string">'dontCheckUIInspect'</span>,1);
</div><div id="_line2673" class="line">2673 
</div><div id="_line2674" class="line">2674                         <span class="keyword">otherwise</span>
</div><div id="_line2675" class="line">2675                             <span class="comment">% forget it...</span>
</div><div id="_line2676" class="line">2676                     <span class="keyword">end</span>
</div><div id="_line2677" class="line">2677                 <span class="keyword">end</span>
</div><div id="_line2678" class="line">2678                 drawnow;
</div><div id="_line2679" class="line">2679 
</div><div id="_line2680" class="line">2680                 <span class="comment">% No UIINSPECT available - run the good-ol' METHODSVIEW()...</span>
</div><div id="_line2681" class="line">2681                 methodsview(object);
</div><div id="_line2682" class="line">2682             <span class="keyword">else</span>
</div><div id="_line2683" class="line">2683                 uiinspect(object);
</div><div id="_line2684" class="line">2684             <span class="keyword">end</span>
</div><div id="_line2685" class="line">2685         <span class="keyword">catch</span>
</div><div id="_line2686" class="line">2686             <span class="keyword">try</span>
</div><div id="_line2687" class="line">2687                 <span class="keyword">if</span> isjava(object)
</div><div id="_line2688" class="line">2688                     methodsview(object)
</div><div id="_line2689" class="line">2689                 <span class="keyword">else</span>
</div><div id="_line2690" class="line">2690                     methodsview(object.java);
</div><div id="_line2691" class="line">2691                 <span class="keyword">end</span>
</div><div id="_line2692" class="line">2692             <span class="keyword">catch</span>
</div><div id="_line2693" class="line">2693                 <span class="comment">% Never mind...</span>
</div><div id="_line2694" class="line">2694                 <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2695" class="line">2695             <span class="keyword">end</span>
</div><div id="_line2696" class="line">2696         <span class="keyword">end</span>
</div><div id="_line2697" class="line">2697     <span class="keyword">end</span>
</div><div id="_line2698" class="line">2698 
</div><div id="_line2699" class="line">2699     <span class="comment">%% Callback function for &lt;Check for updates&gt; button</span>
</div><div id="_line2700" class="line">2700     <a name="_sub44" href="#_subfunctions" class="code">function btCheckFex_Callback(src, evd, varargin)  </a><span class="comment">%#ok</span>
</div><div id="_line2701" class="line">2701         <span class="keyword">try</span>
</div><div id="_line2702" class="line">2702             <span class="comment">% Check the FileExchange for the latest version</span>
</div><div id="_line2703" class="line">2703             web(<span class="string">'http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=14317'</span>);
</div><div id="_line2704" class="line">2704         <span class="keyword">catch</span>
</div><div id="_line2705" class="line">2705             <span class="comment">% Never mind...</span>
</div><div id="_line2706" class="line">2706             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2707" class="line">2707         <span class="keyword">end</span>
</div><div id="_line2708" class="line">2708     <span class="keyword">end</span>
</div><div id="_line2709" class="line">2709 
</div><div id="_line2710" class="line">2710     <span class="comment">%% Check for existence of a newer version</span>
</div><div id="_line2711" class="line">2711     <a name="_sub45" href="#_subfunctions" class="code">function checkVersion()</a>
</div><div id="_line2712" class="line">2712         <span class="keyword">try</span>
</div><div id="_line2713" class="line">2713             <span class="comment">% If the user has not indicated NOT to be informed</span>
</div><div id="_line2714" class="line">2714             <span class="keyword">if</span> ~ispref(<span class="string">'FindJObj'</span>,<span class="string">'dontCheckNewerVersion'</span>)
</div><div id="_line2715" class="line">2715 
</div><div id="_line2716" class="line">2716                 <span class="comment">% Get the latest version date from the File Exchange webpage</span>
</div><div id="_line2717" class="line">2717                 baseUrl = <span class="string">'http://www.mathworks.com/matlabcentral/fileexchange/'</span>;
</div><div id="_line2718" class="line">2718                 webUrl = [baseUrl <span class="string">'14317'</span>];  <span class="comment">% 'loadFile.do?objectId=14317'];</span>
</div><div id="_line2719" class="line">2719                 webPage = urlread(webUrl);
</div><div id="_line2720" class="line">2720                 modIdx = strfind(webPage,<span class="string">'&gt;Updates&lt;'</span>);
</div><div id="_line2721" class="line">2721                 <span class="keyword">if</span> ~isempty(modIdx)
</div><div id="_line2722" class="line">2722                     webPage = webPage(modIdx:end);
</div><div id="_line2723" class="line">2723                     <span class="comment">% Note: regexp hangs if substr not found, so use strfind instead...</span>
</div><div id="_line2724" class="line">2724                     <span class="comment">%latestWebVersion = regexprep(webPage,'.*?&gt;(20[\d-]+)&lt;/td&gt;.*','$1');</span>
</div><div id="_line2725" class="line">2725                     dateIdx = strfind(webPage,<span class="string">'class=&quot;date&quot;&gt;'</span>);
</div><div id="_line2726" class="line">2726                     <span class="keyword">if</span> ~isempty(dateIdx)
</div><div id="_line2727" class="line">2727                         latestDate = webPage(dateIdx(end)+13 : dateIdx(end)+23);
</div><div id="_line2728" class="line">2728                         <span class="keyword">try</span>
</div><div id="_line2729" class="line">2729                             startIdx = dateIdx(end)+27;
</div><div id="_line2730" class="line">2730                             descStartIdx = startIdx + strfind(webPage(startIdx:startIdx+999),<span class="string">'&lt;td&gt;'</span>);
</div><div id="_line2731" class="line">2731                             descEndIdx   = startIdx + strfind(webPage(startIdx:startIdx+999),<span class="string">'&lt;/td&gt;'</span>);
</div><div id="_line2732" class="line">2732                             descStr = webPage(descStartIdx(1)+3 : descEndIdx(1)-2);
</div><div id="_line2733" class="line">2733                             descStr = regexprep(descStr,<span class="string">'&lt;/?[pP]&gt;'</span>,<span class="string">''</span>);
</div><div id="_line2734" class="line">2734                         <span class="keyword">catch</span>
</div><div id="_line2735" class="line">2735                             descStr = <span class="string">''</span>;
</div><div id="_line2736" class="line">2736                         <span class="keyword">end</span>
</div><div id="_line2737" class="line">2737 
</div><div id="_line2738" class="line">2738                         <span class="comment">% Get this file's latest date</span>
</div><div id="_line2739" class="line">2739                         thisFileName = which(mfilename);  <span class="comment">%#ok</span>
</div><div id="_line2740" class="line">2740                         <span class="keyword">try</span>
</div><div id="_line2741" class="line">2741                             thisFileData = dir(thisFileName);
</div><div id="_line2742" class="line">2742                             <span class="keyword">try</span>
</div><div id="_line2743" class="line">2743                                 thisFileDatenum = thisFileData.datenum;
</div><div id="_line2744" class="line">2744                             <span class="keyword">catch</span>  <span class="comment">% old ML versions...</span>
</div><div id="_line2745" class="line">2745                                 thisFileDatenum = datenum(thisFileData.date);
</div><div id="_line2746" class="line">2746                             <span class="keyword">end</span>
</div><div id="_line2747" class="line">2747                         <span class="keyword">catch</span>
</div><div id="_line2748" class="line">2748                             thisFileText = evalc(<span class="string">'type(thisFileName)'</span>);
</div><div id="_line2749" class="line">2749                             thisFileLatestDate = regexprep(thisFileText,<span class="string">'.*Change log:[\s%]+([\d-]+).*'</span>,<span class="string">'$1'</span>);
</div><div id="_line2750" class="line">2750                             thisFileDatenum = datenum(thisFileLatestDate,<span class="string">'yyyy-mm-dd'</span>);
</div><div id="_line2751" class="line">2751                         <span class="keyword">end</span>
</div><div id="_line2752" class="line">2752 
</div><div id="_line2753" class="line">2753                         <span class="comment">% If there's a newer version on the File Exchange webpage (allow 2 days grace period)</span>
</div><div id="_line2754" class="line">2754                         <span class="keyword">if</span> (thisFileDatenum &lt; datenum(latestDate,<span class="string">'dd mmm yyyy'</span>)-2)
</div><div id="_line2755" class="line">2755 
</div><div id="_line2756" class="line">2756                             <span class="comment">% Ask the user whether to download the newer version (YES, no, no &amp; don't ask again)</span>
</div><div id="_line2757" class="line">2757                             msg = {[<span class="string">'A newer version ('</span> latestDate <span class="string">') of FindJObj is available on the MathWorks File Exchange:'</span>], <span class="string">''</span>, <span class="keyword">...</span>
</div><div id="_line2758" class="line">2758                                    [<span class="string">'\color{blue}'</span> descStr <span class="string">'\color{black}'</span>], <span class="string">''</span>, <span class="keyword">...</span>
</div><div id="_line2759" class="line">2759                                    <span class="string">'Download &amp; install the new version?'</span>};
</div><div id="_line2760" class="line">2760                             createStruct.Interpreter = <span class="string">'tex'</span>;
</div><div id="_line2761" class="line">2761                             createStruct.Default = <span class="string">'Yes'</span>;
</div><div id="_line2762" class="line">2762                             answer = questdlg(msg,<span class="string">'FindJObj'</span>,<span class="string">'Yes'</span>,<span class="string">'No'</span>,<span class="string">'No &amp; never ask again'</span>,createStruct);
</div><div id="_line2763" class="line">2763                             <span class="keyword">switch</span> answer
</div><div id="_line2764" class="line">2764                                 <span class="keyword">case</span> <span class="string">'Yes'</span>  <span class="comment">% =&gt; Yes: download &amp; install newer file</span>
</div><div id="_line2765" class="line">2765                                     <span class="keyword">try</span>
</div><div id="_line2766" class="line">2766                                         <span class="comment">%fileUrl = [baseUrl '/download.do?objectId=14317&amp;fn=findjobj&amp;fe=.m'];</span>
</div><div id="_line2767" class="line">2767                                         fileUrl = [baseUrl <span class="string">'/14317?controller=file_infos&amp;download=true'</span>];
</div><div id="_line2768" class="line">2768                                         <span class="comment">%file = urlread(fileUrl);</span>
</div><div id="_line2769" class="line">2769                                         <span class="comment">%file = regexprep(file,[char(13),char(10)],'\n');  %convert to OS-dependent EOL</span>
</div><div id="_line2770" class="line">2770                                         <span class="comment">%fid = fopen(thisFileName,'wt');</span>
</div><div id="_line2771" class="line">2771                                         <span class="comment">%fprintf(fid,'%s',file);</span>
</div><div id="_line2772" class="line">2772                                         <span class="comment">%fclose(fid);</span>
</div><div id="_line2773" class="line">2773                                         [fpath,fname,fext] = fileparts(thisFileName);
</div><div id="_line2774" class="line">2774                                         zipFileName = fullfile(fpath,[fname <span class="string">'.zip'</span>]);
</div><div id="_line2775" class="line">2775                                         urlwrite(fileUrl,zipFileName);
</div><div id="_line2776" class="line">2776                                         unzip(zipFileName,fpath);
</div><div id="_line2777" class="line">2777                                         rehash;
</div><div id="_line2778" class="line">2778                                     <span class="keyword">catch</span>
</div><div id="_line2779" class="line">2779                                         <span class="comment">% Error downloading: inform the user</span>
</div><div id="_line2780" class="line">2780                                         msgbox([<span class="string">'Error in downloading: '</span> lasterr], <span class="string">'FindJObj'</span>, <span class="string">'warn'</span>);  <span class="comment">%#ok</span>
</div><div id="_line2781" class="line">2781                                         web(webUrl);
</div><div id="_line2782" class="line">2782                                     <span class="keyword">end</span>
</div><div id="_line2783" class="line">2783                                 <span class="keyword">case</span> <span class="string">'No &amp; never ask again'</span>   <span class="comment">% =&gt; No &amp; don't ask again</span>
</div><div id="_line2784" class="line">2784                                     setpref(<span class="string">'FindJObj'</span>,<span class="string">'dontCheckNewerVersion'</span>,1);
</div><div id="_line2785" class="line">2785                                 <span class="keyword">otherwise</span>
</div><div id="_line2786" class="line">2786                                     <span class="comment">% forget it...</span>
</div><div id="_line2787" class="line">2787                             <span class="keyword">end</span>
</div><div id="_line2788" class="line">2788                         <span class="keyword">end</span>
</div><div id="_line2789" class="line">2789                     <span class="keyword">end</span>
</div><div id="_line2790" class="line">2790                 <span class="keyword">else</span>
</div><div id="_line2791" class="line">2791                     <span class="comment">% Maybe webpage not fully loaded or changed format - bail out...</span>
</div><div id="_line2792" class="line">2792                 <span class="keyword">end</span>
</div><div id="_line2793" class="line">2793             <span class="keyword">end</span>
</div><div id="_line2794" class="line">2794         <span class="keyword">catch</span>
</div><div id="_line2795" class="line">2795             <span class="comment">% Never mind...</span>
</div><div id="_line2796" class="line">2796         <span class="keyword">end</span>
</div><div id="_line2797" class="line">2797     <span class="keyword">end</span>
</div><div id="_line2798" class="line">2798 
</div><div id="_line2799" class="line">2799     <span class="comment">%% Get the first selected object (might not be the top one - depends on selection order)</span>
</div><div id="_line2800" class="line">2800     <a name="_sub46" href="#_subfunctions" class="code">function object = getTopSelectedObject(jTree, root)</a>
</div><div id="_line2801" class="line">2801         <span class="keyword">try</span>
</div><div id="_line2802" class="line">2802             object = [];
</div><div id="_line2803" class="line">2803             numSelections  = jTree.getSelectionCount;
</div><div id="_line2804" class="line">2804             <span class="keyword">if</span> numSelections &gt; 0
</div><div id="_line2805" class="line">2805                 <span class="comment">% Get the first object specified</span>
</div><div id="_line2806" class="line">2806                 <span class="comment">%object = jTree.getSelectionPath.getLastPathComponent.getUserObject;</span>
</div><div id="_line2807" class="line">2807                 nodedata = get(jTree.getSelectionPath.getLastPathComponent,<span class="string">'userdata'</span>);
</div><div id="_line2808" class="line">2808             <span class="keyword">else</span>
</div><div id="_line2809" class="line">2809                 <span class="comment">% Get the root object (container)</span>
</div><div id="_line2810" class="line">2810                 <span class="comment">%object = root.getUserObject;</span>
</div><div id="_line2811" class="line">2811                 nodedata = get(root,<span class="string">'userdata'</span>);
</div><div id="_line2812" class="line">2812             <span class="keyword">end</span>
</div><div id="_line2813" class="line">2813             object = nodedata.obj;
</div><div id="_line2814" class="line">2814         <span class="keyword">catch</span>
</div><div id="_line2815" class="line">2815             <span class="comment">% Never mind...</span>
</div><div id="_line2816" class="line">2816             <a href="#_sub51" class="code" title="subdispError">dispError</a>
</div><div id="_line2817" class="line">2817         <span class="keyword">end</span>
</div><div id="_line2818" class="line">2818     <span class="keyword">end</span>
</div><div id="_line2819" class="line">2819 
</div><div id="_line2820" class="line">2820     <span class="comment">%% Update component callback upon callbacksTable data change</span>
</div><div id="_line2821" class="line">2821     <a name="_sub47" href="#_subfunctions" class="code">function tbCallbacksChanged(src, evd, object, table)</a>
</div><div id="_line2822" class="line">2822         <span class="keyword">persistent</span> hash
</div><div id="_line2823" class="line">2823         <span class="keyword">try</span>
</div><div id="_line2824" class="line">2824             <span class="comment">% exit if invalid handle or already in Callback</span>
</div><div id="_line2825" class="line">2825             <span class="comment">%if ~ishandle(src) || ~isempty(getappdata(src,'inCallback')) % || length(dbstack)&gt;1  %exit also if not called from user action</span>
</div><div id="_line2826" class="line">2826             <span class="keyword">if</span> isempty(hash), hash = java.util.Hashtable;  <span class="keyword">end</span>
</div><div id="_line2827" class="line">2827             <span class="keyword">if</span> ~ishandle(src) || ~isempty(hash.get(src)) <span class="comment">% || length(dbstack)&gt;1  %exit also if not called from user action</span>
</div><div id="_line2828" class="line">2828                 <span class="keyword">return</span>;
</div><div id="_line2829" class="line">2829             <span class="keyword">end</span>
</div><div id="_line2830" class="line">2830             <span class="comment">%setappdata(src,'inCallback',1);  % used to prevent endless recursion   % can't use getappdata(src,...) because it fails on R2010b!!!</span>
</div><div id="_line2831" class="line">2831             hash.put(src,1);
</div><div id="_line2832" class="line">2832 
</div><div id="_line2833" class="line">2833             <span class="comment">% Update the object's callback with the modified value</span>
</div><div id="_line2834" class="line">2834             modifiedColIdx = evd.getColumn;
</div><div id="_line2835" class="line">2835             modifiedRowIdx = evd.getFirstRow;
</div><div id="_line2836" class="line">2836             <span class="keyword">if</span> modifiedRowIdx&gt;=0 <span class="comment">%&amp;&amp; modifiedColIdx==1  %sanity check - should always be true</span>
</div><div id="_line2837" class="line">2837                 <span class="comment">%table = evd.getSource;</span>
</div><div id="_line2838" class="line">2838                 <span class="comment">%object = get(src,'userdata');</span>
</div><div id="_line2839" class="line">2839                 modifiedRowIdx = table.getSelectedRow;  <span class="comment">% overcome issues with hierarchical table</span>
</div><div id="_line2840" class="line">2840                 cbName = strtrim(table.getValueAt(modifiedRowIdx,0));
</div><div id="_line2841" class="line">2841                 <span class="keyword">try</span>
</div><div id="_line2842" class="line">2842                     cbValue = strtrim(char(table.getValueAt(modifiedRowIdx,1)));
</div><div id="_line2843" class="line">2843                     <span class="keyword">if</span> ~isempty(cbValue) &amp;&amp; ismember(cbValue(1),<span class="string">'{[@'''</span>)
</div><div id="_line2844" class="line">2844                         cbValue = eval(cbValue);
</div><div id="_line2845" class="line">2845                     <span class="keyword">end</span>
</div><div id="_line2846" class="line">2846                     <span class="keyword">if</span> (~<a href="#_sub52" class="code" title="subischar">ischar</a>(cbValue) &amp;&amp; ~isa(cbValue, <span class="string">'function_handle'</span>) &amp;&amp; (~iscell(cbValue) || iscom(object(1))))
</div><div id="_line2847" class="line">2847                         <a href="#_sub48" class="code" title="subrevertCbTableModification">revertCbTableModification</a>(table, modifiedRowIdx, modifiedColIdx, cbName, object, <span class="string">''</span>);
</div><div id="_line2848" class="line">2848                     <span class="keyword">else</span>
</div><div id="_line2849" class="line">2849                         <span class="keyword">for</span> objIdx = 1 : length(object)
</div><div id="_line2850" class="line">2850                             obj = object(objIdx);
</div><div id="_line2851" class="line">2851                             <span class="keyword">if</span> ~iscom(obj)
</div><div id="_line2852" class="line">2852                                 <span class="keyword">try</span>
</div><div id="_line2853" class="line">2853                                     <span class="keyword">try</span>
</div><div id="_line2854" class="line">2854                                         <span class="keyword">if</span> isjava(obj)
</div><div id="_line2855" class="line">2855                                             obj = handle(obj,<span class="string">'CallbackProperties'</span>);
</div><div id="_line2856" class="line">2856                                         <span class="keyword">end</span>
</div><div id="_line2857" class="line">2857                                     <span class="keyword">catch</span>
</div><div id="_line2858" class="line">2858                                         <span class="comment">% never mind...</span>
</div><div id="_line2859" class="line">2859                                     <span class="keyword">end</span>
</div><div id="_line2860" class="line">2860                                     set(obj, cbName, cbValue);
</div><div id="_line2861" class="line">2861                                 <span class="keyword">catch</span>
</div><div id="_line2862" class="line">2862                                     <span class="keyword">try</span>
</div><div id="_line2863" class="line">2863                                         set(handle(obj,<span class="string">'CallbackProperties'</span>), cbName, cbValue);
</div><div id="_line2864" class="line">2864                                     <span class="keyword">catch</span>
</div><div id="_line2865" class="line">2865                                         <span class="comment">% never mind - probably a callback-group header</span>
</div><div id="_line2866" class="line">2866                                     <span class="keyword">end</span>
</div><div id="_line2867" class="line">2867                                 <span class="keyword">end</span>
</div><div id="_line2868" class="line">2868                             <span class="keyword">else</span>
</div><div id="_line2869" class="line">2869                                 cbs = obj.eventlisteners;
</div><div id="_line2870" class="line">2870                                 <span class="keyword">if</span> ~isempty(cbs)
</div><div id="_line2871" class="line">2871                                     cbs = cbs(strcmpi(cbs(:,1),cbName),:);
</div><div id="_line2872" class="line">2872                                     obj.unregisterevent(cbs);
</div><div id="_line2873" class="line">2873                                 <span class="keyword">end</span>
</div><div id="_line2874" class="line">2874                                 <span class="keyword">if</span> ~isempty(cbValue) &amp;&amp; ~strcmp(cbName,<span class="string">'-'</span>)
</div><div id="_line2875" class="line">2875                                     obj.registerevent({cbName, cbValue});
</div><div id="_line2876" class="line">2876                                 <span class="keyword">end</span>
</div><div id="_line2877" class="line">2877                             <span class="keyword">end</span>
</div><div id="_line2878" class="line">2878                         <span class="keyword">end</span>
</div><div id="_line2879" class="line">2879                     <span class="keyword">end</span>
</div><div id="_line2880" class="line">2880                 <span class="keyword">catch</span>
</div><div id="_line2881" class="line">2881                     <a href="#_sub48" class="code" title="subrevertCbTableModification">revertCbTableModification</a>(table, modifiedRowIdx, modifiedColIdx, cbName, object, lasterr)  <span class="comment">%#ok</span>
</div><div id="_line2882" class="line">2882                 <span class="keyword">end</span>
</div><div id="_line2883" class="line">2883             <span class="keyword">end</span>
</div><div id="_line2884" class="line">2884         <span class="keyword">catch</span>
</div><div id="_line2885" class="line">2885             <span class="comment">% never mind...</span>
</div><div id="_line2886" class="line">2886         <span class="keyword">end</span>
</div><div id="_line2887" class="line">2887         <span class="comment">%setappdata(src,'inCallback',[]);  % used to prevent endless recursion   % can't use setappdata(src,...) because it fails on R2010b!!!</span>
</div><div id="_line2888" class="line">2888         hash.remove(src);
</div><div id="_line2889" class="line">2889     <span class="keyword">end</span>
</div><div id="_line2890" class="line">2890 
</div><div id="_line2891" class="line">2891     <span class="comment">%% Revert Callback table modification</span>
</div><div id="_line2892" class="line">2892     <a name="_sub48" href="#_subfunctions" class="code">function revertCbTableModification(table, modifiedRowIdx, modifiedColIdx, cbName, object, errMsg)  </a><span class="comment">%#ok</span>
</div><div id="_line2893" class="line">2893         <span class="keyword">try</span>
</div><div id="_line2894" class="line">2894             <span class="comment">% Display a notification MsgBox</span>
</div><div id="_line2895" class="line">2895             msg = <span class="string">'Callbacks must be a ''string'', or a @function handle'</span>;
</div><div id="_line2896" class="line">2896             <span class="keyword">if</span> ~iscom(object(1)),  msg = [msg <span class="string">' or a {@func,args...} construct'</span>];  <span class="keyword">end</span>
</div><div id="_line2897" class="line">2897             <span class="keyword">if</span> ~isempty(errMsg),  msg = {errMsg, <span class="string">''</span>, msg};  <span class="keyword">end</span>
</div><div id="_line2898" class="line">2898             msgbox(msg, [<span class="string">'Error setting '</span> cbName <span class="string">' value'</span>], <span class="string">'warn'</span>);
</div><div id="_line2899" class="line">2899 
</div><div id="_line2900" class="line">2900             <span class="comment">% Revert to the current value</span>
</div><div id="_line2901" class="line">2901             curValue = <span class="string">''</span>;
</div><div id="_line2902" class="line">2902             <span class="keyword">try</span>
</div><div id="_line2903" class="line">2903                 <span class="keyword">if</span> ~iscom(object(1))
</div><div id="_line2904" class="line">2904                     curValue = <a href="#_sub16" class="code" title="subcharizeData">charizeData</a>(get(object(1),cbName));
</div><div id="_line2905" class="line">2905                 <span class="keyword">else</span>
</div><div id="_line2906" class="line">2906                     cbs = object(1).eventlisteners;
</div><div id="_line2907" class="line">2907                     <span class="keyword">if</span> ~isempty(cbs)
</div><div id="_line2908" class="line">2908                         cbs = cbs(strcmpi(cbs(:,1),cbName),:);
</div><div id="_line2909" class="line">2909                         curValue = <a href="#_sub16" class="code" title="subcharizeData">charizeData</a>(cbs(1,2));
</div><div id="_line2910" class="line">2910                     <span class="keyword">end</span>
</div><div id="_line2911" class="line">2911                 <span class="keyword">end</span>
</div><div id="_line2912" class="line">2912             <span class="keyword">catch</span>
</div><div id="_line2913" class="line">2913                 <span class="comment">% never mind... - clear the current value</span>
</div><div id="_line2914" class="line">2914             <span class="keyword">end</span>
</div><div id="_line2915" class="line">2915             table.setValueAt(curValue, modifiedRowIdx, modifiedColIdx);
</div><div id="_line2916" class="line">2916         <span class="keyword">catch</span>
</div><div id="_line2917" class="line">2917             <span class="comment">% never mind...</span>
</div><div id="_line2918" class="line">2918         <span class="keyword">end</span>
</div><div id="_line2919" class="line">2919     <span class="keyword">end</span>  <span class="comment">% revertCbTableModification</span>
</div><div id="_line2920" class="line">2920 
</div><div id="_line2921" class="line">2921     <span class="comment">%% Get the Java positions of all HG text labels</span>
</div><div id="_line2922" class="line">2922     <a name="_sub49" href="#_subfunctions" class="code">function labelPositions = getLabelsJavaPos(container)</a>
</div><div id="_line2923" class="line">2923         <span class="keyword">try</span>
</div><div id="_line2924" class="line">2924             labelPositions = [];
</div><div id="_line2925" class="line">2925 
</div><div id="_line2926" class="line">2926             <span class="comment">% Ensure we have a figure handle</span>
</div><div id="_line2927" class="line">2927             <span class="keyword">try</span>
</div><div id="_line2928" class="line">2928                 h = hFig;  <span class="comment">%#ok unused</span>
</div><div id="_line2929" class="line">2929             <span class="keyword">catch</span>
</div><div id="_line2930" class="line">2930                 hFig = <a href="#_sub3" class="code" title="subgetCurrentFigure">getCurrentFigure</a>;
</div><div id="_line2931" class="line">2931             <span class="keyword">end</span>
</div><div id="_line2932" class="line">2932 
</div><div id="_line2933" class="line">2933             <span class="comment">% Get the figure's margins from the Matlab properties</span>
</div><div id="_line2934" class="line">2934             hg_labels = findall(hFig, <span class="string">'Style'</span>,<span class="string">'text'</span>);
</div><div id="_line2935" class="line">2935             units = get(hFig,<span class="string">'units'</span>);
</div><div id="_line2936" class="line">2936             set(hFig,<span class="string">'units'</span>,<span class="string">'pixels'</span>);
</div><div id="_line2937" class="line">2937             outerPos = get(hFig,<span class="string">'OuterPosition'</span>);
</div><div id="_line2938" class="line">2938             innerPos = get(hFig,<span class="string">'Position'</span>);
</div><div id="_line2939" class="line">2939             set(hFig,<span class="string">'units'</span>,units);
</div><div id="_line2940" class="line">2940             margins = abs(innerPos-outerPos);
</div><div id="_line2941" class="line">2941 
</div><div id="_line2942" class="line">2942             figX = container.getX;        <span class="comment">% =outerPos(1)</span>
</div><div id="_line2943" class="line">2943             figY = container.getY;        <span class="comment">% =outerPos(2)</span>
</div><div id="_line2944" class="line">2944             <span class="comment">%figW = container.getWidth;   % =outerPos(3)</span>
</div><div id="_line2945" class="line">2945             figH = container.getHeight;   <span class="comment">% =outerPos(4)</span>
</div><div id="_line2946" class="line">2946 
</div><div id="_line2947" class="line">2947             <span class="comment">% Get the relevant screen pixel size</span>
</div><div id="_line2948" class="line">2948             <span class="comment">%monitorPositions = get(0,'MonitorPositions');</span>
</div><div id="_line2949" class="line">2949             <span class="comment">%for monitorIdx = size(monitorPositions,1) : -1 : 1</span>
</div><div id="_line2950" class="line">2950             <span class="comment">%    screenSize = monitorPositions(monitorIdx,:);</span>
</div><div id="_line2951" class="line">2951             <span class="comment">%    if (outerPos(1) &gt;= screenSize(1)) % &amp;&amp; (outerPos(1)+outerPos(3) &lt;= screenSize(3))</span>
</div><div id="_line2952" class="line">2952             <span class="comment">%        break;</span>
</div><div id="_line2953" class="line">2953             <span class="comment">%    end</span>
</div><div id="_line2954" class="line">2954             <span class="comment">%end</span>
</div><div id="_line2955" class="line">2955             <span class="comment">%monitorBaseY = screenSize(4) - monitorPositions(1,4);</span>
</div><div id="_line2956" class="line">2956 
</div><div id="_line2957" class="line">2957             <span class="comment">% Compute the labels' screen pixel position in Java units ([0,0] = top left)</span>
</div><div id="_line2958" class="line">2958             <span class="keyword">for</span> idx = 1 : length(hg_labels)
</div><div id="_line2959" class="line">2959                 matlabPos = getpixelposition(hg_labels(idx),1);
</div><div id="_line2960" class="line">2960                 javaX = figX + matlabPos(1) + margins(1);
</div><div id="_line2961" class="line">2961                 javaY = figY + figH - matlabPos(2) - matlabPos(4) - margins(2);
</div><div id="_line2962" class="line">2962                 labelPositions(idx,:) = [javaX, javaY, matlabPos(3:4)];  <span class="comment">%#ok grow</span>
</div><div id="_line2963" class="line">2963             <span class="keyword">end</span>
</div><div id="_line2964" class="line">2964         <span class="keyword">catch</span>
</div><div id="_line2965" class="line">2965             <span class="comment">% never mind...</span>
</div><div id="_line2966" class="line">2966             err = lasterror;  <span class="comment">%#ok debug point</span>
</div><div id="_line2967" class="line">2967         <span class="keyword">end</span>
</div><div id="_line2968" class="line">2968     <span class="keyword">end</span>
</div><div id="_line2969" class="line">2969 
</div><div id="_line2970" class="line">2970     <span class="comment">%% Traverse an HG container hierarchy and extract the HG elements within</span>
</div><div id="_line2971" class="line">2971     <a name="_sub50" href="#_subfunctions" class="code">function traverseHGContainer(hcontainer,level,parent)</a>
</div><div id="_line2972" class="line">2972         <span class="keyword">try</span>
</div><div id="_line2973" class="line">2973             <span class="comment">% Record the data for this node</span>
</div><div id="_line2974" class="line">2974             thisIdx = length(hg_levels) + 1;
</div><div id="_line2975" class="line">2975             hg_levels(thisIdx) = level;
</div><div id="_line2976" class="line">2976             hg_parentIdx(thisIdx) = parent;
</div><div id="_line2977" class="line">2977             <span class="keyword">try</span>
</div><div id="_line2978" class="line">2978                 hg_handles(thisIdx) = handle(hcontainer);
</div><div id="_line2979" class="line">2979             <span class="keyword">catch</span>
</div><div id="_line2980" class="line">2980                 hg_handles = handle(hcontainer);
</div><div id="_line2981" class="line">2981             <span class="keyword">end</span>
</div><div id="_line2982" class="line">2982             parentId = length(hg_parentIdx);
</div><div id="_line2983" class="line">2983 
</div><div id="_line2984" class="line">2984             <span class="comment">% Now recursively process all this node's children (if any)</span>
</div><div id="_line2985" class="line">2985             <span class="comment">%if ishghandle(hcontainer)</span>
</div><div id="_line2986" class="line">2986             <span class="keyword">try</span>  <span class="comment">% try-catch is faster than checking ishghandle(hcontainer)...</span>
</div><div id="_line2987" class="line">2987                 allChildren = allchild(handle(hcontainer));
</div><div id="_line2988" class="line">2988                 <span class="keyword">for</span> childIdx = 1 : length(allChildren)
</div><div id="_line2989" class="line">2989                     <a href="#_sub50" class="code" title="subtraverseHGContainer">traverseHGContainer</a>(allChildren(childIdx),level+1,parentId);
</div><div id="_line2990" class="line">2990                 <span class="keyword">end</span>
</div><div id="_line2991" class="line">2991             <span class="keyword">catch</span>
</div><div id="_line2992" class="line">2992                 <span class="comment">% do nothing - probably not a container</span>
</div><div id="_line2993" class="line">2993                 <span class="comment">%dispError</span>
</div><div id="_line2994" class="line">2994             <span class="keyword">end</span>
</div><div id="_line2995" class="line">2995 
</div><div id="_line2996" class="line">2996             <span class="comment">% TODO: Add axis (plot) component handles</span>
</div><div id="_line2997" class="line">2997         <span class="keyword">catch</span>
</div><div id="_line2998" class="line">2998             <span class="comment">% forget it...</span>
</div><div id="_line2999" class="line">2999         <span class="keyword">end</span>
</div><div id="_line3000" class="line">3000     <span class="keyword">end</span>
</div><div id="_line3001" class="line">3001 
</div><div id="_line3002" class="line">3002     <span class="comment">%% Debuggable &quot;quiet&quot; error-handling</span>
</div><div id="_line3003" class="line">3003     <a name="_sub51" href="#_subfunctions" class="code">function dispError</a>
</div><div id="_line3004" class="line">3004         err = lasterror;  <span class="comment">%#ok</span>
</div><div id="_line3005" class="line">3005         msg = err.message;
</div><div id="_line3006" class="line">3006         <span class="keyword">for</span> idx = 1 : length(err.stack)
</div><div id="_line3007" class="line">3007             filename = err.stack(idx).file;
</div><div id="_line3008" class="line">3008             <span class="keyword">if</span> ~isempty(regexpi(filename,mfilename))
</div><div id="_line3009" class="line">3009                 funcname = err.stack(idx).name;
</div><div id="_line3010" class="line">3010                 line = num2str(err.stack(idx).line);
</div><div id="_line3011" class="line">3011                 msg = [msg <span class="string">' at &lt;a href=&quot;matlab:opentoline('''</span> filename <span class="string">''','</span> line <span class="string">');&quot;&gt;'</span> funcname <span class="string">' line #'</span> line <span class="string">'&lt;/a&gt;'</span>]; <span class="comment">%#ok grow</span>
</div><div id="_line3012" class="line">3012                 <span class="keyword">break</span>;
</div><div id="_line3013" class="line">3013             <span class="keyword">end</span>
</div><div id="_line3014" class="line">3014         <span class="keyword">end</span>
</div><div id="_line3015" class="line">3015         disp(msg);
</div><div id="_line3016" class="line">3016         <span class="keyword">return</span>;  <span class="comment">% debug point</span>
</div><div id="_line3017" class="line">3017     <span class="keyword">end</span>
</div><div id="_line3018" class="line">3018 
</div><div id="_line3019" class="line">3019     <span class="comment">%% ML 7.0 - compatible ischar() function</span>
</div><div id="_line3020" class="line">3020     <a name="_sub52" href="#_subfunctions" class="code">function flag = ischar(data)</a>
</div><div id="_line3021" class="line">3021         <span class="keyword">try</span>
</div><div id="_line3022" class="line">3022             flag = builtin(<span class="string">'ischar'</span>,data);
</div><div id="_line3023" class="line">3023         <span class="keyword">catch</span>
</div><div id="_line3024" class="line">3024             flag = isa(data,<span class="string">'char'</span>);
</div><div id="_line3025" class="line">3025         <span class="keyword">end</span>
</div><div id="_line3026" class="line">3026     <span class="keyword">end</span>
</div><div id="_line3027" class="line">3027 
</div><div id="_line3028" class="line">3028     <span class="comment">%% Set up the uitree context (right-click) menu</span>
</div><div id="_line3029" class="line">3029     <a name="_sub53" href="#_subfunctions" class="code">function jmenu = setTreeContextMenu(obj,node,tree_h)</a>
</div><div id="_line3030" class="line">3030           <span class="comment">% Prepare the context menu (note the use of HTML labels)</span>
</div><div id="_line3031" class="line">3031           import javax.swing.*
</div><div id="_line3032" class="line">3032           titleStr = <a href="#_sub56" class="code" title="subgetNodeTitleStr">getNodeTitleStr</a>(obj,node);
</div><div id="_line3033" class="line">3033           titleStr = regexprep(titleStr,<span class="string">'&lt;hr&gt;.*'</span>,<span class="string">''</span>);
</div><div id="_line3034" class="line">3034           menuItem0 = JMenuItem(titleStr);
</div><div id="_line3035" class="line">3035           menuItem0.setEnabled(false);
</div><div id="_line3036" class="line">3036           menuItem0.setArmed(false);
</div><div id="_line3037" class="line">3037           <span class="comment">%menuItem1 = JMenuItem('Export handle to findjobj_hdls');</span>
</div><div id="_line3038" class="line">3038           <span class="keyword">if</span> isjava(obj), prefix = <span class="string">'j'</span>;  <span class="keyword">else</span>,  prefix = <span class="string">'h'</span>;  <span class="keyword">end</span>  <span class="comment">%#ok&lt;NOCOM&gt;</span>
</div><div id="_line3039" class="line">3039           varname = strrep([prefix strtok(char(node.getName))], <span class="string">'$'</span>,<span class="string">'_'</span>);
</div><div id="_line3040" class="line">3040           varname = genvarname(varname);
</div><div id="_line3041" class="line">3041           varname(2) = upper(varname(2));  <span class="comment">% ensure lowerCamelCase</span>
</div><div id="_line3042" class="line">3042           menuItem1 = JMenuItem([<span class="string">'Export handle to '</span> varname]);
</div><div id="_line3043" class="line">3043           menuItem2 = JMenuItem(<span class="string">'Export handle to...'</span>);
</div><div id="_line3044" class="line">3044           menuItem3 = JMenuItem(<span class="string">'Request focus (bring to front)'</span>);
</div><div id="_line3045" class="line">3045           menuItem4 = JMenuItem(<span class="string">'Flash component borders'</span>);
</div><div id="_line3046" class="line">3046           menuItem5 = JMenuItem(<span class="string">'Display properties &amp; callbacks'</span>);
</div><div id="_line3047" class="line">3047           menuItem6 = JMenuItem(<span class="string">'Inspect object'</span>);
</div><div id="_line3048" class="line">3048 
</div><div id="_line3049" class="line">3049           <span class="comment">% Set the menu items' callbacks</span>
</div><div id="_line3050" class="line">3050           set(handle(menuItem1,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub41" class="code" title="subbtExport_Callback">btExport_Callback</a>,{obj,varname}});
</div><div id="_line3051" class="line">3051           set(handle(menuItem2,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub41" class="code" title="subbtExport_Callback">btExport_Callback</a>,{obj,[]}});
</div><div id="_line3052" class="line">3052           set(handle(menuItem3,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub58" class="code" title="subrequestFocus">requestFocus</a>,obj});
</div><div id="_line3053" class="line">3053           set(handle(menuItem4,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub28" class="code" title="subflashComponent">flashComponent</a>,{obj,0.2,3}});
</div><div id="_line3054" class="line">3054           set(handle(menuItem5,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub29" class="code" title="subnodeSelected">nodeSelected</a>,{tree_h,node}});
</div><div id="_line3055" class="line">3055           set(handle(menuItem6,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, {@<a href="#_sub43" class="code" title="subbtInspect_Callback">btInspect_Callback</a>,obj});
</div><div id="_line3056" class="line">3056 
</div><div id="_line3057" class="line">3057           <span class="comment">% Add all menu items to the context menu (with internal separator)</span>
</div><div id="_line3058" class="line">3058           jmenu = JPopupMenu;
</div><div id="_line3059" class="line">3059           jmenu.add(menuItem0);
</div><div id="_line3060" class="line">3060           jmenu.addSeparator;
</div><div id="_line3061" class="line">3061           handleValue=[];  <span class="keyword">try</span> handleValue = double(obj); <span class="keyword">catch</span>, <span class="keyword">end</span>;  <span class="comment">%#ok</span>
</div><div id="_line3062" class="line">3062           <span class="keyword">if</span> ~isempty(handleValue)
</div><div id="_line3063" class="line">3063               <span class="comment">% For valid HG handles only</span>
</div><div id="_line3064" class="line">3064               menuItem0a = JMenuItem(<span class="string">'Copy handle value to clipboard'</span>);
</div><div id="_line3065" class="line">3065               set(handle(menuItem0a,<span class="string">'CallbackProperties'</span>), <span class="string">'ActionPerformedCallback'</span>, sprintf(<span class="string">'clipboard(''copy'',%.99g)'</span>,handleValue));
</div><div id="_line3066" class="line">3066               jmenu.add(menuItem0a);
</div><div id="_line3067" class="line">3067           <span class="keyword">end</span>
</div><div id="_line3068" class="line">3068           jmenu.add(menuItem1);
</div><div id="_line3069" class="line">3069           jmenu.add(menuItem2);
</div><div id="_line3070" class="line">3070           jmenu.addSeparator;
</div><div id="_line3071" class="line">3071           jmenu.add(menuItem3);
</div><div id="_line3072" class="line">3072           jmenu.add(menuItem4);
</div><div id="_line3073" class="line">3073           jmenu.add(menuItem5);
</div><div id="_line3074" class="line">3074           jmenu.add(menuItem6);
</div><div id="_line3075" class="line">3075     <span class="keyword">end</span>  <span class="comment">% setTreeContextMenu</span>
</div><div id="_line3076" class="line">3076 
</div><div id="_line3077" class="line">3077     <span class="comment">%% Set the mouse-press callback</span>
</div><div id="_line3078" class="line">3078     <a name="_sub54" href="#_subfunctions" class="code">function treeMousePressedCallback(hTree, eventData, tree_h)  </a><span class="comment">%#ok hTree is unused</span>
</div><div id="_line3079" class="line">3079         <span class="keyword">if</span> eventData.isMetaDown  <span class="comment">% right-click is like a Meta-button</span>
</div><div id="_line3080" class="line">3080             <span class="comment">% Get the clicked node</span>
</div><div id="_line3081" class="line">3081             clickX = eventData.getX;
</div><div id="_line3082" class="line">3082             clickY = eventData.getY;
</div><div id="_line3083" class="line">3083             jtree = eventData.getSource;
</div><div id="_line3084" class="line">3084             treePath = jtree.getPathForLocation(clickX, clickY);
</div><div id="_line3085" class="line">3085             <span class="keyword">try</span>
</div><div id="_line3086" class="line">3086                 <span class="comment">% Modify the context menu based on the clicked node</span>
</div><div id="_line3087" class="line">3087                 node = treePath.getLastPathComponent;
</div><div id="_line3088" class="line">3088                 userdata = get(node,<span class="string">'userdata'</span>);
</div><div id="_line3089" class="line">3089                 obj = userdata.obj;
</div><div id="_line3090" class="line">3090                 jmenu = <a href="#_sub53" class="code" title="subsetTreeContextMenu">setTreeContextMenu</a>(obj,node,tree_h);
</div><div id="_line3091" class="line">3091 
</div><div id="_line3092" class="line">3092                 <span class="comment">% TODO: remember to call jmenu.remove(item) in item callback</span>
</div><div id="_line3093" class="line">3093                 <span class="comment">% or use the timer hack shown here to remove the item:</span>
</div><div id="_line3094" class="line">3094                 <span class="comment">%    timerFcn = {@menuRemoveItem,jmenu,item};</span>
</div><div id="_line3095" class="line">3095                 <span class="comment">%    start(timer('TimerFcn',timerFcn,'StartDelay',0.2));</span>
</div><div id="_line3096" class="line">3096 
</div><div id="_line3097" class="line">3097                 <span class="comment">% Display the (possibly-modified) context menu</span>
</div><div id="_line3098" class="line">3098                 jmenu.show(jtree, clickX, clickY);
</div><div id="_line3099" class="line">3099                 jmenu.repaint;
</div><div id="_line3100" class="line">3100 
</div><div id="_line3101" class="line">3101                 <span class="comment">% This is for debugging:</span>
</div><div id="_line3102" class="line">3102                 userdata.tree = jtree;
</div><div id="_line3103" class="line">3103                 setappdata(gcf,<span class="string">'findjobj_hgtree'</span>,userdata)
</div><div id="_line3104" class="line">3104             <span class="keyword">catch</span>
</div><div id="_line3105" class="line">3105                 <span class="comment">% clicked location is NOT on top of any node</span>
</div><div id="_line3106" class="line">3106                 <span class="comment">% Note: can also be tested by isempty(treePath)</span>
</div><div id="_line3107" class="line">3107             <span class="keyword">end</span>
</div><div id="_line3108" class="line">3108         <span class="keyword">end</span>
</div><div id="_line3109" class="line">3109     <span class="keyword">end</span>  <span class="comment">% treeMousePressedCallback</span>
</div><div id="_line3110" class="line">3110 
</div><div id="_line3111" class="line">3111     <span class="comment">%% Remove the extra context menu item after display</span>
</div><div id="_line3112" class="line">3112     <a name="_sub55" href="#_subfunctions" class="code">function menuRemoveItem(hObj,eventData,jmenu,item) </a><span class="comment">%#ok unused</span>
</div><div id="_line3113" class="line">3113         jmenu.remove(item);
</div><div id="_line3114" class="line">3114     <span class="keyword">end</span>  <span class="comment">% menuRemoveItem</span>
</div><div id="_line3115" class="line">3115 
</div><div id="_line3116" class="line">3116     <span class="comment">%% Get the title for the tooltip and context (right-click) menu</span>
</div><div id="_line3117" class="line">3117     <a name="_sub56" href="#_subfunctions" class="code">function nodeTitleStr = getNodeTitleStr(obj,node)</a>
</div><div id="_line3118" class="line">3118         <span class="keyword">try</span>
</div><div id="_line3119" class="line">3119             <span class="comment">% Display the full classname and object name in the tooltip</span>
</div><div id="_line3120" class="line">3120             <span class="comment">%nodeName = char(node.getName);</span>
</div><div id="_line3121" class="line">3121             <span class="comment">%nodeName = strrep(nodeName, '&lt;HTML&gt;&lt;i&gt;&lt;font color=&quot;gray&quot;&gt;','');</span>
</div><div id="_line3122" class="line">3122             <span class="comment">%nodeName = strrep(nodeName, '&lt;/font&gt;&lt;/i&gt;&lt;/html&gt;','');</span>
</div><div id="_line3123" class="line">3123             nodeName = char(<a href="#_sub36" class="code" title="subgetNodeName">getNodeName</a>(obj,99));
</div><div id="_line3124" class="line">3124             [objClass,objName] = strtok(nodeName);
</div><div id="_line3125" class="line">3125             objName = objName(3:end-1);  <span class="comment">% strip leading ( and trailing )</span>
</div><div id="_line3126" class="line">3126             <span class="keyword">if</span> isempty(objName),  objName = <span class="string">'(none found)'</span>;  <span class="keyword">end</span>
</div><div id="_line3127" class="line">3127             nodeName = char(node.getName);
</div><div id="_line3128" class="line">3128             objClass = char(obj.getClass.getName);
</div><div id="_line3129" class="line">3129             nodeTitleStr = sprintf(<span class="string">'&lt;html&gt;Class name: &lt;font color=&quot;blue&quot;&gt;%s&lt;/font&gt;&lt;br&gt;Text/title: %s'</span>,objClass,objName);
</div><div id="_line3130" class="line">3130 
</div><div id="_line3131" class="line">3131             <span class="comment">% If the component is invisible, state this in the tooltip</span>
</div><div id="_line3132" class="line">3132             <span class="keyword">if</span> ~isempty(strfind(nodeName,<span class="string">'color=&quot;gray&quot;'</span>))
</div><div id="_line3133" class="line">3133                 nodeTitleStr = [nodeTitleStr <span class="string">'&lt;br&gt;&lt;font color=&quot;gray&quot;&gt;&lt;i&gt;&lt;b&gt;*** Invisible ***&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;'</span>];
</div><div id="_line3134" class="line">3134             <span class="keyword">end</span>
</div><div id="_line3135" class="line">3135             nodeTitleStr = [nodeTitleStr <span class="string">'&lt;hr&gt;Right-click for context-menu'</span>];
</div><div id="_line3136" class="line">3136         <span class="keyword">catch</span>
</div><div id="_line3137" class="line">3137             <span class="comment">% Possible not a Java object - try treating as an HG handle</span>
</div><div id="_line3138" class="line">3138             <span class="keyword">try</span>
</div><div id="_line3139" class="line">3139                 handleValueStr = sprintf(<span class="string">'#: &lt;font color=&quot;blue&quot;&gt;&lt;b&gt;%.99g&lt;b&gt;&lt;/font&gt;'</span>,double(obj));
</div><div id="_line3140" class="line">3140                 <span class="keyword">try</span>
</div><div id="_line3141" class="line">3141                     type = <span class="string">''</span>;
</div><div id="_line3142" class="line">3142                     type = get(obj,<span class="string">'type'</span>);
</div><div id="_line3143" class="line">3143                     type(1) = upper(type(1));
</div><div id="_line3144" class="line">3144                 <span class="keyword">catch</span>
</div><div id="_line3145" class="line">3145                     <span class="keyword">if</span> ~ishandle(obj)
</div><div id="_line3146" class="line">3146                         type = [<span class="string">'&lt;font color=&quot;red&quot;&gt;&lt;b&gt;Invalid &lt;i&gt;'</span> char(node.getName) <span class="string">'&lt;/i&gt;'</span>];
</div><div id="_line3147" class="line">3147                         handleValueStr = <span class="string">'!!!&lt;/b&gt;&lt;/font&gt;&lt;br&gt;Perhaps this handle was deleted after this UIInspect tree was&lt;br&gt;already drawn. Try to refresh by selecting any valid node handle'</span>;
</div><div id="_line3148" class="line">3148                     <span class="keyword">end</span>
</div><div id="_line3149" class="line">3149                 <span class="keyword">end</span>
</div><div id="_line3150" class="line">3150                 nodeTitleStr = sprintf(<span class="string">'&lt;html&gt;%s handle %s'</span>,type,handleValueStr);
</div><div id="_line3151" class="line">3151                 <span class="keyword">try</span>
</div><div id="_line3152" class="line">3152                     <span class="comment">% If the component is invisible, state this in the tooltip</span>
</div><div id="_line3153" class="line">3153                     <span class="keyword">if</span> strcmp(get(obj,<span class="string">'Visible'</span>),<span class="string">'off'</span>)
</div><div id="_line3154" class="line">3154                         nodeTitleStr = [nodeTitleStr <span class="string">'&lt;br&gt;&lt;center&gt;&lt;font color=&quot;gray&quot;&gt;&lt;i&gt;Invisible&lt;/i&gt;&lt;/font&gt;'</span>];
</div><div id="_line3155" class="line">3155                     <span class="keyword">end</span>
</div><div id="_line3156" class="line">3156                 <span class="keyword">catch</span>
</div><div id="_line3157" class="line">3157                     <span class="comment">% never mind...</span>
</div><div id="_line3158" class="line">3158                 <span class="keyword">end</span>
</div><div id="_line3159" class="line">3159             <span class="keyword">catch</span>
</div><div id="_line3160" class="line">3160                 <span class="comment">% never mind... - ignore</span>
</div><div id="_line3161" class="line">3161             <span class="keyword">end</span>
</div><div id="_line3162" class="line">3162         <span class="keyword">end</span>
</div><div id="_line3163" class="line">3163     <span class="keyword">end</span>  <span class="comment">% getNodeTitleStr</span>
</div><div id="_line3164" class="line">3164 
</div><div id="_line3165" class="line">3165     <span class="comment">%% Handle tree mouse movement callback - used to set the tooltip &amp; context-menu</span>
</div><div id="_line3166" class="line">3166     <a name="_sub57" href="#_subfunctions" class="code">function treeMouseMovedCallback(hTree, eventData)</a>
</div><div id="_line3167" class="line">3167           <span class="keyword">try</span>
</div><div id="_line3168" class="line">3168               x = eventData.getX;
</div><div id="_line3169" class="line">3169               y = eventData.getY;
</div><div id="_line3170" class="line">3170               jtree = eventData.getSource;
</div><div id="_line3171" class="line">3171               treePath = jtree.getPathForLocation(x, y);
</div><div id="_line3172" class="line">3172               <span class="keyword">try</span>
</div><div id="_line3173" class="line">3173                   <span class="comment">% Set the tooltip string based on the hovered node</span>
</div><div id="_line3174" class="line">3174                   node = treePath.getLastPathComponent;
</div><div id="_line3175" class="line">3175                   userdata = get(node,<span class="string">'userdata'</span>);
</div><div id="_line3176" class="line">3176                   obj = userdata.obj;
</div><div id="_line3177" class="line">3177                   tooltipStr = <a href="#_sub56" class="code" title="subgetNodeTitleStr">getNodeTitleStr</a>(obj,node);
</div><div id="_line3178" class="line">3178                   set(hTree,<span class="string">'ToolTipText'</span>,tooltipStr)
</div><div id="_line3179" class="line">3179               <span class="keyword">catch</span>
</div><div id="_line3180" class="line">3180                   <span class="comment">% clicked location is NOT on top of any node</span>
</div><div id="_line3181" class="line">3181                   <span class="comment">% Note: can also be tested by isempty(treePath)</span>
</div><div id="_line3182" class="line">3182               <span class="keyword">end</span>
</div><div id="_line3183" class="line">3183           <span class="keyword">catch</span>
</div><div id="_line3184" class="line">3184               <a href="#_sub51" class="code" title="subdispError">dispError</a>;
</div><div id="_line3185" class="line">3185           <span class="keyword">end</span>
</div><div id="_line3186" class="line">3186           <span class="keyword">return</span>;  <span class="comment">% denug breakpoint</span>
</div><div id="_line3187" class="line">3187     <span class="keyword">end</span>  <span class="comment">% treeMouseMovedCallback</span>
</div><div id="_line3188" class="line">3188 
</div><div id="_line3189" class="line">3189     <span class="comment">%% Request focus for a specific object handle</span>
</div><div id="_line3190" class="line">3190     <a name="_sub58" href="#_subfunctions" class="code">function requestFocus(hTree, eventData, obj)  </a><span class="comment">%#ok hTree &amp; eventData are unused</span>
</div><div id="_line3191" class="line">3191         <span class="comment">% Ensure the object handle is valid</span>
</div><div id="_line3192" class="line">3192         <span class="keyword">if</span> isjava(obj)
</div><div id="_line3193" class="line">3193             obj.requestFocus;
</div><div id="_line3194" class="line">3194             <span class="keyword">return</span>;
</div><div id="_line3195" class="line">3195         <span class="keyword">elseif</span> ~ishandle(obj)
</div><div id="_line3196" class="line">3196             msgbox(<span class="string">'The selected object does not appear to be a valid handle as defined by the ishandle() function. Perhaps this object was deleted after this hierarchy tree was already drawn. Refresh this tree by selecting a valid node handle and then retry.'</span>,<span class="string">'FindJObj'</span>,<span class="string">'warn'</span>);
</div><div id="_line3197" class="line">3197             beep;
</div><div id="_line3198" class="line">3198             <span class="keyword">return</span>;
</div><div id="_line3199" class="line">3199         <span class="keyword">end</span>
</div><div id="_line3200" class="line">3200 
</div><div id="_line3201" class="line">3201         <span class="keyword">try</span>
</div><div id="_line3202" class="line">3202             foundFlag = 0;
</div><div id="_line3203" class="line">3203             <span class="keyword">while</span> ~foundFlag
</div><div id="_line3204" class="line">3204                 <span class="keyword">if</span> isempty(obj),  <span class="keyword">return</span>;  <span class="keyword">end</span>  <span class="comment">% sanity check</span>
</div><div id="_line3205" class="line">3205                 type = get(obj,<span class="string">'type'</span>);
</div><div id="_line3206" class="line">3206                 obj = double(obj);
</div><div id="_line3207" class="line">3207                 foundFlag = any(strcmp(type,{<span class="string">'figure'</span>,<span class="string">'axes'</span>,<span class="string">'uicontrol'</span>}));
</div><div id="_line3208" class="line">3208                 <span class="keyword">if</span> ~foundFlag
</div><div id="_line3209" class="line">3209                     obj = get(obj,<span class="string">'Parent'</span>);
</div><div id="_line3210" class="line">3210                 <span class="keyword">end</span>
</div><div id="_line3211" class="line">3211             <span class="keyword">end</span>
</div><div id="_line3212" class="line">3212             feval(type,obj);
</div><div id="_line3213" class="line">3213         <span class="keyword">catch</span>
</div><div id="_line3214" class="line">3214             <span class="comment">% never mind...</span>
</div><div id="_line3215" class="line">3215             <a href="#_sub51" class="code" title="subdispError">dispError</a>;
</div><div id="_line3216" class="line">3216         <span class="keyword">end</span>
</div><div id="_line3217" class="line">3217     <span class="keyword">end</span>  <span class="comment">% requestFocus</span>
</div><div id="_line3218" class="line">3218 
</div><div id="_line3219" class="line">3219 
</div><div id="_line3220" class="line">3220 <span class="keyword">end</span>  <span class="comment">% FINDJOBJ</span>
</div><div id="_line3221" class="line">3221 
</div><div id="_line3222" class="line">3222 
</div><div id="_line3223" class="line">3223 <span class="comment">%% TODO TODO TODO</span>
</div><div id="_line3224" class="line">3224 <span class="comment">%{</span>
</div><div id="_line3225" class="line">3225 - Enh: Improve performance - esp. <a href="#_sub26" class="code" title="subexpandNode">expandNode</a>() (performance solved in non-interactive mode)
</div><div id="_line3226" class="line">3226 - Enh: Add property listeners - same problem in MathWork's inspect.m
</div><div id="_line3227" class="line">3227 - Enh: Display additional properties - same problem in MathWork's inspect.m
</div><div id="_line3228" class="line">3228 - Enh: Add axis (plot, Graphics) component handles
</div><div id="_line3229" class="line">3229 - Enh: Group callbacks according to the first word (up to 2nd cap letter)
</div><div id="_line3230" class="line">3230 - Enh: Add figure thumbnail image below the java tree (&amp; indicate corresponding jObject when selected)
</div><div id="_line3231" class="line">3231 - Enh: scroll initially-selected node into view (problem because treenode has no pixel location)
</div><div id="_line3232" class="line">3232 - Fix: java exceptions when getting some fields (com.mathworks.mlwidgets.inspector.PropertyRootNode$PropertyListener$1$1.run)
</div><div id="_line3233" class="line">3233 - Fix: use EDT <span class="keyword">if</span> available (especially in <a href="#_sub28" class="code" title="subflashComponent">flashComponent</a>)
</div><div id="_line3234" class="line">3234 <span class="comment">%}</span>
</div></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005
<br>
check <strong><a href="../../../index.html">here</a></strong> date of last update.
<br></address>
</body>
</html>