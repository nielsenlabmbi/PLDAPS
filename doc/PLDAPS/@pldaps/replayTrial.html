<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of replayTrial</title>
  <meta name="keywords" content="replayTrial">
  <meta name="description" content="replayTrial    replays a single Trial by calling the function defined in">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">PLDAPS</a> &gt; <a href="index.html">@pldaps</a> &gt; replayTrial.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for PLDAPS/@pldaps&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>@pldaps/replayTrial
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>replayTrial    replays a single Trial by calling the function defined in</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function p = replayTrial(p) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="description">replayTrial    replays a single Trial by calling the function defined in 
               p.trial.pldaps.trialFunction through different states
 this is a modified version of pldaps.runTrial

 03/2013 jly   Wrote hyperflow
 03/2014 jk    Used jly's code to get the PLDAPS structure and frame it into a class
               might change to ASYNC buffer flipping. but won't for now.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<!-- parameterreference -->
<h2><a name="_cross"></a>PARAMETER USAGE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function uses these parameters:
<ul >
<li><a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState:</a>	
        <a href="#_line0128" class="code"}">128 </a></li><li><a href="../../Parameters/display/ifi.html" class="param" title="">.display.ifi:</a>	
        <a href="#_line0075" class="code"}">75 </a>    <a href="#_line0128" class="code"}">128 </a>    <a href="#_line0130" class="code"}">130 </a></li><li><a href="../../Parameters/flagNextTrial.html" class="param" title="">.flagNextTrial:</a>	
        <a href="#_line0071" class="code"}">71 </a></li><li><a href="../../Parameters/framePostLastDrawIdleCount.html" class="param" title="">.framePostLastDrawIdleCount:</a>	
        <a href="#_line0105" class="code"}">105 </a></li><li><a href="../../Parameters/framePreLastDrawIdleCount.html" class="param" title="">.framePreLastDrawIdleCount:</a>	
        <a href="#_line0087" class="code"}">87 </a></li><li><a href="../../Parameters/iFrame.html" class="param" title="">.iFrame:</a>	
        <a href="#_line0120" class="code"}">120 </a>    <a href="#_line0128" class="code"}">128 </a></li><li><a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime:</a>	
        <a href="#_line0128" class="code"}">128 </a>    <a href="#_line0129" class="code"}">129 </a>    <a href="#_line0130" class="code"}">130 </a></li><li><a href="../../Parameters/pldaps/iTrial.html" class="param" title="trial number. cannot be changed by the user">.pldaps.iTrial:</a>	
        <a href="#_line0128" class="code"}">128 </a>trial number. cannot be changed by the user</li><li><a href="../../Parameters/pldaps/quit.html" class="param" title="control expeiment during a trial.">.pldaps.quit:</a>	
        <a href="#_line0071" class="code"}">71 </a>control expeiment during a trial.</li><li><a href="../../Parameters/pldaps/trialFunction.html" class="param" title="">.pldaps.trialFunction:</a>	
        <a href="#_line0011" class="code"}">11 </a></li><li><a href="../../Parameters/pldaps/trialStates/frameDraw.html" class="param" title="called every frame for drawing command.">.pldaps.trialStates.frameDraw:</a>	
        <a href="#_line0081" class="code"}">81 </a>    <a href="#_line0083" class="code"}">83 </a>called every frame for drawing command.</li><li><a href="../../Parameters/pldaps/trialStates/frameDrawTimecritical.html" class="param" title="disabled">.pldaps.trialStates.frameDrawTimecritical:</a>	
        <a href="#_line0096" class="code"}">96 </a>disabled</li><li><a href="../../Parameters/pldaps/trialStates/frameDrawingFinished.html" class="param" title="called every frame after drawing.">.pldaps.trialStates.frameDrawingFinished:</a>	
        <a href="#_line0099" class="code"}">99 </a>    <a href="#_line0101" class="code"}">101 </a>called every frame after drawing.</li><li><a href="../../Parameters/pldaps/trialStates/frameFlip.html" class="param" title="called every frame to flip the buffers.">.pldaps.trialStates.frameFlip:</a>	
        <a href="#_line0114" class="code"}">114 </a>    <a href="#_line0117" class="code"}">117 </a>called every frame to flip the buffers.</li><li><a href="../../Parameters/pldaps/trialStates/frameIdlePostDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePostDraw:</a>	
        <a href="#_line0102" class="code"}">102 </a>    <a href="#_line0104" class="code"}">104 </a>diabled</li><li><a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw:</a>	
        <a href="#_line0084" class="code"}">84 </a>    <a href="#_line0086" class="code"}">86 </a>    <a href="#_line0098" class="code"}">98 </a>diabled</li><li><a href="../../Parameters/pldaps/trialStates/framePrepareDrawing.html" class="param" title="called every frame to prepare drawing.">.pldaps.trialStates.framePrepareDrawing:</a>	
        <a href="#_line0078" class="code"}">78 </a>    <a href="#_line0080" class="code"}">80 </a>called every frame to prepare drawing.</li><li><a href="../../Parameters/pldaps/trialStates/frameUpdate.html" class="param" title="called every frame to update input.">.pldaps.trialStates.frameUpdate:</a>	
        <a href="#_line0077" class="code"}">77 </a>    <a href="#_line0119" class="code"}">119 </a>called every frame to update input.</li><li><a href="../../Parameters/pldaps/trialStates/trialCleanUpandSave.html" class="param" title="called at the end of the trial.">.pldaps.trialStates.trialCleanUpandSave:</a>	
        <a href="#_line0123" class="code"}">123 </a>called at the end of the trial.</li><li><a href="../../Parameters/pldaps/trialStates/trialPrepare.html" class="param" title="called before each trial for synchronization">.pldaps.trialStates.trialPrepare:</a>	
        <a href="#_line0062" class="code"}">62 </a>called before each trial for synchronization</li><li><a href="../../Parameters/pldaps/trialStates/trialSetup.html" class="param" title="called before each trial for data allocation.">.pldaps.trialStates.trialSetup:</a>	
        <a href="#_line0048" class="code"}">48 </a>called before each trial for data allocation.</li><li><a href="../../Parameters/stimulus/timeLastFrame.html" class="param" title="">.stimulus.timeLastFrame:</a>	
        <a href="#_line0075" class="code"}">75 </a></li><li><a href="../../Parameters/ttime.html" class="param" title="">.ttime:</a>	
        <a href="#_line0129" class="code"}">129 </a>    <a href="#_line0130" class="code"}">130 </a></li></ul>
This function assigns these parameters:
<ul>
<li><a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState:</a>
        <a href="#_line0046" class="code"}">46 </a>    <a href="#_line0130" class="code"}">130 </a>    <a href="#_line0131" class="code"}">131 </a></li><li><a href="../../Parameters/framePostLastDrawIdleCount.html" class="param" title="">.framePostLastDrawIdleCount:</a>
        <a href="#_line0065" class="code"}">65 </a>    <a href="#_line0105" class="code"}">105 </a></li><li><a href="../../Parameters/framePreLastDrawIdleCount.html" class="param" title="">.framePreLastDrawIdleCount:</a>
        <a href="#_line0064" class="code"}">64 </a>    <a href="#_line0087" class="code"}">87 </a></li><li><a href="../../Parameters/iFrame.html" class="param" title="">.iFrame:</a>
        <a href="#_line0120" class="code"}">120 </a>    <a href="#_line0130" class="code"}">130 </a></li><li><a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime:</a>
        <a href="#_line0075" class="code"}">75 </a></li><li><a href="../../Parameters/pldaps/trialStates/frameDraw.html" class="param" title="called every frame for drawing command.">.pldaps.trialStates.frameDraw:</a>
        <a href="#_line0030" class="code"}">30 </a>called every frame for drawing command.</li><li><a href="../../Parameters/pldaps/trialStates/frameDrawTimecritical.html" class="param" title="disabled">.pldaps.trialStates.frameDrawTimecritical:</a>
        <a href="#_line0035" class="code"}">35 </a>disabled</li><li><a href="../../Parameters/pldaps/trialStates/frameDrawingFinished.html" class="param" title="called every frame after drawing.">.pldaps.trialStates.frameDrawingFinished:</a>
        <a href="#_line0038" class="code"}">38 </a>called every frame after drawing.</li><li><a href="../../Parameters/pldaps/trialStates/frameFlip.html" class="param" title="called every frame to flip the buffers.">.pldaps.trialStates.frameFlip:</a>
        <a href="#_line0044" class="code"}">44 </a>called every frame to flip the buffers.</li><li><a href="../../Parameters/pldaps/trialStates/frameIdlePostDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePostDraw:</a>
        <a href="#_line0042" class="code"}">42 </a>diabled</li><li><a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw:</a>
        <a href="#_line0032" class="code"}">32 </a>diabled</li><li><a href="../../Parameters/pldaps/trialStates/framePrepareDrawing.html" class="param" title="called every frame to prepare drawing.">.pldaps.trialStates.framePrepareDrawing:</a>
        <a href="#_line0028" class="code"}">28 </a>called every frame to prepare drawing.</li><li><a href="../../Parameters/pldaps/trialStates/frameUpdate.html" class="param" title="called every frame to update input.">.pldaps.trialStates.frameUpdate:</a>
        <a href="#_line0023" class="code"}">23 </a>called every frame to update input.</li><li><a href="../../Parameters/pldaps/trialStates/trialCleanUpandSave.html" class="param" title="called at the end of the trial.">.pldaps.trialStates.trialCleanUpandSave:</a>
        <a href="#_line0017" class="code"}">17 </a>called at the end of the trial.</li><li><a href="../../Parameters/pldaps/trialStates/trialPrepare.html" class="param" title="called before each trial for synchronization">.pldaps.trialStates.trialPrepare:</a>
        <a href="#_line0016" class="code"}">16 </a>called before each trial for synchronization</li><li><a href="../../Parameters/pldaps/trialStates/trialSetup.html" class="param" title="called before each trial for data allocation.">.pldaps.trialStates.trialSetup:</a>
        <a href="#_line0015" class="code"}">15 </a>called before each trial for data allocation.</li><li><a href="../../Parameters/remainingFrameTime.html" class="param" title="">.remainingFrameTime:</a>
        <a href="#_line0129" class="code"}">129 </a></li><li><a href="../../Parameters/timing/frameStateChangeTimes.html" class="param" title="">.timing.frameStateChangeTimes:</a>
        <a href="#_line0130" class="code"}">130 </a></li><li><a href="../../Parameters/ttime.html" class="param" title="">.ttime:</a>
        <a href="#_line0128" class="code"}">128 </a></li></ul>
<!-- parameterreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">setTimeAndFrameState</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre><div id="_line0001" class="line">0001 <a name="_sub0" href="#_subfunctions" class="code">function p = replayTrial(p)</a>
</div><div id="_line0002" class="line">0002 <span class="comment">%replayTrial    replays a single Trial by calling the function defined in</span>
</div><div id="_line0003" class="line">0003 <span class="comment">%               p.trial.pldaps.trialFunction through different states</span>
</div><div id="_line0004" class="line">0004 <span class="comment">% this is a modified version of pldaps.runTrial</span>
</div><div id="_line0005" class="line">0005 <span class="comment">%</span>
</div><div id="_line0006" class="line">0006 <span class="comment">% 03/2013 jly   Wrote hyperflow</span>
</div><div id="_line0007" class="line">0007 <span class="comment">% 03/2014 jk    Used jly's code to get the PLDAPS structure and frame it into a class</span>
</div><div id="_line0008" class="line">0008 <span class="comment">%               might change to ASYNC buffer flipping. but won't for now.</span>
</div><div id="_line0009" class="line">0009 
</div><div id="_line0010" class="line">0010     <span class="comment">%the trialFunctionHandle</span>
</div><div id="_line0011" class="line">0011     tfh=str2func(p.trial<a href="../../Parameters/pldaps/trialFunction.html" class="param" title="">.pldaps.trialFunction</a>);
</div><div id="_line0012" class="line">0012     
</div><div id="_line0013" class="line">0013     <span class="comment">%trial states that are not in a frame are negative, just to allow both</span>
</div><div id="_line0014" class="line">0014     <span class="comment">%to be more independent</span>
</div><div id="_line0015" class="line">0015     p.trial<a href="../../Parameters/pldaps/trialStates/trialSetup.html" class="param" title="called before each trial for data allocation.">.pldaps.trialStates.trialSetup</a>=-1;
</div><div id="_line0016" class="line">0016     p.trial<a href="../../Parameters/pldaps/trialStates/trialPrepare.html" class="param" title="called before each trial for synchronization">.pldaps.trialStates.trialPrepare</a>=-2;
</div><div id="_line0017" class="line">0017     p.trial<a href="../../Parameters/pldaps/trialStates/trialCleanUpandSave.html" class="param" title="called at the end of the trial.">.pldaps.trialStates.trialCleanUpandSave</a>=-3;
</div><div id="_line0018" class="line">0018     
</div><div id="_line0019" class="line">0019     <span class="comment">%ok, what are the options?</span>
</div><div id="_line0020" class="line">0020     <span class="comment">%we'll make them states</span>
</div><div id="_line0021" class="line">0021     <span class="comment">%is called once after the last frame is done (or even before)</span>
</div><div id="_line0022" class="line">0022     <span class="comment">%get current eyepostion, curser position or keypresses</span>
</div><div id="_line0023" class="line">0023     p.trial<a href="../../Parameters/pldaps/trialStates/frameUpdate.html" class="param" title="called every frame to update input.">.pldaps.trialStates.frameUpdate</a>=1;
</div><div id="_line0024" class="line">0024     <span class="comment">%here you can prepare all drawing, e.g. have the dots move</span>
</div><div id="_line0025" class="line">0025     <span class="comment">%if you need to update to the latest e.g. eyeposition</span>
</div><div id="_line0026" class="line">0026     <span class="comment">%you can still do that later, this could be all expected heavy</span>
</div><div id="_line0027" class="line">0027     <span class="comment">%calculations</span>
</div><div id="_line0028" class="line">0028     p.trial<a href="../../Parameters/pldaps/trialStates/framePrepareDrawing.html" class="param" title="called every frame to prepare drawing.">.pldaps.trialStates.framePrepareDrawing</a>=2; 
</div><div id="_line0029" class="line">0029     <span class="comment">%once you know you've calculated the final image, draw it</span>
</div><div id="_line0030" class="line">0030     p.trial<a href="../../Parameters/pldaps/trialStates/frameDraw.html" class="param" title="called every frame for drawing command.">.pldaps.trialStates.frameDraw</a>=3;
</div><div id="_line0031" class="line">0031     <span class="comment">%</span>
</div><div id="_line0032" class="line">0032     p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw</a>=4;
</div><div id="_line0033" class="line">0033     <span class="comment">%if there is something that needs updating. here is a fucntion to do it</span>
</div><div id="_line0034" class="line">0034     <span class="comment">%as late as possible</span>
</div><div id="_line0035" class="line">0035     p.trial<a href="../../Parameters/pldaps/trialStates/frameDrawTimecritical.html" class="param" title="disabled">.pldaps.trialStates.frameDrawTimecritical</a>=5;
</div><div id="_line0036" class="line">0036     <span class="comment">%if this function is not used, drawingFinished will be called after</span>
</div><div id="_line0037" class="line">0037     <span class="comment">%frameDraw is done, otherwise drawingFinished will not be called</span>
</div><div id="_line0038" class="line">0038     p.trial<a href="../../Parameters/pldaps/trialStates/frameDrawingFinished.html" class="param" title="called every frame after drawing.">.pldaps.trialStates.frameDrawingFinished</a>=6;
</div><div id="_line0039" class="line">0039 
</div><div id="_line0040" class="line">0040     <span class="comment">%this function gets called once everything got drawn, until it's time</span>
</div><div id="_line0041" class="line">0041     <span class="comment">%to expect (and do) the flip</span>
</div><div id="_line0042" class="line">0042     p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePostDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePostDraw</a>=7;
</div><div id="_line0043" class="line">0043     <span class="comment">%do the flip (or when async) record the time</span>
</div><div id="_line0044" class="line">0044     p.trial<a href="../../Parameters/pldaps/trialStates/frameFlip.html" class="param" title="called every frame to flip the buffers.">.pldaps.trialStates.frameFlip</a>=8;
</div><div id="_line0045" class="line">0045     
</div><div id="_line0046" class="line">0046     p.trial<a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState</a>=1;    
</div><div id="_line0047" class="line">0047     
</div><div id="_line0048" class="line">0048     tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/trialSetup.html" class="param" title="called before each trial for data allocation.">.pldaps.trialStates.trialSetup</a>);
</div><div id="_line0049" class="line">0049     
</div><div id="_line0050" class="line">0050 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameUpdate)=0.5;</span>
</div><div id="_line0051" class="line">0051 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.framePrepareDrawing)=2;</span>
</div><div id="_line0052" class="line">0052 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameDraw)=2;</span>
</div><div id="_line0053" class="line">0053 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameIdlePreLastDraw)=2;</span>
</div><div id="_line0054" class="line">0054 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameDrawTimecritical)=0.5;</span>
</div><div id="_line0055" class="line">0055 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameDrawingFinished)=2;</span>
</div><div id="_line0056" class="line">0056 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameIdlePostDraw)=0.5;</span>
</div><div id="_line0057" class="line">0057 <span class="comment">%     timeNeeded(p.trial.pldaps.trialStates.frameFlip)=5;</span>
</div><div id="_line0058" class="line">0058 <span class="comment">%     timeNeeded=timeNeeded/1000;%convert to seconds</span>
</div><div id="_line0059" class="line">0059 
</div><div id="_line0060" class="line">0060     <span class="comment">%will be called just before the trial starts for time critical calls to</span>
</div><div id="_line0061" class="line">0061     <span class="comment">%start data aquisition</span>
</div><div id="_line0062" class="line">0062     tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/trialPrepare.html" class="param" title="called before each trial for synchronization">.pldaps.trialStates.trialPrepare</a>);
</div><div id="_line0063" class="line">0063 
</div><div id="_line0064" class="line">0064     p.trial<a href="../../Parameters/framePreLastDrawIdleCount.html" class="param" title="">.framePreLastDrawIdleCount</a>=0;
</div><div id="_line0065" class="line">0065     p.trial<a href="../../Parameters/framePostLastDrawIdleCount.html" class="param" title="">.framePostLastDrawIdleCount</a>=0;
</div><div id="_line0066" class="line">0066 
</div><div id="_line0067" class="line">0067 
</div><div id="_line0068" class="line">0068     <span class="comment">% pdsEyelinkGetQueue(dv);</span>
</div><div id="_line0069" class="line">0069     <span class="comment">%%% MAIN WHILE LOOP %%%</span>
</div><div id="_line0070" class="line">0070     <span class="comment">%-------------------------------------------------------------------------%</span>
</div><div id="_line0071" class="line">0071         <span class="keyword">while</span> ~p.trial<a href="../../Parameters/flagNextTrial.html" class="param" title="">.flagNextTrial</a> &amp;&amp; p.trial<a href="../../Parameters/pldaps/quit.html" class="param" title="control expeiment during a trial.">.pldaps.quit</a> == 0
</div><div id="_line0072" class="line">0072             <span class="comment">%go through one frame</span>
</div><div id="_line0073" class="line">0073             
</div><div id="_line0074" class="line">0074             <span class="comment">%time of the estimated next flip</span>
</div><div id="_line0075" class="line">0075             p.trial<a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime</a> = p.trial<a href="../../Parameters/stimulus/timeLastFrame.html" class="param" title="">.stimulus.timeLastFrame</a>+p.trial<a href="../../Parameters/display/ifi.html" class="param" title="">.display.ifi</a>;
</div><div id="_line0076" class="line">0076 
</div><div id="_line0077" class="line">0077             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameUpdate.html" class="param" title="called every frame to update input.">.pldaps.trialStates.frameUpdate</a>);
</div><div id="_line0078" class="line">0078             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/framePrepareDrawing.html" class="param" title="called every frame to prepare drawing.">.pldaps.trialStates.framePrepareDrawing</a>)
</div><div id="_line0079" class="line">0079 
</div><div id="_line0080" class="line">0080             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/framePrepareDrawing.html" class="param" title="called every frame to prepare drawing.">.pldaps.trialStates.framePrepareDrawing</a>);
</div><div id="_line0081" class="line">0081             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameDraw.html" class="param" title="called every frame for drawing command.">.pldaps.trialStates.frameDraw</a>);
</div><div id="_line0082" class="line">0082 
</div><div id="_line0083" class="line">0083             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameDraw.html" class="param" title="called every frame for drawing command.">.pldaps.trialStates.frameDraw</a>);
</div><div id="_line0084" class="line">0084             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw</a>);
</div><div id="_line0085" class="line">0085  
</div><div id="_line0086" class="line">0086             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw</a>);
</div><div id="_line0087" class="line">0087             p.trial<a href="../../Parameters/framePreLastDrawIdleCount.html" class="param" title="">.framePreLastDrawIdleCount</a> = p.trial<a href="../../Parameters/framePreLastDrawIdleCount.html" class="param" title="">.framePreLastDrawIdleCount</a> +1;
</div><div id="_line0088" class="line">0088 <span class="comment">%             dv.trial.ttime = GetSecs - dv.trial.trstart;</span>
</div><div id="_line0089" class="line">0089 <span class="comment">%             dv.trial.remainingFrameTime=dv.trial.nextFrameTime-dv.trial.ttime;</span>
</div><div id="_line0090" class="line">0090 <span class="comment">%             while (dv.trial.remainingFrameTime&gt;sum(timeNeeded(dv.trial.pldaps.trialStates.frameIdlePreLastDraw+1:end)))</span>
</div><div id="_line0091" class="line">0091 <span class="comment">%                 tfh(dv, dv.trial.pldaps.trialStates.frameIdlePreLastDraw);</span>
</div><div id="_line0092" class="line">0092 <span class="comment">%                 dv.trial.framePreLastDrawIdleCount = dv.trial.framePreLastDrawIdleCount +1;</span>
</div><div id="_line0093" class="line">0093 <span class="comment">%                 dv.trial.ttime = GetSecs - dv.trial.trstart;</span>
</div><div id="_line0094" class="line">0094 <span class="comment">%                 dv.trial.remainingFrameTime=dv.trial.nextFrameTime-dv.trial.ttime;</span>
</div><div id="_line0095" class="line">0095 <span class="comment">%             end</span>
</div><div id="_line0096" class="line">0096             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameDrawTimecritical.html" class="param" title="disabled">.pldaps.trialStates.frameDrawTimecritical</a>);
</div><div id="_line0097" class="line">0097 
</div><div id="_line0098" class="line">0098             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePreLastDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePreLastDraw</a>);
</div><div id="_line0099" class="line">0099             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameDrawingFinished.html" class="param" title="called every frame after drawing.">.pldaps.trialStates.frameDrawingFinished</a>);
</div><div id="_line0100" class="line">0100                   
</div><div id="_line0101" class="line">0101             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameDrawingFinished.html" class="param" title="called every frame after drawing.">.pldaps.trialStates.frameDrawingFinished</a>);
</div><div id="_line0102" class="line">0102             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePostDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePostDraw</a>);
</div><div id="_line0103" class="line">0103 
</div><div id="_line0104" class="line">0104             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameIdlePostDraw.html" class="param" title="diabled">.pldaps.trialStates.frameIdlePostDraw</a>);
</div><div id="_line0105" class="line">0105             p.trial<a href="../../Parameters/framePostLastDrawIdleCount.html" class="param" title="">.framePostLastDrawIdleCount</a> = p.trial<a href="../../Parameters/framePostLastDrawIdleCount.html" class="param" title="">.framePostLastDrawIdleCount</a> +1;
</div><div id="_line0106" class="line">0106 <span class="comment">%             dv.trial.ttime = GetSecs - dv.trial.trstart;</span>
</div><div id="_line0107" class="line">0107 <span class="comment">%             dv.trial.remainingFrameTime=dv.trial.nextFrameTime-dv.trial.ttime;</span>
</div><div id="_line0108" class="line">0108 <span class="comment">%             while (dv.trial.remainingFrameTime&gt;sum(timeNeeded(dv.trial.pldaps.trialStates.frameIdlePostDraw+1:end)))</span>
</div><div id="_line0109" class="line">0109 <span class="comment">%                 tfh(dv, dv.trial.pldaps.trialStates.frameIdlePostDraw);</span>
</div><div id="_line0110" class="line">0110 <span class="comment">%                 dv.trial.framePostLastDrawIdleCount = dv.trial.framePostLastDrawIdleCount +1;</span>
</div><div id="_line0111" class="line">0111 <span class="comment">%                 dv.trial.ttime = GetSecs - dv.trial.trstart;</span>
</div><div id="_line0112" class="line">0112 <span class="comment">%                 dv.trial.remainingFrameTime=dv.trial.nextFrameTime-dv.trial.ttime;</span>
</div><div id="_line0113" class="line">0113 <span class="comment">%             end</span>
</div><div id="_line0114" class="line">0114             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameFlip.html" class="param" title="called every frame to flip the buffers.">.pldaps.trialStates.frameFlip</a>)
</div><div id="_line0115" class="line">0115                    
</div><div id="_line0116" class="line">0116 
</div><div id="_line0117" class="line">0117             tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/frameFlip.html" class="param" title="called every frame to flip the buffers.">.pldaps.trialStates.frameFlip</a>);
</div><div id="_line0118" class="line">0118             <span class="comment">%advance to next frame</span>
</div><div id="_line0119" class="line">0119             <a href="#_sub1" class="code" title="subsetTimeAndFrameState">setTimeAndFrameState</a>(p,p.trial<a href="../../Parameters/pldaps/trialStates/frameUpdate.html" class="param" title="called every frame to update input.">.pldaps.trialStates.frameUpdate</a>);           
</div><div id="_line0120" class="line">0120             p.trial<a href="../../Parameters/iFrame.html" class="param" title="">.iFrame</a> = p.trial<a href="../../Parameters/iFrame.html" class="param" title="">.iFrame</a> + 1;  <span class="comment">% update frame index</span>
</div><div id="_line0121" class="line">0121         <span class="keyword">end</span> <span class="comment">%while Trial running</span>
</div><div id="_line0122" class="line">0122 
</div><div id="_line0123" class="line">0123         tfh(p, p.trial<a href="../../Parameters/pldaps/trialStates/trialCleanUpandSave.html" class="param" title="called at the end of the trial.">.pldaps.trialStates.trialCleanUpandSave</a>);
</div><div id="_line0124" class="line">0124 
</div><div id="_line0125" class="line">0125     <span class="keyword">end</span> <span class="comment">%runTrial</span>
</div><div id="_line0126" class="line">0126     
</div><div id="_line0127" class="line">0127     <a name="_sub1" href="#_subfunctions" class="code">function setTimeAndFrameState(p,state)</a>
</div><div id="_line0128" class="line">0128             p.trial<a href="../../Parameters/ttime.html" class="param" title="">.ttime</a>=p.data{p.trial<a href="../../Parameters/pldaps/iTrial.html" class="param" title="trial number. cannot be changed by the user">.pldaps.iTrial</a>}.timing.frameStateChangeTimes(p.trial<a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState</a>,p.trial<a href="../../Parameters/iFrame.html" class="param" title="">.iFrame</a>)+ p.trial<a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime</a>-p.trial<a href="../../Parameters/display/ifi.html" class="param" title="">.display.ifi</a>;
</div><div id="_line0129" class="line">0129             p.trial<a href="../../Parameters/remainingFrameTime.html" class="param" title="">.remainingFrameTime</a>=p.trial<a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime</a>-p.trial<a href="../../Parameters/ttime.html" class="param" title="">.ttime</a>;
</div><div id="_line0130" class="line">0130             p.trial<a href="../../Parameters/timing/frameStateChangeTimes.html" class="param" title="">.timing.frameStateChangeTimes</a>(p.trial<a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState</a>,p.trial<a href="../../Parameters/iFrame.html" class="param" title="">.iFrame</a>)=p.trial<a href="../../Parameters/ttime.html" class="param" title="">.ttime</a>-p.trial<a href="../../Parameters/nextFrameTime.html" class="param" title="">.nextFrameTime</a>+p.trial<a href="../../Parameters/display/ifi.html" class="param" title="">.display.ifi</a>;
</div><div id="_line0131" class="line">0131             p.trial<a href="../../Parameters/currentFrameState.html" class="param" title="">.currentFrameState</a>=state;        
</div><div id="_line0132" class="line">0132     <span class="keyword">end</span>
</div></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005
<br>
check <strong><a href="../../index.html">here</a></strong> date of last update.
<br></address>
</body>
</html>