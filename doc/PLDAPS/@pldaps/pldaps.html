<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of pldaps</title>
  <meta name="keywords" content="pldaps">
  <meta name="description" content="pldaps    main class for PLDAPS (Plexon Datapixx PsychToolbox) version 4.1">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">PLDAPS</a> &gt; <a href="index.html">@pldaps</a> &gt; pldaps.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for PLDAPS/@pldaps&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>@pldaps/pldaps
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>pldaps    main class for PLDAPS (Plexon Datapixx PsychToolbox) version 4.1</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function p = pldaps(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="description">pldaps    main class for PLDAPS (Plexon Datapixx PsychToolbox) version 4.1
 The pldaps contructor accepts the following inputs, all are optional, but may be required later for experiments to run:
     1. a subject identifier (string)
     2. a function name or handle that sets up all experiement parameters
     3. a struct with changes to the defaultParameters, this is usefull for debugging, but could also be used to replace the function.
 As long as the inputs are uniquely identifiable, the order is not important, otherwise 
 for the remaining unclassified inputs the above order is assumed.
 Read README.md for a more detailed explanation of the default usage</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../PLDAPS/@params/params.html" class="code" title="function p=params(s,sN,active)">@params/params</a>	PARAMS    A hierarchical parameter handling class</li><li><a href="deg2px.html" class="code" title="function [xy,z] = deg2px(p,xy,z,zIsR)">@pldaps/deg2px</a>	deg2px    convert from degrees of visual angle to pixel coordinates</li><li><a href="deg2world.html" class="code" title="function [xy,z] = deg2world(p,xy,z,zIsR)">@pldaps/deg2world</a>	deg2world    convert from degrees of visual angle to world coordinates</li><li><a href="getReorderedFrameStates.html" class="code" title="function [stateValue, stateName] = getReorderedFrameStates(trialStates,moduleRequestedStates)">@pldaps/getReorderedFrameStates</a>	find all frame states:</li><li><a href="pldapsClassDefaultParameters.html" class="code" title="function s=pldapsClassDefaultParameters(s)">@pldaps/pldapsClassDefaultParameters</a>	</li><li><a href="px2deg.html" class="code" title="function [xy,z] = px2deg(p,xy,z)">@pldaps/px2deg</a>	px2deg    convert from pixel coordinates to degrees of visual angle</li><li><a href="world2deg.html" class="code" title="function [xy,z] = world2deg(p,xy,z)">@pldaps/world2deg</a>	world2deg    convert from world coordinates to degrees of visual angle</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../PLDAPS/+pds/+eyelink/getFiles.html" class="code" title="function getFiles()">pds.eyelink.getFiles</a>	pds.eyelink.getFiles    transfer from from eyelink to this machine</li><li><a href="../../PLDAPS/createRigPrefs.html" class="code" title="function outStruct=createRigPrefs(additionalSettings)">createRigPrefs</a>	CreateRigPrefspdsBeginExperimentcreate preferences stored as matlab preferences</li></ul>
<!-- crossreference -->

<!-- parameterreference -->
<h2><a name="_cross"></a>PARAMETER USAGE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function uses these parameters:
<ul >
<li><a href="../../Parameters/addLevels.html" class="param" title="">.addLevels:</a>	
        <a href="#_line0049" class="code"}">49 </a>    <a href="#_line0094" class="code"}">94 </a></li><li><a href="../../Parameters/pldaps/rigParameters.html" class="param" title="">.pldaps.rigParameters:</a>	
        <a href="#_line0041" class="code"}">41 </a></li></ul>
This function assigns these parameters:
<ul>
</ul>
<!-- parameterreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">pldaps</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre><div id="_line0001" class="line">0001 <a name="_sub0" href="#_subfunctions" class="code">classdef pldaps &lt; handle</a>
</div><div id="_line0002" class="line">0002 <span class="comment">%pldaps    main class for PLDAPS (Plexon Datapixx PsychToolbox) version 4.1</span>
</div><div id="_line0003" class="line">0003 <span class="comment">% The pldaps contructor accepts the following inputs, all are optional, but may be required later for experiments to run:</span>
</div><div id="_line0004" class="line">0004 <span class="comment">%     1. a subject identifier (string)</span>
</div><div id="_line0005" class="line">0005 <span class="comment">%     2. a function name or handle that sets up all experiement parameters</span>
</div><div id="_line0006" class="line">0006 <span class="comment">%     3. a struct with changes to the defaultParameters, this is usefull for debugging, but could also be used to replace the function.</span>
</div><div id="_line0007" class="line">0007 <span class="comment">% As long as the inputs are uniquely identifiable, the order is not important, otherwise</span>
</div><div id="_line0008" class="line">0008 <span class="comment">% for the remaining unclassified inputs the above order is assumed.</span>
</div><div id="_line0009" class="line">0009 <span class="comment">% Read README.md for a more detailed explanation of the default usage</span>
</div><div id="_line0010" class="line">0010 
</div><div id="_line0011" class="line">0011 
</div><div id="_line0012" class="line">0012  properties
</div><div id="_line0013" class="line">0013     defaultParameters@<a href="../../PLDAPS/@params/params.html" class="code" title="function p=params(s,sN,active)">params</a>
</div><div id="_line0014" class="line">0014 
</div><div id="_line0015" class="line">0015     conditions@cell <span class="comment">%cell array with a struct like defaultParameters that only hold condition specific changes or additions</span>
</div><div id="_line0016" class="line">0016 
</div><div id="_line0017" class="line">0017     trial <span class="comment">%will get all variables from defaultParameters + correct conditions cell merged. This will get saved automatically.</span>
</div><div id="_line0018" class="line">0018           <span class="comment">%You can add calculated paraneters to this struct, e.g. the</span>
</div><div id="_line0019" class="line">0019           <span class="comment">%actual eyeposition used for caculating the frame, etc.</span>
</div><div id="_line0020" class="line">0020     data@cell
</div><div id="_line0021" class="line">0021     
</div><div id="_line0022" class="line">0022     functionHandles<span class="comment">%@cell %mostly unused atm</span>
</div><div id="_line0023" class="line">0023  <span class="keyword">end</span>
</div><div id="_line0024" class="line">0024 
</div><div id="_line0025" class="line">0025  methods
</div><div id="_line0026" class="line">0026      <a name="_sub1" href="#_subfunctions" class="code">function p = pldaps(varargin)</a>
</div><div id="_line0027" class="line">0027         <span class="comment">%classdefaults: create default struction from function</span>
</div><div id="_line0028" class="line">0028         defaults{1}=pldaps.pldapsClassDefaultParameters();
</div><div id="_line0029" class="line">0029         defaultsNames{1}=<span class="string">'pldapsClassDefaultParameters'</span>;
</div><div id="_line0030" class="line">0030         
</div><div id="_line0031" class="line">0031         <span class="comment">%rigdefaults: load from prefs?</span>
</div><div id="_line0032" class="line">0032         defaults{2}=getpref(<span class="string">'pldaps'</span>);
</div><div id="_line0033" class="line">0033         defaultsNames{2}=<span class="string">'pldapsRigPrefs'</span>;
</div><div id="_line0034" class="line">0034         
</div><div id="_line0035" class="line">0035         p.defaultParameters=<a href="../../PLDAPS/@params/params.html" class="code" title="function p=params(s,sN,active)">params</a>(defaults,defaultsNames);
</div><div id="_line0036" class="line">0036         
</div><div id="_line0037" class="line">0037         <span class="comment">%unnecassary, but we'll allow to save parameters in a rig</span>
</div><div id="_line0038" class="line">0038         <span class="comment">%struct, rather than the prefs, as that's a little more</span>
</div><div id="_line0039" class="line">0039         <span class="comment">%conveniant</span>
</div><div id="_line0040" class="line">0040         <span class="keyword">if</span> isField(p.defaultParameters,<span class="string">'pldaps.rigParameters'</span>)
</div><div id="_line0041" class="line">0041             defaults{3}=load(p.defaultParameters<a href="../../Parameters/pldaps/rigParameters.html" class="param" title="">.pldaps.rigParameters</a>);
</div><div id="_line0042" class="line">0042             fn=fieldnames(defaults{3});
</div><div id="_line0043" class="line">0043             <span class="keyword">if</span> length(fn)&gt;1
</div><div id="_line0044" class="line">0044                 error(<span class="string">'pldaps:pldaps'</span>, <span class="string">'The rig default parameter struct should only have one fieldname'</span>);
</div><div id="_line0045" class="line">0045             <span class="keyword">end</span>
</div><div id="_line0046" class="line">0046             defaults{3}=defaults{3}.(fn{1});
</div><div id="_line0047" class="line">0047             defaultsNames{3}=fn{1};
</div><div id="_line0048" class="line">0048              
</div><div id="_line0049" class="line">0049             p.defaultParameters<a href="../../Parameters/addLevels.html" class="param" title="">.addLevels</a>(defaults(3),defaultsNames(3));
</div><div id="_line0050" class="line">0050         <span class="keyword">end</span>
</div><div id="_line0051" class="line">0051         
</div><div id="_line0052" class="line">0052         
</div><div id="_line0053" class="line">0053         <span class="comment">%handle input to the constructor</span>
</div><div id="_line0054" class="line">0054         <span class="comment">%if an input is a struct, this is added to the defaultParameters.</span>
</div><div id="_line0055" class="line">0055         <span class="comment">%if an input is a cell. this is set as the conditions</span>
</div><div id="_line0056" class="line">0056         
</div><div id="_line0057" class="line">0057         <span class="comment">%It's contents will overrule previous parameters</span>
</div><div id="_line0058" class="line">0058         <span class="comment">%the first nonStruct is expected to be the subject's name</span>
</div><div id="_line0059" class="line">0059         <span class="comment">%the second nonStruct is expected to be the experiment functionname</span>
</div><div id="_line0060" class="line">0060         structIndex=cellfun(@isstruct,varargin);
</div><div id="_line0061" class="line">0061         <span class="keyword">if</span> any(structIndex)
</div><div id="_line0062" class="line">0062             <span class="keyword">if</span> sum(structIndex)&gt;1
</div><div id="_line0063" class="line">0063                 error(<span class="string">'pldaps:pldaps'</span>, <span class="string">'Only one struct allowed as input.'</span>);
</div><div id="_line0064" class="line">0064             <span class="keyword">end</span>
</div><div id="_line0065" class="line">0065             constructorStruct=varargin{structIndex};
</div><div id="_line0066" class="line">0066         <span class="keyword">else</span>
</div><div id="_line0067" class="line">0067             constructorStruct=struct;
</div><div id="_line0068" class="line">0068         <span class="keyword">end</span>
</div><div id="_line0069" class="line">0069 
</div><div id="_line0070" class="line">0070         cellIndex=cellfun(@iscell,varargin);
</div><div id="_line0071" class="line">0071         <span class="keyword">if</span> any(cellIndex)
</div><div id="_line0072" class="line">0072             <span class="keyword">if</span> sum(cellIndex)&gt;1
</div><div id="_line0073" class="line">0073                 error(<span class="string">'pldaps:pldaps'</span>, <span class="string">'Only one cell allowed as input.'</span>);
</div><div id="_line0074" class="line">0074             <span class="keyword">end</span>
</div><div id="_line0075" class="line">0075             p.conditions=varargin{cellIndex};
</div><div id="_line0076" class="line">0076         <span class="keyword">end</span>
</div><div id="_line0077" class="line">0077         
</div><div id="_line0078" class="line">0078         <span class="keyword">if</span> nargin&gt;4
</div><div id="_line0079" class="line">0079             error(<span class="string">'pldaps:pldaps'</span>, <span class="string">'Only four inputs allowed for now: subject, experimentSetupFile (String or function handle), a struct of parameters and a cell with a struct of parameters for each trial.'</span>);
</div><div id="_line0080" class="line">0080         <span class="keyword">end</span>
</div><div id="_line0081" class="line">0081         subjectSet=false;
</div><div id="_line0082" class="line">0082         <span class="keyword">for</span> iArgin=1:nargin
</div><div id="_line0083" class="line">0083             <span class="keyword">if</span> isa(varargin{iArgin}, <span class="string">'function_handle'</span>) <span class="comment">%fucntion handle will be the experimentSetupFunction</span>
</div><div id="_line0084" class="line">0084                  constructorStruct.session.experimentSetupFile=func2str(varargin{iArgin});
</div><div id="_line0085" class="line">0085             <span class="keyword">elseif</span> isa(varargin{iArgin}, <span class="string">'char'</span>)
</div><div id="_line0086" class="line">0086                 <span class="keyword">if</span> ~subjectSet  <span class="comment">%set experiment file</span>
</div><div id="_line0087" class="line">0087                     constructorStruct.session.subject=varargin{iArgin};
</div><div id="_line0088" class="line">0088                     subjectSet=true;
</div><div id="_line0089" class="line">0089                 <span class="keyword">else</span>
</div><div id="_line0090" class="line">0090                     constructorStruct.session.experimentSetupFile=varargin{iArgin};
</div><div id="_line0091" class="line">0091                 <span class="keyword">end</span>
</div><div id="_line0092" class="line">0092             <span class="keyword">end</span>
</div><div id="_line0093" class="line">0093         <span class="keyword">end</span>
</div><div id="_line0094" class="line">0094         p.defaultParameters<a href="../../Parameters/addLevels.html" class="param" title="">.addLevels</a>({constructorStruct, struct},{<span class="string">'ConstructorInputDefaults'</span>, <span class="string">'SessionParameters'</span>});
</div><div id="_line0095" class="line">0095         
</div><div id="_line0096" class="line">0096         
</div><div id="_line0097" class="line">0097         <span class="comment">%TODO: decice wheter this is a hack or feature. Allows to use</span>
</div><div id="_line0098" class="line">0098         <span class="comment">%dv.trial before the first trial. But it's a Params class</span>
</div><div id="_line0099" class="line">0099         <span class="comment">%until the first trial starts</span>
</div><div id="_line0100" class="line">0100         p.trial = p.defaultParameters; 
</div><div id="_line0101" class="line">0101     <span class="keyword">end</span> 
</div><div id="_line0102" class="line">0102      
</div><div id="_line0103" class="line">0103     
</div><div id="_line0104" class="line">0104  <span class="keyword">end</span> <span class="comment">%methods</span>
</div><div id="_line0105" class="line">0105 
</div><div id="_line0106" class="line">0106  methods(Static)
</div><div id="_line0107" class="line">0107       [xy,z] = <a href="deg2px.html" class="code" title="function [xy,z] = deg2px(p,xy,z,zIsR)">deg2px</a>(p,xy,z,zIsR)
</div><div id="_line0108" class="line">0108       
</div><div id="_line0109" class="line">0109       [xy,z] = <a href="deg2world.html" class="code" title="function [xy,z] = deg2world(p,xy,z,zIsR)">deg2world</a>(p,xy,z,zIsR)
</div><div id="_line0110" class="line">0110       
</div><div id="_line0111" class="line">0111       [xy,z] = <a href="px2deg.html" class="code" title="function [xy,z] = px2deg(p,xy,z)">px2deg</a>(p,xy,z)
</div><div id="_line0112" class="line">0112       
</div><div id="_line0113" class="line">0113       [xy,z] = <a href="world2deg.html" class="code" title="function [xy,z] = world2deg(p,xy,z)">world2deg</a>(p,xy,z)
</div><div id="_line0114" class="line">0114       
</div><div id="_line0115" class="line">0115       s = <a href="pldapsClassDefaultParameters.html" class="code" title="function s=pldapsClassDefaultParameters(s)">pldapsClassDefaultParameters</a>(s)
</div><div id="_line0116" class="line">0116       
</div><div id="_line0117" class="line">0117       [stateValue, stateName] = <a href="getReorderedFrameStates.html" class="code" title="function [stateValue, stateName] = getReorderedFrameStates(trialStates,moduleRequestedStates)">getReorderedFrameStates</a>(trialStates,moduleRequestedStates)
</div><div id="_line0118" class="line">0118  <span class="keyword">end</span>
</div><div id="_line0119" class="line">0119 
</div><div id="_line0120" class="line">0120 <span class="keyword">end</span>
</div></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005
<br>
check <strong><a href="../../index.html">here</a></strong> date of last update.
<br></address>
</body>
</html>