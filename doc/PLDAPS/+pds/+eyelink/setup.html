<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of setup</title>
  <meta name="keywords" content="setup">
  <meta name="description" content="pds.eyelink.setup    setup eyelink at the beginning of an experiment">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">PLDAPS</a> &gt; <a href="../index.html">+pds</a> &gt; <a href="index.html">+eyelink</a> &gt; setup.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for PLDAPS/+pds/+eyelink&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>pds.eyelink.setup
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>pds.eyelink.setup    setup eyelink at the beginning of an experiment</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function p = setup(p) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="description">pds.eyelink.setup    setup eyelink at the beginning of an experiment

 p = pds.eyelink.setup(p)
 Setup PLDAPS to use Eyelink toolbox</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../PLDAPS/@pldaps/replay.html" class="code" title="function p = replay(p,input)">@pldaps/replay</a>	replay    replay a previously recorded experiment on screen</li><li><a href="../../../PLDAPS/@pldaps/run.html" class="code" title="function p = run(p)">@pldaps/run</a>	run    run a new experiment for a previuously created pldaps class</li></ul>
<!-- crossreference -->

<!-- parameterreference -->
<h2><a name="_cross"></a>PARAMETER USAGE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function uses these parameters:
<ul >
<li><a href="../../../Parameters/display/heightcm.html" class="param" title=" height of the visible screen in cm">.display.heightcm:</a>	
        <a href="#_line0072" class="code"}">72 </a> height of the visible screen in cm</li><li><a href="../../../Parameters/display/ptr.html" class="param" title="">.display.ptr:</a>	
        <a href="#_line0027" class="code"}">27 </a></li><li><a href="../../../Parameters/display/viewdist.html" class="param" title="screend distance to the observer">.display.viewdist:</a>	
        <a href="#_line0074" class="code"}">74 </a>screend distance to the observer</li><li><a href="../../../Parameters/display/widthcm.html" class="param" title=" width  of the visible screen in cm">.display.widthcm:</a>	
        <a href="#_line0071" class="code"}">71 </a> width  of the visible screen in cm</li><li><a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect:</a>	
        <a href="#_line0069" class="code"}">69 </a>    <a href="#_line0069" class="code"}">69 </a>    <a href="#_line0069" class="code"}">69 </a>    <a href="#_line0069" class="code"}">69 </a>    <a href="#_line0127" class="code"}">127 </a>    <a href="#_line0128" class="code"}">128 </a></li><li><a href="../../../Parameters/eyelink/EYE_USED.html" class="param" title="">.eyelink.EYE_USED:</a>	
        <a href="#_line0182" class="code"}">182 </a></li><li><a href="../../../Parameters/eyelink/custom_calibration.html" class="param" title="don't use.">.eyelink.custom_calibration:</a>	
        <a href="#_line0014" class="code"}">14 </a>    <a href="#_line0126" class="code"}">126 </a>don't use.</li><li><a href="../../../Parameters/eyelink/custom_calibrationScale.html" class="param" title="don't use.">.eyelink.custom_calibrationScale:</a>	
        <a href="#_line0134" class="code"}">134 </a>don't use.</li><li><a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile:</a>	
        <a href="#_line0025" class="code"}">25 </a>    <a href="#_line0058" class="code"}">58 </a>    <a href="#_line0060" class="code"}">60 </a></li><li><a href="../../../Parameters/eyelink/setup/index.html" class="param" title="">.eyelink.setup:</a>	
        <a href="#_line0037" class="code"}">37 </a></li><li><a href="../../../Parameters/eyelink/trackermode.html" class="param" title="">.eyelink.trackermode:</a>	
        <a href="#_line0105" class="code"}">105 </a></li><li><a href="../../../Parameters/eyelink/use.html" class="param" title="use the eyelink moduke">.eyelink.use:</a>	
        <a href="#_line0006" class="code"}">6 </a>use the eyelink moduke</li><li><a href="../../../Parameters/session/file.html" class="param" title="">.session.file:</a>	
        <a href="#_line0068" class="code"}">68 </a></li><li><a href="../../../Parameters/session/initTime.html" class="param" title="">.session.initTime:</a>	
        <a href="#_line0021" class="code"}">21 </a></li><li><a href="../../../Parameters/sound/use.html" class="param" title="toogle use of sound">.sound.use:</a>	
        <a href="#_line0047" class="code"}">47 </a>toogle use of sound</li></ul>
This function assigns these parameters:
<ul>
<li><a href="../../../Parameters/eyelink/EYE_USED.html" class="param" title="">.eyelink.EYE_USED:</a>
        <a href="#_line0178" class="code"}">178 </a></li><li><a href="../../../Parameters/eyelink/callback.html" class="param" title="">.eyelink.callback:</a>
        <a href="#_line0116" class="code"}">116 </a></li><li><a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile:</a>
        <a href="#_line0021" class="code"}">21 </a></li><li><a href="../../../Parameters/eyelink/edfFileLocation.html" class="param" title="">.eyelink.edfFileLocation:</a>
        <a href="#_line0024" class="code"}">24 </a></li><li><a href="../../../Parameters/eyelink/eyeIdx.html" class="param" title="">.eyelink.eyeIdx:</a>
        <a href="#_line0181" class="code"}">181 </a>    <a href="#_line0183" class="code"}">183 </a></li><li><a href="../../../Parameters/eyelink/setup/index.html" class="param" title="">.eyelink.setup:</a>
        <a href="#_line0019" class="code"}">19 </a></li><li><a href="../../../Parameters/eyelink/setup/displayCalResults.html" class="param" title="">.eyelink.setup.displayCalResults:</a>
        <a href="#_line0035" class="code"}">35 </a></li><li><a href="../../../Parameters/eyelink/setup/eyeimgsize.html" class="param" title="">.eyelink.setup.eyeimgsize:</a>
        <a href="#_line0036" class="code"}">36 </a></li><li><a href="../../../Parameters/eyelink/setup/window.html" class="param" title="">.eyelink.setup.window:</a>
        <a href="#_line0027" class="code"}">27 </a></li><li><a href="../../../Parameters/eyelink/srate.html" class="param" title="">.eyelink.srate:</a>
        <a href="#_line0091" class="code"}">91 </a></li><li><a href="../../../Parameters/eyelink/trackermode.html" class="param" title="">.eyelink.trackermode:</a>
        <a href="#_line0103" class="code"}">103 </a></li><li><a href="../../../Parameters/eyelink/trackerversion.html" class="param" title="">.eyelink.trackerversion:</a>
        <a href="#_line0102" class="code"}">102 </a></li><li><a href="../../../Parameters/eyelink/use.html" class="param" title="use the eyelink moduke">.eyelink.use:</a>
        <a href="#_line0052" class="code"}">52 </a>use the eyelink moduke</li></ul>
<!-- parameterreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre><div id="_line0001" class="line">0001 <a name="_sub0" href="#_subfunctions" class="code">function p = setup(p)</a>
</div><div id="_line0002" class="line">0002 <span class="comment">%pds.eyelink.setup    setup eyelink at the beginning of an experiment</span>
</div><div id="_line0003" class="line">0003 <span class="comment">%</span>
</div><div id="_line0004" class="line">0004 <span class="comment">% p = pds.eyelink.setup(p)</span>
</div><div id="_line0005" class="line">0005 <span class="comment">% Setup PLDAPS to use Eyelink toolbox</span>
</div><div id="_line0006" class="line">0006 <span class="keyword">if</span> ~p.trial<a href="../../../Parameters/eyelink/use.html" class="param" title="use the eyelink moduke">.eyelink.use</a>
</div><div id="_line0007" class="line">0007     fprintf(<span class="string">'****************************************************************\r'</span>)
</div><div id="_line0008" class="line">0008     fprintf(<span class="string">'****************************************************************\r'</span>)
</div><div id="_line0009" class="line">0009     fprintf(<span class="string">'PLDAPS is NOT using EYELINK Toolbox for eyetrace. \r'</span>)
</div><div id="_line0010" class="line">0010     <span class="keyword">return</span>
</div><div id="_line0011" class="line">0011 <span class="keyword">else</span>
</div><div id="_line0012" class="line">0012     Eyelink(<span class="string">'Initialize'</span>)
</div><div id="_line0013" class="line">0013     
</div><div id="_line0014" class="line">0014     <span class="keyword">if</span> p.trial<a href="../../../Parameters/eyelink/custom_calibration.html" class="param" title="don't use.">.eyelink.custom_calibration</a>;
</div><div id="_line0015" class="line">0015         error(<span class="string">'pldaps:eyelinkSetup'</span>,<span class="string">'custom_calibration doesn''t work yet'</span>);
</div><div id="_line0016" class="line">0016 <span class="comment">%         dv.defaultParameters.eyelink.custom_calibration = false; % this doesnt work yet</span>
</div><div id="_line0017" class="line">0017     <span class="keyword">end</span>
</div><div id="_line0018" class="line">0018     
</div><div id="_line0019" class="line">0019     p.trial<a href="../../../Parameters/eyelink/setup/index.html" class="param" title="">.eyelink.setup</a>=EyelinkInitDefaults(); <span class="comment">% don't pass in the window pointer or you can mess up the color range</span>
</div><div id="_line0020" class="line">0020     
</div><div id="_line0021" class="line">0021     p.trial<a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile</a>=datestr(p.trial<a href="../../../Parameters/session/initTime.html" class="param" title="">.session.initTime</a>, <span class="string">'mmddHHMM'</span>);
</div><div id="_line0022" class="line">0022     
</div><div id="_line0023" class="line">0023           
</div><div id="_line0024" class="line">0024     p.trial<a href="../../../Parameters/eyelink/edfFileLocation.html" class="param" title="">.eyelink.edfFileLocation</a> = pwd; <span class="comment">%dv.pref.datadir;</span>
</div><div id="_line0025" class="line">0025     fprintf(<span class="string">'EDFFile: %s\n'</span>, p.trial<a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile</a> );
</div><div id="_line0026" class="line">0026     
</div><div id="_line0027" class="line">0027     p.trial<a href="../../../Parameters/eyelink/setup/window.html" class="param" title="">.eyelink.setup.window</a> = p.trial<a href="../../../Parameters/display/ptr.html" class="param" title="">.display.ptr</a>;
</div><div id="_line0028" class="line">0028     <span class="comment">% dv.defaultParameters.eyelink.backgroundcolour = BlackIndex(dv.defaultParameters.display.ptr);</span>
</div><div id="_line0029" class="line">0029     <span class="comment">% dv.defaultParameters.eyelink.msgfontcolour    = WhiteIndex(dv.defaultParameters.display.ptr);</span>
</div><div id="_line0030" class="line">0030     <span class="comment">% dv.defaultParameters.eyelink.imgtitlecolour   = WhiteIndex(dv.defaultParameters.display.ptr);</span>
</div><div id="_line0031" class="line">0031     <span class="comment">% dv.defaultParameters.eyelink.targetbeep = 0;</span>
</div><div id="_line0032" class="line">0032     <span class="comment">% dv.defaultParameters.eyelink.calibrationtargetcolour= WhiteIndex(dv.defaultParameters.eyelink.window);</span>
</div><div id="_line0033" class="line">0033     <span class="comment">% dv.defaultParameters.eyelink.calibrationtargetsize= .5;</span>
</div><div id="_line0034" class="line">0034     <span class="comment">% dv.defaultParameters.eyelink.calibrationtargetwidth=0.5;</span>
</div><div id="_line0035" class="line">0035     p.trial<a href="../../../Parameters/eyelink/setup/displayCalResults.html" class="param" title="">.eyelink.setup.displayCalResults</a> = 1;
</div><div id="_line0036" class="line">0036     p.trial<a href="../../../Parameters/eyelink/setup/eyeimgsize.html" class="param" title="">.eyelink.setup.eyeimgsize</a>=50;
</div><div id="_line0037" class="line">0037     EyelinkUpdateDefaults(p.trial<a href="../../../Parameters/eyelink/setup/index.html" class="param" title="">.eyelink.setup</a>);
</div><div id="_line0038" class="line">0038     
</div><div id="_line0039" class="line">0039     <span class="comment">% check if eyelink initializes</span>
</div><div id="_line0040" class="line">0040     <span class="keyword">if</span> ~Eyelink(<span class="string">'IsConnected'</span>)
</div><div id="_line0041" class="line">0041         fprintf(<span class="string">'****************************************************************\r'</span>)
</div><div id="_line0042" class="line">0042         fprintf(<span class="string">'****************************************************************\r'</span>)
</div><div id="_line0043" class="line">0043         fprintf(<span class="string">'Eyelink Init aborted. Eyelink is not connected.\n'</span>);
</div><div id="_line0044" class="line">0044         fprintf(<span class="string">'PLDAPS is NOT using EYELINK Toolbox for eyetrace. \r'</span>)
</div><div id="_line0045" class="line">0045         fprintf(<span class="string">'if you want to use EYELINK Toolbox for your eyetracking needs, \rtry Eyelink(''Shutdown'') and then retry p = pds.eyelink.setup(p)\r'</span>)
</div><div id="_line0046" class="line">0046         
</div><div id="_line0047" class="line">0047         <span class="keyword">if</span> p.trial<a href="../../../Parameters/sound/use.html" class="param" title="toogle use of sound">.sound.use</a>
</div><div id="_line0048" class="line">0048             Beeper(500); Beeper(400)
</div><div id="_line0049" class="line">0049         <span class="keyword">end</span>
</div><div id="_line0050" class="line">0050         disp(<span class="string">'PRESS ENTER TO CONFIRM YOU READ THIS MESSAGE'</span>); pause
</div><div id="_line0051" class="line">0051         Eyelink(<span class="string">'Shutdown'</span>)
</div><div id="_line0052" class="line">0052         p.trial<a href="../../../Parameters/eyelink/use.html" class="param" title="use the eyelink moduke">.eyelink.use</a> = 0;
</div><div id="_line0053" class="line">0053         <span class="keyword">return</span>
</div><div id="_line0054" class="line">0054     <span class="keyword">end</span>
</div><div id="_line0055" class="line">0055     
</div><div id="_line0056" class="line">0056     <span class="comment">% open file to record data to</span>
</div><div id="_line0057" class="line">0057     <span class="comment">% res = Eyelink('Openfile', fullfile(dv.defaultParameters.eyelink.edfFileLocation,dv.defaultParameters.eyelink.edfFile));</span>
</div><div id="_line0058" class="line">0058     res = Eyelink(<span class="string">'Openfile'</span>, p.trial<a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile</a>);
</div><div id="_line0059" class="line">0059     <span class="keyword">if</span> res~=0
</div><div id="_line0060" class="line">0060         fprintf(<span class="string">'Cannot create EDF file ''%s'' '</span>, p.trial<a href="../../../Parameters/eyelink/edfFile.html" class="param" title="">.eyelink.edfFile</a>);
</div><div id="_line0061" class="line">0061         Eyelink(<span class="string">'Shutdown'</span>)
</div><div id="_line0062" class="line">0062         <span class="keyword">return</span>;
</div><div id="_line0063" class="line">0063     <span class="keyword">end</span>
</div><div id="_line0064" class="line">0064     
</div><div id="_line0065" class="line">0065     <span class="comment">% Eyelink commands to setup the eyelink environment</span>
</div><div id="_line0066" class="line">0066     datestr(now);
</div><div id="_line0067" class="line">0067     Eyelink(<span class="string">'command'</span>,  [<span class="string">'add_file_preamble_text ''Recorded by PLDAPS'</span>  <span class="string">''''</span>]);
</div><div id="_line0068" class="line">0068     Eyelink(<span class="string">'command'</span>,  [<span class="string">'add_file_preamble_text ''Datafile: '</span> p.trial<a href="../../../Parameters/session/file.html" class="param" title="">.session.file</a>  <span class="string">''''</span>]);
</div><div id="_line0069" class="line">0069     Eyelink(<span class="string">'command'</span>,  <span class="string">'screen_pixel_coords = %ld, %ld, %ld, %ld'</span>, p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(1), p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(2), p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(3)-1, p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(4)-1);
</div><div id="_line0070" class="line">0070     Eyelink(<span class="string">'command'</span>,  <span class="string">'analog_dac_range = %1d, %1d'</span>, -5, 5);
</div><div id="_line0071" class="line">0071     w = round(10*p.trial<a href="../../../Parameters/display/widthcm.html" class="param" title=" width  of the visible screen in cm">.display.widthcm</a>/2);
</div><div id="_line0072" class="line">0072     h = round(10*p.trial<a href="../../../Parameters/display/heightcm.html" class="param" title=" height of the visible screen in cm">.display.heightcm</a>/2);
</div><div id="_line0073" class="line">0073     Eyelink(<span class="string">'command'</span>,  <span class="string">'screen_phys_coords = %1d, %1d, %1d, %1d'</span>, -w, h, w, -h);
</div><div id="_line0074" class="line">0074     Eyelink(<span class="string">'command'</span>,  <span class="string">'screen_distance = %1d'</span>, p.trial<a href="../../../Parameters/display/viewdist.html" class="param" title="screend distance to the observer">.display.viewdist</a>*10);
</div><div id="_line0075" class="line">0075     
</div><div id="_line0076" class="line">0076     
</div><div id="_line0077" class="line">0077     [v,vs] = Eyelink(<span class="string">'GetTrackerVersion'</span>);
</div><div id="_line0078" class="line">0078     disp(<span class="string">'***************************************************************'</span>)
</div><div id="_line0079" class="line">0079     fprintf(<span class="string">'\tReading Values from %sEyetracker\r'</span>, vs)
</div><div id="_line0080" class="line">0080     disp(<span class="string">'***************************************************************'</span>)
</div><div id="_line0081" class="line">0081     [result, reply] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'screen_pixel_coords'</span>);
</div><div id="_line0082" class="line">0082     fprintf([<span class="string">'Screen pixel coordinates are:\t\t'</span> reply <span class="string">'\r'</span>])
</div><div id="_line0083" class="line">0083     [result, reply] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'screen_phys_coords'</span>);
</div><div id="_line0084" class="line">0084     fprintf([<span class="string">'Screen physical coordinates are:\t'</span> reply <span class="string">' (in mm)\r'</span>])
</div><div id="_line0085" class="line">0085     [result, reply] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'screen_distance'</span>);
</div><div id="_line0086" class="line">0086     fprintf([<span class="string">'Screen distance is:\t\t\t'</span> reply <span class="string">'\r'</span>])
</div><div id="_line0087" class="line">0087     [result, reply] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'analog_dac_range'</span>);
</div><div id="_line0088" class="line">0088     fprintf([<span class="string">'Analog output range is constraiend to:\t'</span> reply <span class="string">' (volts)\r'</span>])
</div><div id="_line0089" class="line">0089     [result, srate] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'sample_rate'</span>);
</div><div id="_line0090" class="line">0090     fprintf([<span class="string">'Sampling rate is:\t\t\t'</span> srate <span class="string">'Hz\r'</span>])
</div><div id="_line0091" class="line">0091     p.trial<a href="../../../Parameters/eyelink/srate.html" class="param" title="">.eyelink.srate</a> = str2double(srate);
</div><div id="_line0092" class="line">0092     pause(.05)
</div><div id="_line0093" class="line">0093     
</div><div id="_line0094" class="line">0094     vsn = regexp(vs,<span class="string">'\d'</span>,<span class="string">'match'</span>); <span class="comment">% wont work on EL I</span>
</div><div id="_line0095" class="line">0095     <span class="keyword">if</span> isempty(vsn)
</div><div id="_line0096" class="line">0096         eyelinkI = 1;
</div><div id="_line0097" class="line">0097     <span class="keyword">else</span>
</div><div id="_line0098" class="line">0098         eyelinkI = 0;
</div><div id="_line0099" class="line">0099     <span class="keyword">end</span>
</div><div id="_line0100" class="line">0100     
</div><div id="_line0101" class="line">0101     [result,reply]=Eyelink(<span class="string">'ReadFromTracker'</span>,<span class="string">'elcl_select_configuration'</span>);
</div><div id="_line0102" class="line">0102     p.trial<a href="../../../Parameters/eyelink/trackerversion.html" class="param" title="">.eyelink.trackerversion</a> = vs;
</div><div id="_line0103" class="line">0103     p.trial<a href="../../../Parameters/eyelink/trackermode.html" class="param" title="">.eyelink.trackermode</a>    = reply;
</div><div id="_line0104" class="line">0104     
</div><div id="_line0105" class="line">0105     <span class="keyword">switch</span> p.trial<a href="../../../Parameters/eyelink/trackermode.html" class="param" title="">.eyelink.trackermode</a>
</div><div id="_line0106" class="line">0106         <span class="keyword">case</span> {<span class="string">'RTABLER'</span>}
</div><div id="_line0107" class="line">0107             fprintf(<span class="string">'\rSetting up tracker for remote mode\r'</span>)
</div><div id="_line0108" class="line">0108             <span class="comment">% remote mode possible add HTARGET ( head target)</span>
</div><div id="_line0109" class="line">0109             
</div><div id="_line0110" class="line">0110             Eyelink(<span class="string">'command'</span>, <span class="string">'file_event_filter = LEFT,RIGHT,FIXATION,SACCADE,BLINK,MESSAGE,BUTTON,INPUT'</span>);
</div><div id="_line0111" class="line">0111             Eyelink(<span class="string">'command'</span>, <span class="string">'file_sample_data  = LEFT,RIGHT,GAZE,HREF,AREA,GAZERES,PUPIL,STATUS,INPUT,HTARGET, HMARKER'</span>);
</div><div id="_line0112" class="line">0112             <span class="comment">% set link data (used for gaze cursor)</span>
</div><div id="_line0113" class="line">0113             Eyelink(<span class="string">'command'</span>, <span class="string">'link_event_filter = LEFT,RIGHT,FIXATION,SACCADE,BLINK,MESSAGE,BUTTON,FIXUPDATE,INPUT'</span>);
</div><div id="_line0114" class="line">0114             Eyelink(<span class="string">'command'</span>, <span class="string">'link_sample_data  = LEFT,RIGHT,GAZE,HREF,AREA,GAZERES,PUPIL,STATUS,INPUT,HTARGET, HMARKER'</span>);
</div><div id="_line0115" class="line">0115         <span class="keyword">otherwise</span>
</div><div id="_line0116" class="line">0116             p.trial<a href="../../../Parameters/eyelink/callback.html" class="param" title="">.eyelink.callback</a> = [];
</div><div id="_line0117" class="line">0117             Eyelink(<span class="string">'command'</span>, <span class="string">'file_event_filter = LEFT,RIGHT,FIXATION,SACCADE,BLINK,MESSAGE,BUTTON,INPUT'</span>);
</div><div id="_line0118" class="line">0118             Eyelink(<span class="string">'command'</span>, <span class="string">'file_sample_data  = LEFT,RIGHT,GAZE,HREF,AREA,GAZERES,PUPIL,STATUS,INPUT'</span>);
</div><div id="_line0119" class="line">0119             <span class="comment">% set link data (used for gaze cursor)</span>
</div><div id="_line0120" class="line">0120             Eyelink(<span class="string">'command'</span>, <span class="string">'link_event_filter = LEFT,RIGHT,FIXATION,SACCADE,BLINK,MESSAGE,BUTTON,FIXUPDATE,INPUT'</span>);
</div><div id="_line0121" class="line">0121             Eyelink(<span class="string">'command'</span>, <span class="string">'link_sample_data  = LEFT,RIGHT,GAZE,GAZERES,AREA,PUPIL,STATUS,INPUT'</span>);
</div><div id="_line0122" class="line">0122     <span class="keyword">end</span>
</div><div id="_line0123" class="line">0123     
</div><div id="_line0124" class="line">0124     
</div><div id="_line0125" class="line">0125     <span class="comment">% custom calibration points</span>
</div><div id="_line0126" class="line">0126     <span class="keyword">if</span> p.trial<a href="../../../Parameters/eyelink/custom_calibration.html" class="param" title="don't use.">.eyelink.custom_calibration</a>
</div><div id="_line0127" class="line">0127         width  = p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(3);
</div><div id="_line0128" class="line">0128         height = p.trial<a href="../../../Parameters/display/winRect.html" class="param" title="">.display.winRect</a>(4);
</div><div id="_line0129" class="line">0129         disp(<span class="string">'setting up custom calibration'</span>)
</div><div id="_line0130" class="line">0130         disp(<span class="string">'this is not properly implemented yet on 64-bit Eyelink. Works for 32-bit'</span>)
</div><div id="_line0131" class="line">0131         Eyelink(<span class="string">'command'</span>, <span class="string">'generate_default_targets = NO'</span>);
</div><div id="_line0132" class="line">0132         <span class="comment">%     Eyelink('command','calibration_samples = 5');</span>
</div><div id="_line0133" class="line">0133         <span class="comment">%     Eyelink('command','calibration_sequence = 1,2,3,4,5');</span>
</div><div id="_line0134" class="line">0134         scale = p.trial<a href="../../../Parameters/eyelink/custom_calibrationScale.html" class="param" title="don't use.">.eyelink.custom_calibrationScale</a>;
</div><div id="_line0135" class="line">0135 
</div><div id="_line0136" class="line">0136         cx = (width/2);
</div><div id="_line0137" class="line">0137         cy = (height/2);
</div><div id="_line0138" class="line">0138         Eyelink(<span class="string">'command'</span>,<span class="string">'calibration_targets = %d,%d %d,%d %d,%d %d,%d %d,%d'</span>,<span class="keyword">...</span>
</div><div id="_line0139" class="line">0139             cx,cy,  cx,cy-cy*scale,  cx,cy+cy*scale,  cx-cx*scale,cy,  cx + cx*scale,cy);
</div><div id="_line0140" class="line">0140         
</div><div id="_line0141" class="line">0141         fprintf(<span class="string">'calibration_targets = %d,%d %d,%d %d,%d %d,%d %d,%d\r'</span>,<span class="keyword">...</span>
</div><div id="_line0142" class="line">0142             cx,cy,  cx,cy-cy*scale,  cx,cy+cy*scale,  cx-cx*scale,cy,  cx + cx*scale,cy);
</div><div id="_line0143" class="line">0143         <span class="comment">%     Eyelink('command','validation_samples = 5');</span>
</div><div id="_line0144" class="line">0144         <span class="comment">%     Eyelink('command','validation_sequence = 0,1,2,3,4,5');</span>
</div><div id="_line0145" class="line">0145         Eyelink(<span class="string">'command'</span>,<span class="string">'validation_targets = %d,%d %d,%d %d,%d %d,%d %d,%d'</span>,<span class="keyword">...</span>
</div><div id="_line0146" class="line">0146             cx,cy,  cx,cy-cy*scale,  cx,cy+cy*scale,  cx-cx*scale,cy,  cx + cx*scale,cy);
</div><div id="_line0147" class="line">0147         
</div><div id="_line0148" class="line">0148         <span class="comment">%TODO: what? that's not how it should be done, why not send the</span>
</div><div id="_line0149" class="line">0149         <span class="comment">%calibration scale??</span>
</div><div id="_line0150" class="line">0150     <span class="keyword">else</span>
</div><div id="_line0151" class="line">0151         disp(<span class="string">'using default calibration points'</span>)
</div><div id="_line0152" class="line">0152         Eyelink(<span class="string">'command'</span>, <span class="string">'calibration_type = HV9'</span>);
</div><div id="_line0153" class="line">0153         <span class="comment">% you must send this command with value NO for custom calibration</span>
</div><div id="_line0154" class="line">0154         <span class="comment">% you must also reset it to YES for subsequent experiments</span>
</div><div id="_line0155" class="line">0155         Eyelink(<span class="string">'command'</span>, <span class="string">'generate_default_targets = YES'</span>);
</div><div id="_line0156" class="line">0156         
</div><div id="_line0157" class="line">0157     <span class="keyword">end</span>
</div><div id="_line0158" class="line">0158     
</div><div id="_line0159" class="line">0159     
</div><div id="_line0160" class="line">0160     
</div><div id="_line0161" class="line">0161     <span class="comment">% query host to see if automatic calibration sequencing is enabled.</span>
</div><div id="_line0162" class="line">0162     <span class="comment">% ReadFromTracker needs to have 2 outputs.</span>
</div><div id="_line0163" class="line">0163     <span class="comment">% variables querable are listed in the .ini files in the host</span>
</div><div id="_line0164" class="line">0164     <span class="comment">% directories. Note that not all variables are querable.</span>
</div><div id="_line0165" class="line">0165     [result, reply]=Eyelink(<span class="string">'ReadFromTracker'</span>,<span class="string">'enable_automatic_calibration'</span>);
</div><div id="_line0166" class="line">0166     
</div><div id="_line0167" class="line">0167     <span class="keyword">if</span> reply <span class="comment">% reply = 1</span>
</div><div id="_line0168" class="line">0168         fprintf(<span class="string">'Automatic sequencing ON\r'</span>);
</div><div id="_line0169" class="line">0169     <span class="keyword">else</span>
</div><div id="_line0170" class="line">0170         fprintf(<span class="string">'Automatic sequencing OFF\r'</span>);
</div><div id="_line0171" class="line">0171     <span class="keyword">end</span>
</div><div id="_line0172" class="line">0172     
</div><div id="_line0173" class="line">0173     Eyelink(<span class="string">'command'</span>,  <span class="string">'inputword_is_window = ON'</span>);
</div><div id="_line0174" class="line">0174     
</div><div id="_line0175" class="line">0175     
</div><div id="_line0176" class="line">0176     pause(.05)
</div><div id="_line0177" class="line">0177     
</div><div id="_line0178" class="line">0178     [result, p.trial<a href="../../../Parameters/eyelink/EYE_USED.html" class="param" title="">.eyelink.EYE_USED</a>] = Eyelink(<span class="string">'ReadFromTracker'</span>, <span class="string">'active_eye'</span>);
</div><div id="_line0179" class="line">0179     
</div><div id="_line0180" class="line">0180     
</div><div id="_line0181" class="line">0181     p.trial<a href="../../../Parameters/eyelink/eyeIdx.html" class="param" title="">.eyelink.eyeIdx</a> = 1;
</div><div id="_line0182" class="line">0182     <span class="keyword">if</span> strcmp(p.trial<a href="../../../Parameters/eyelink/EYE_USED.html" class="param" title="">.eyelink.EYE_USED</a>, <span class="string">'RIGHT'</span>)
</div><div id="_line0183" class="line">0183         p.trial<a href="../../../Parameters/eyelink/eyeIdx.html" class="param" title="">.eyelink.eyeIdx</a> = 2;
</div><div id="_line0184" class="line">0184     <span class="keyword">end</span>
</div><div id="_line0185" class="line">0185     
</div><div id="_line0186" class="line">0186     Eyelink(<span class="string">'message'</span>, <span class="string">'SETUP'</span>);
</div><div id="_line0187" class="line">0187     
</div><div id="_line0188" class="line">0188     Eyelink(<span class="string">'StartRecording'</span>);
</div><div id="_line0189" class="line">0189 <span class="keyword">end</span>
</div><div id="_line0190" class="line">0190 
</div><div id="_line0191" class="line">0191 
</div><div id="_line0192" class="line">0192 
</div></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005
<br>
check <strong><a href="../../../index.html">here</a></strong> date of last update.
<br></address>
</body>
</html>